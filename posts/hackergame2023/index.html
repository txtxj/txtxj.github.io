<!DOCTYPE html>
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript">
  jQuery(document).ready(function($) {
      $("body").click(function(e) {
          var $text = $("<span>❤</span>");
          if (Math.random() <= 0.02) $text = $("<span>TX!</span>");
          var x = e.pageX, y = e.pageY;
          $text.css({
              "z-index": 1145141919810,
              "top": y,
              "left": x,
              "position": "absolute",
              "pointer-events": "none",
              "transform": "translate(-50%, -50%)",
              "font-weight": "bold",
              "color": "rgb("+~~(255 * Math.random())+","+~~(255 * Math.random())+","+~~(255 * Math.random())+")"
          });
          $("body").append($text);
          $text.animate({
              "top": y - 100,
              "opacity": 0,
              "fontSize": 0,
          },
          1500,
          function() {
              $text.remove();
          });
      });
  });
  var OriginTitile = document.title; 
  document.addEventListener("visibilitychange", function () { 
      if (document.title != "txtxj呼呼zzz") OriginTitile = document.title;
      document.title = document.hidden ? "txtxj呼呼zzz" : OriginTitile;
  });
function showBig(obj) {
  var popup = document.getElementById("popup");
  var img = popup.children[0].children[0];
  img.src = obj.src;
  var scale = 2.0;
  if (img.width * scale > window.innerWidth)
    scale = window.innerWidth / img.width;
  if (img.height * scale > window.innerHeight)
    scale = window.innerHeight / img.height;
  img.style.scale = scale;
  popup.style.display = "block";
}
function hideBig(obj) {
  obj.style.display = "none";
}
function wheelImg(obj) {
  img = obj.children[0].children[0];
  var scale = parseFloat(img.style.scale) || 1.0;
    scale += event.wheelDelta / 1500;
    if (scale < 0.9)
      scale = 0.9;
    if (img.width * scale > window.innerWidth)
      scale = window.innerWidth / img.width;
    if (img.height * scale > window.innerHeight)
      scale = window.innerHeight / img.height;
    img.style.scale = scale;
    return false;
}
</script>
<html><script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script><head>
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

   
    <meta name="author" content="Citrine">
  

  

  

  <meta name="generator" content="Hugo 0.101.0" />
  
  
  
  
  
  
  <title>HackerGame2023 WriteUP 🌟 Citrine</title>

  <meta property="og:title" content="HackerGame2023 WriteUP" />
<meta property="og:description" content="奶奶的睡前 flag 故事 题目中提到 谷歌的『亲儿子』 连系统都没心思升级 推测可能是 pixel 老系统的一个 bug。
搜索一圈，搜到 Windows 11 同样有这个 bug ，屏幕截图后剪切其中一部分，被剪切的数据仍保存在文件中，位于 IEND 标签后。
使用 010 Editor 检查，发现图片 IEND 后仍有大量 IDAT 和一个 IEND，符合 aCropalypse 漏洞，在 acropalypse.app 上恢复即可 。
组委会模拟器 直接写个脚本跑就完了
(function() { &#39;use strict&#39;; setTimeout(()=&gt;{ var container = document.getElementsByClassName(&#39;fakeqq-container&#39;)[0]; container.addEventListener(&#39;DOMSubtreeModified&#39;, function (e) { var bubble = e.target.children[e.target.children.length - 1].children[0].children[1].children[1]; var txt = bubble.children[1].innerHTML; var re = /hack\[[a-z]&#43;\]/; var pos = txt.search(re); if (pos &gt;= 0) { const event = new MouseEvent(&#39;click&#39;, { view: window, bubbles: true, cancelable: true }); bubble." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://txtxj.top/posts/hackergame2023/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-05T19:45:29+08:00" />
<meta property="article:modified_time" content="2023-11-05T19:45:29+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="HackerGame2023 WriteUP"/>
<meta name="twitter:description" content="奶奶的睡前 flag 故事 题目中提到 谷歌的『亲儿子』 连系统都没心思升级 推测可能是 pixel 老系统的一个 bug。
搜索一圈，搜到 Windows 11 同样有这个 bug ，屏幕截图后剪切其中一部分，被剪切的数据仍保存在文件中，位于 IEND 标签后。
使用 010 Editor 检查，发现图片 IEND 后仍有大量 IDAT 和一个 IEND，符合 aCropalypse 漏洞，在 acropalypse.app 上恢复即可 。
组委会模拟器 直接写个脚本跑就完了
(function() { &#39;use strict&#39;; setTimeout(()=&gt;{ var container = document.getElementsByClassName(&#39;fakeqq-container&#39;)[0]; container.addEventListener(&#39;DOMSubtreeModified&#39;, function (e) { var bubble = e.target.children[e.target.children.length - 1].children[0].children[1].children[1]; var txt = bubble.children[1].innerHTML; var re = /hack\[[a-z]&#43;\]/; var pos = txt.search(re); if (pos &gt;= 0) { const event = new MouseEvent(&#39;click&#39;, { view: window, bubbles: true, cancelable: true }); bubble."/>


  
  
  
  
  <link rel="stylesheet" href="https://txtxj.top/assets/css/style.min.6e3ac0eda5e29b4defbb8703b907761f5bd385b098d693edcdae4acfac2039fe.css" integrity="sha256-bjrA7aXim03vu4cDuQd2H1vThbCY1pPtza5Kz6wgOf4=">

  <script src="https://txtxj.top/assets/js/main.min.597d9f5a80ce3137282a06b1b2cdbb5a481f3ae5ef0d0ba4265c177b6d788b36.js" integrity="sha256-WX2fWoDOMTcoKgaxss27WkgfOuXvDQukJlwXe214izY="></script>
  
  </head><body><header class="header-container layout-block layout-padding">
  <div class="header-inner content-padding-large soft-size--large soft-style--box">
    <div class="header-logo">
      <a href="https://txtxj.top"><h1><img class="author-avatar soft-size--round soft-style--box" src="https://avatars.githubusercontent.com/u/47293990?s=100">&nbspCitrine</h1></a>
    </div>
    <nav class="header-nav">
      <div class="header-nav--btn">
        <div class="btn-item"></div>
        <div class="btn-item"></div>
        <div class="btn-item"></div>
      </div>
      <div class="header-nav--list">
        <div>
          
          <a class="list-item soft-size--small soft-style--hover soft-style--active" href="/" title="">🏠 主页</a>
          
          <a class="list-item soft-size--small soft-style--hover soft-style--active" href="/tags" title="">🏷️ 标签</a>
          
          <a class="list-item soft-size--small soft-style--hover soft-style--active" href="/link" title="">🔗 友链</a>
          
        </div>
      </div>
    </nav>
  </div>
</header><main id="content">
    

    <div class="single-container layout-block">
      <div class="article-info">
        <div class="article-header layout-padding">
          <div class="article-cover card-container content-padding-large soft-size--large soft-style--box img">

  <div class="card-cover">
    
      <img src="https://s2.loli.net/2023/11/05/HETxNBMAXsLzwop.jpg" alt="https://s2.loli.net/2023/11/05/HETxNBMAXsLzwop.jpg" />
    
  </div>

  <div class="card-text">
    <h1 class="card-text--title">HackerGame2023 WriteUP</h1>
    
      <p class="card-text--row">2023-11-05 19:45</p>
      
      
      

      
      
        <ul class="card-text--tag">
          
            <li><a href="https://txtxj.top/tags/%E9%A2%98%E8%A7%A3/">题解</a></li>
            <li><a href="https://txtxj.top/tags/ctf/">CTF</a></li></ul>
      
    
  </div>

</div>
        </div>

        <div class="article-content">
          <div class="markdown-body content-padding-large soft-size--large soft-style--box">
            <h2 id="奶奶的睡前-flag-故事">奶奶的睡前 flag 故事</h2>
<p>题目中提到 <strong>谷歌的『亲儿子』</strong> <strong>连系统都没心思升级</strong> 推测可能是 pixel 老系统的一个 bug。</p>
<p>搜索一圈，搜到 Windows 11 同样有这个 bug ，屏幕截图后剪切其中一部分，被剪切的数据仍保存在文件中，位于 IEND 标签后。</p>
<p>使用 010 Editor 检查，发现图片 IEND 后仍有大量 IDAT 和一个 IEND，符合 aCropalypse 漏洞，在 <a href="https://acropalypse.app/" target="_blank" rel="noopener">acropalypse.app</a> 上恢复即可 。</p>
<h2 id="组委会模拟器">组委会模拟器</h2>
<p>直接写个脚本跑就完了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>(<span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;use strict&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">setTimeout</span>(()=&gt;{
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">container</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementsByClassName</span>(<span style="color:#e6db74">&#39;fakeqq-container&#39;</span>)[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">container</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;DOMSubtreeModified&#39;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">bubble</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">children</span>[<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">children</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">children</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">children</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">children</span>[<span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">txt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">bubble</span>.<span style="color:#a6e22e">children</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">innerHTML</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">re</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">/hack\[[a-z]+\]/</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pos</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">txt</span>.<span style="color:#a6e22e">search</span>(<span style="color:#a6e22e">re</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">pos</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">event</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">MouseEvent</span>(<span style="color:#e6db74">&#39;click&#39;</span>, {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">view</span><span style="color:#f92672">:</span> window,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">bubbles</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">cancelable</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">bubble</span>.<span style="color:#a6e22e">dispatchEvent</span>(<span style="color:#a6e22e">event</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>    }, <span style="color:#ae81ff">500</span>);
</span></span><span style="display:flex;"><span>})();
</span></span></code></pre></div><h2 id="虫">虫</h2>
<p>写完签到题就过来写这个题了，喜提一血奖。</p>
<p>搜索 ISS 可知题目音频是一段 SSTV 信号，下载 RX-SSTV 解码即可。</p>
<h2 id="json--yaml">JSON ⊂ YAML?</h2>
<p>先随机试了一下相同键名，拿到 flag2。</p>
<p>接着开始搜索，找到这个帖子 <a href="https://stackoverflow.com/questions/21584985/what-valid-json-files-are-not-valid-yaml-1-1-files" target="_blank" rel="noopener">what-valid-json-files-are-not-valid-yaml-1-1-files(stackoverflow)</a>，</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{ <span style="color:#f92672">&#34;123&#34;</span>: <span style="color:#ae81ff">6</span>, <span style="color:#f92672">&#34;123&#34;</span>: <span style="color:#ae81ff">12345e999</span> }
</span></span></code></pre></div><h2 id="git-git">Git? Git!</h2>
<p><code>git log</code> 检查发现存在一次 <code>reset</code> 记录，再次使用 <code>git reset</code> 回退，检查 <code>README.md</code> 得到 flag。</p>
<h2 id="http-集邮册">HTTP 集邮册</h2>
<p>本来没冲着一血来的，结果莫名其妙一血了。</p>
<p>没什么好说的，照着 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" target="_blank" rel="noopener">MDN</a> 一个一个试就行了。</p>
<h2 id="docker-for-everyone">Docker for Everyone</h2>
<p>试图给我那 C 盘通红的 Windows 安装 Docker，结果大失败，这个题放了好久都没写。</p>
<p>后来看写出来的人那么多，就直接在网页终端上试着写了。</p>
<p>直接打开 flag 是不行的，没有权限。试着用 docker 把 flag 坐在文件夹挂载到容器内，发现可以直接打开，获得 flag。</p>
<h2 id="惜字如金-20">惜字如金 2.0</h2>
<p>去年的惜字如金完全看不懂，于是今年看到这个题，又看到一个 math 标签，直接就准备跳过了。</p>
<p>结果把程序下载下来发现意外地很简单，<code>cod_dict</code> 一共有 5 行，每一行都缺少一个字符。</p>
<p>根据索引表，在 <code>cod_dict</code> 找前 5 个字符和最后一个字符，保证它们分别为 <code>flag{</code> 和 <code>}</code> 。</p>
<p>在保证这一条件的基础上，发现还未确定哪个字符被惜字如金化的行对最终结果无影响，直接在任意能够保证前置条件的位置加上任意字符即可。</p>
<h2 id="-高频率星球">🪐 高频率星球</h2>
<p>Windows 下装不了 asciinema ，跑去 vlab 装了一个，直接 <code>asciinema cat</code> 输出到文件，删除一些杂七杂八的代码得到一段 js 代码，执行即可。</p>
<h2 id="-小型大语言模型星球">🪐 小型大语言模型星球</h2>
<p>第一题，调教之后发现输入 <code>Is I smart?</code> 即可。</p>
<p>第二题，下载 TinyStories-33M 的训练数据，在里面搜索 <code>accepted</code> ，并把该单词前的一个单词作为 prompt，发现 任意主语 + <code>gratefully</code> 都能触发 <code>accepted</code>，但太长了，不可取。</p>
<p>于是写了个程序获取训练集中所有的 <code>accepted</code> 前的单词，将其作为 prompt，找到答案 <code>atively</code> 。</p>
<h2 id="-流式星球">🪐 流式星球</h2>
<p>010 Editor 打开 bin 文件，发现其中有很多重复的 <code>06 08 0A</code></p>
<p>
  <p><img src="https://s2.loli.net/2023/11/05/NELY8IrUHlSev1h.png" alt="20231105_1.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>推测重复部分是因为上下两行颜色相同。找到和图中格式相同的另一段数据，起始位置为 <code>0x0501</code> ，故推测每一行像素个数为 <code>427</code> 。</p>
<p>整个文件有 <code>0x80E2CBF</code> 个字节，相比完整片段少了不到 <code>100</code> 个字节，按行取模补充完整，可知一共有 <code>105501</code> 行。</p>
<p>将其分解，一个一个试，可得到正确的分辨率 <code>427 x 759</code>。</p>
<p>还原代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">numpy_array_to_video</span>(numpy_array, video_out_path):
</span></span><span style="display:flex;"><span>    numpy_array <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(numpy_array, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>uint8)
</span></span><span style="display:flex;"><span>    video_height <span style="color:#f92672">=</span> numpy_array<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    video_width <span style="color:#f92672">=</span> numpy_array<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    out_video_size <span style="color:#f92672">=</span> (video_width, video_height)
</span></span><span style="display:flex;"><span>    output_video_fourcc <span style="color:#f92672">=</span> int(cv2<span style="color:#f92672">.</span>VideoWriter_fourcc(<span style="color:#f92672">*</span><span style="color:#e6db74">&#39;mp4v&#39;</span>))
</span></span><span style="display:flex;"><span>    video_write_capture <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>VideoWriter(video_out_path, output_video_fourcc, <span style="color:#ae81ff">30</span>, out_video_size)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> frame <span style="color:#f92672">in</span> numpy_array:
</span></span><span style="display:flex;"><span>        video_write_capture<span style="color:#f92672">.</span>write(frame)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    video_write_capture<span style="color:#f92672">.</span>release()
</span></span></code></pre></div><h2 id="-低带宽星球">🪐 低带宽星球</h2>
<p>第一题随便找个在线压缩网站压一下就行。</p>
<p>为了写第二题，钻研了两天 PNG 文件格式。托这道题的福，让我成功发现了“奶奶的睡前 flag 故事”题目图片中出现了多余的 IDAT 块和 IEND 块。</p>
<p>尝试了把图像位宽压缩到 2 bit，使用 PLTE 块索引颜色，IDAT 块内每一行都使用左过滤（或第一行左过滤，后续均使用上过滤）。</p>
<p>但得到的图像尾部始终有大量的 <code>00</code> 字节，将其删除会导致图像下方若干行消失。</p>
<p>使用 png 压图始终不能将图片压缩到 1.21 KB 以下，遂放弃。</p>
<h2 id="komm-süsser-flagge">Komm, süsser Flagge</h2>
<p>看到题的第一反应：把 HTTP 请求拆成两个包，一个包发送 <code>P</code> ，另一个包发送 <code>OST</code> 及后续即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> socket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;202.38.93.111&#39;</span>
</span></span><span style="display:flex;"><span>port <span style="color:#f92672">=</span> <span style="color:#ae81ff">18082</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>request <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;&#34;POST / HTTP/1.1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Host: 202.38.93.111:18082
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Content-Type: application/x-www-form-urlencoded
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Content-Length: 100
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">149:u149=&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>print(request)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET, socket<span style="color:#f92672">.</span>SOCK_STREAM) <span style="color:#66d9ef">as</span> s:
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>connect((host, port))
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>send(request)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    response <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">4096</span>)
</span></span><span style="display:flex;"><span>    print(response<span style="color:#f92672">.</span>decode())
</span></span></code></pre></div><p>结果发现第二题也能过，后来了解到是题目出的有问题。</p>
<p>第三题，只允许前 50 个字节包含 <code>GET / HTTP</code> 的 TCP 包通过，自然考虑到在 TCP 包的 Header 里塞入这个字符串。</p>
<p>于是在研究了一晚上手搓协议栈之后选择了放弃，不过第二天突然发现有个好用的库叫做 <code>scapy</code>，直接找了份现成的代码做了小修改。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># ref: https://blog.csdn.net/qq_43402663/article/details/122755489</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scapy.all <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scapy.layers.http <span style="color:#f92672">import</span> HTTP
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scapy.layers.inet <span style="color:#f92672">import</span> IP, TCP, IPOption
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scapy.layers.l2 <span style="color:#f92672">import</span> Ether
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hello&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dst_ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;202.38.93.111&#34;</span>
</span></span><span style="display:flex;"><span>dst_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">18082</span>
</span></span><span style="display:flex;"><span>src_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">20001</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;&#34;POST / HTTP/1.1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Host: 202.38.93.111:18082
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Content-Type: application/x-www-form-urlencoded
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Content-Length: 100
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">149:u149=&#34;&#34;&#34;</span><span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    spk1 <span style="color:#f92672">=</span> IP(dst<span style="color:#f92672">=</span>dst_ip, options<span style="color:#f92672">=</span>IPOption(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x21\x0C</span><span style="color:#e6db74">GET / HTTP&#39;</span>)) <span style="color:#f92672">/</span> TCP(dport<span style="color:#f92672">=</span>dst_port, sport<span style="color:#f92672">=</span>src_port, flags<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;S&#34;</span>)
</span></span><span style="display:flex;"><span>    res1 <span style="color:#f92672">=</span> sr1(spk1)
</span></span><span style="display:flex;"><span>    print(res1)
</span></span><span style="display:flex;"><span>    ack1 <span style="color:#f92672">=</span> res1[TCP]<span style="color:#f92672">.</span>ack
</span></span><span style="display:flex;"><span>    ack2 <span style="color:#f92672">=</span> res1[TCP]<span style="color:#f92672">.</span>seq <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    spk2 <span style="color:#f92672">=</span> IP(dst<span style="color:#f92672">=</span>dst_ip, options<span style="color:#f92672">=</span>IPOption(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x21\x0C</span><span style="color:#e6db74">GET / HTTP&#39;</span>)) <span style="color:#f92672">/</span> TCP(dport<span style="color:#f92672">=</span>dst_port, sport<span style="color:#f92672">=</span>src_port, seq<span style="color:#f92672">=</span>ack1, ack<span style="color:#f92672">=</span>ack2, falgs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;A&#34;</span>)
</span></span><span style="display:flex;"><span>    send(spk2)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>    print(e)
</span></span><span style="display:flex;"><span>da1 <span style="color:#f92672">=</span> IP(dst<span style="color:#f92672">=</span>dst_ip, options<span style="color:#f92672">=</span>IPOption(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x21\x0C</span><span style="color:#e6db74">GET / HTTP&#39;</span>)) <span style="color:#f92672">/</span> TCP(dport<span style="color:#f92672">=</span>dst_port, sport<span style="color:#f92672">=</span>src_port, seq<span style="color:#f92672">=</span>ack1, ack<span style="color:#f92672">=</span>ack2, flags<span style="color:#f92672">=</span><span style="color:#ae81ff">24</span>) <span style="color:#f92672">/</span> data
</span></span><span style="display:flex;"><span>res2 <span style="color:#f92672">=</span> sr1(da1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># flag{1p_OoOpt10ns_c0fa9b7b01}</span>
</span></span></code></pre></div><h2 id="为什么要打开-flag-">为什么要打开 /flag 😡</h2>
<p>第一题，<code>LD_PRELOAD</code> 导致 <code>open</code> 等函数变成了被指定的库中的函数。</p>
<p>搜了大半天没找到怎么绕过 <code>LD_PRELOAD</code> （不过官方题解说只要静态编译就好了）。</p>
<p>于是看了看提供的被修改的库，发现 <code>isflag</code> 函数调用了 <code>strstr</code> ，而 <code>strstr</code> 没有在该库中被定义。</p>
<p>抱着随便试一试的心态，自己定义了 <code>strstr</code> 这个函数，使其始终返回 <code>NULL</code> ，结果就过了。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;fcntl.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;unistd.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;sys/types.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;sys/stat.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> s[<span style="color:#ae81ff">50</span>] <span style="color:#f92672">=</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">strstr</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>a, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> NULL;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> f <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;./flag&#34;</span>, O_RDONLY);
</span></span><span style="display:flex;"><span>    read(f, s, <span style="color:#66d9ef">sizeof</span>(s));
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;%s&#34;</span>, s);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>第二题，根据代码中给出的提示</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">// This source code modifies code from [greenhook crate](https://crates.io/crates/greenhook).
</span></span></span></code></pre></div><p>一路搜寻，发现这是 taoky 写的库，是 taoky 出的题，并且得知需要使用 TOCTOU 攻击。</p>
<p>然而努力了一天修改系统调用的寄存器之后发现 ptrace 被禁用，遂不知道如何解题，放弃。</p>
<h2 id="异星歧途">异星歧途</h2>
<p>感觉挺像异星工场，好像还有一个游戏叫异形工厂，也和它挺像的。</p>
<p>异星歧途是 mindastry，异星工场是 factorio，异形工厂是 shape.z</p>
<p>这些游戏中文名都挺像的，英文名起名风格也都一样，都是一个符合游戏主题的单词加一个字母。</p>
<h2 id="小-z-的谜题">小 Z 的谜题</h2>
<p>题目代码中写道 <code>constraints</code> ，题目又是小 Z。很难不让人想到 Z3 Solver。</p>
<p><code>stage 0 &amp; 1</code> 不用考虑，<code>stage 2</code> 要求了一个奇怪的顺序，<code>stage 3</code> 要求满足若干个约束。</p>
<p>直接上 Z3 求解，不需要知道为什么。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> Int, And, Or, solve, PbEq, PbGe, PbLe, Solver, Not, Distinct, sat
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> itertools
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_solver</span>(ss):
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> ss<span style="color:#f92672">.</span>model()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    numbers <span style="color:#f92672">=</span> [[[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>)] <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>)] <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>                numbers[i][j][k] <span style="color:#f92672">=</span> m<span style="color:#f92672">.</span>eval(arrange[i][j][k])<span style="color:#f92672">.</span>as_long()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    numbers <span style="color:#f92672">=</span> sorted(numbers)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    st <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>                st <span style="color:#f92672">+=</span> (chr(ord(<span style="color:#e6db74">&#39;0&#39;</span>) <span style="color:#f92672">+</span> numbers[i][j][k]))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> st
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>arrange <span style="color:#f92672">=</span> [[[Int(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;A_</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">{</span>j<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">{</span>k<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>)] <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>)] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stage_1 <span style="color:#f92672">=</span> [And(arrange[i][j][k] <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>, arrange[i][j][k] <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">5</span>) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>constraints <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>count <span style="color:#f92672">=</span> [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stage_2 <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>        stage_2<span style="color:#f92672">.</span>append(Or(
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;=</span> arrange[j][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>], arrange[j][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;=</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>],
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;=</span> arrange[j][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>], arrange[j][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;=</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>],
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;=</span> arrange[j][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>], arrange[j][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;=</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stage_3_tmp <span style="color:#f92672">=</span> [[] <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">6</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>    stage_3_tmp[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>append(Or(
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>    ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    stage_3_tmp[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>append(Or(
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>    ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    stage_3_tmp[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>append(Or(
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>    ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    stage_3_tmp[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">.</span>append(Or(
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>),
</span></span><span style="display:flex;"><span>    ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    stage_3_tmp[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">.</span>append(And(
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    stage_3_tmp[<span style="color:#ae81ff">5</span>]<span style="color:#f92672">.</span>append(Or(
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        And(arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>            arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> arrange[i][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>    ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stage_3 <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(count)):
</span></span><span style="display:flex;"><span>    stage_3<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>        PbEq([(x, <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> stage_3_tmp[i]], count[i])
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># for 157</span>
</span></span><span style="display:flex;"><span>stage_5 <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    Distinct(arrange[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>], arrange[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>], arrange[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>], arrange[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>], arrange[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]),
</span></span><span style="display:flex;"><span>    Distinct(arrange[<span style="color:#ae81ff">5</span>][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>], arrange[<span style="color:#ae81ff">6</span>][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>], arrange[<span style="color:#ae81ff">7</span>][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>], arrange[<span style="color:#ae81ff">8</span>][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>], arrange[<span style="color:#ae81ff">9</span>][<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>]),
</span></span><span style="display:flex;"><span>    Distinct(arrange[<span style="color:#ae81ff">10</span>][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>], arrange[<span style="color:#ae81ff">11</span>][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>], arrange[<span style="color:#ae81ff">12</span>][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>], arrange[<span style="color:#ae81ff">13</span>][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>], arrange[<span style="color:#ae81ff">14</span>][<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">checker</span>(inp):
</span></span><span style="display:flex;"><span>    aa <span style="color:#f92672">=</span> [[[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>)] <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>)] <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>)]
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> (c <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> inp<span style="color:#f92672">.</span>strip())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> k <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>                    aa[i][j][k] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                    aa[i][j][k] <span style="color:#f92672">=</span> int(next(s))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    score <span style="color:#f92672">=</span> len(set((x, y, z) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>) <span style="color:#66d9ef">for</span> x, y, z <span style="color:#f92672">in</span> itertools<span style="color:#f92672">.</span>product(<span style="color:#f92672">*</span>aa[i])))
</span></span><span style="display:flex;"><span>    print(inp, <span style="color:#e6db74">&#34; : &#34;</span>, score)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    sss <span style="color:#f92672">=</span> Solver()
</span></span><span style="display:flex;"><span>    sss<span style="color:#f92672">.</span>add(stage_1 <span style="color:#f92672">+</span> stage_2 <span style="color:#f92672">+</span> stage_3 <span style="color:#f92672">+</span> stage_5)
</span></span><span style="display:flex;"><span>    sss<span style="color:#f92672">.</span>check()
</span></span><span style="display:flex;"><span>    checker(print_solver(ss<span style="color:#f92672">=</span>sss))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 136: 022424030202030224032402034501040445044515232424340224343414350202352304353501450224450345453515</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 157: 013535014503020135021335022402030202040423143434153545154504240335252402350201350212450345450424</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#      010235020313022535023513034501040401120235231515240115341412351324351345353525354502450125450402</span>
</span></span></code></pre></div><p>136 的情况随便跑跑就出来了，157 比较难出，于是额外加了一些意识流约束，要求元素尽可能不相同以得到更高的分数。</p>
<h2 id="后记">后记</h2>
<p>连着打了三年，从 33 名到 17 名，再到今年第 5 名，拿到了二等奖，也算是不给大学生活留下遗憾了。明年要是再打，就不再是以校内选手的身份参与了。</p>
<p>
  <p><img src="https://s2.loli.net/2023/11/06/sAcS2fEauwqx4WH.jpg" alt="20231105_2.jpg" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>
  <p><img src="https://s2.loli.net/2023/11/06/6EDkSr1mBzpY9bc.jpg" alt="20231105_3.jpg" loading="lazy" onclick="showBig(this)"/></p>
</p>

          </div>
        </div>
                 
      
  
  
  
  

  

  <div class="article-paging">
    
    
      <section class="post-paging--item card-container content-padding-primary soft-size--primary soft-style--box">
  <a href="/posts/tencentintern/">
  <div class="card-cover" background-image-lazy data-img="https://s2.loli.net/2023/09/01/hAri4MDuqdgK7oN.jpg"></div>
  <div class="card-text">
    <h4 class="card-text--title">实习小结</h4>
    <p class="card-text--row">2023-09-01 11:22</p>
  </div>
  </a>
</section>
    
  </div>
</div>
  <aside class="widget-info">
    
<section class="aside-widget widget-author content-padding-large soft-size--large soft-style--box">
  <div class="widget-body">
    <div class="author-box avatar">
      
      <img class="author-avatar soft-size--round soft-style--box" src="https://avatars.githubusercontent.com/u/47293990?s=100" alt="Citrine">
      
      <h2 class="author-name text-ellipsis">Citrine</h2>
      
      <p class="author-desc text-ellipsis">A USTCer</p>
      
    </div>
  </div>
</section>


    

<section class="aside-widget widget-toc content-padding-large soft-size--large soft-style--scrollbox">
  <h2 class="widget-header">
    <div class="title">
      <span>目录</span>
    </div>
  </h2>
  <div class="widget-body">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#奶奶的睡前-flag-故事">奶奶的睡前 flag 故事</a></li>
    <li><a href="#组委会模拟器">组委会模拟器</a></li>
    <li><a href="#虫">虫</a></li>
    <li><a href="#json--yaml">JSON ⊂ YAML?</a></li>
    <li><a href="#git-git">Git? Git!</a></li>
    <li><a href="#http-集邮册">HTTP 集邮册</a></li>
    <li><a href="#docker-for-everyone">Docker for Everyone</a></li>
    <li><a href="#惜字如金-20">惜字如金 2.0</a></li>
    <li><a href="#-高频率星球">🪐 高频率星球</a></li>
    <li><a href="#-小型大语言模型星球">🪐 小型大语言模型星球</a></li>
    <li><a href="#-流式星球">🪐 流式星球</a></li>
    <li><a href="#-低带宽星球">🪐 低带宽星球</a></li>
    <li><a href="#komm-süsser-flagge">Komm, süsser Flagge</a></li>
    <li><a href="#为什么要打开-flag-">为什么要打开 /flag 😡</a></li>
    <li><a href="#异星歧途">异星歧途</a></li>
    <li><a href="#小-z-的谜题">小 Z 的谜题</a></li>
    <li><a href="#后记">后记</a></li>
  </ul>
</nav>
  </div>
</section>


    








<section class="aside-widget widget-articles content-padding-large soft-size--large soft-style--box">
  <h2 class="widget-header">
    <div class="title">
      <span>相关文章</span>
    </div>
  </h2>
  <div class="widget-body">
    <ul class="post-list">
      
      
        <li class="post-item"><a href="/posts/hackergame2022/">HackerGame2022 WriteUP</a></li>
      
        <li class="post-item"><a href="/posts/solutionprize/">【题解】 领奖台数</a></li>
      
        <li class="post-item"><a href="/posts/solutioncf1452d/">【题解】 CF1452D Radio Towers</a></li>
      
        <li class="post-item"><a href="/posts/solutionp5020/">【题解】 P5020 【货币系统】</a></li>
      
    </ul>
  </div>
</section>


    





    




<section class="aside-widget widget-tags content-padding-large soft-size--large soft-style--box">
  <h2 class="widget-header">
    <div class="title">
      <span>聚合标签</span>
    </div>
  </h2>
  <div class="widget-body">
    <div class="tags-list">
      
        <a href="https://txtxj.top/tags/%E7%AC%94%E8%AE%B0/" data-count="16" class="soft-size--small soft-style--hover soft-style--active">笔记</a>
      
        <a href="https://txtxj.top/tags/unity/" data-count="9" class="soft-size--small soft-style--hover soft-style--active">Unity</a>
      
        <a href="https://txtxj.top/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" data-count="7" class="soft-size--small soft-style--hover soft-style--active">图形学</a>
      
        <a href="https://txtxj.top/tags/%E9%A2%98%E8%A7%A3/" data-count="5" class="soft-size--small soft-style--hover soft-style--active">题解</a>
      
        <a href="https://txtxj.top/tags/c#/" data-count="2" class="soft-size--small soft-style--hover soft-style--active">C#</a>
      
        <a href="https://txtxj.top/tags/ctf/" data-count="2" class="soft-size--small soft-style--hover soft-style--active">CTF</a>
      
    </div>
  </div>

  
</section>

  </aside>
</div>
  </main>

  <div id="popup" onclick="hideBig(this)" onmousewheel="return wheelImg(this)">
    <div class="bg"><img src="" alt="" /></div>
  </div><footer class="footer-container layout-block">
  
  <div class="social-icons">
    
      <a class="soft-size--primary soft-style--box" href="https://github.com/txtxj" target="_blank" rel="noopener noreferrer">
          
        <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
          <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
        </svg>
        

        

        

        

        
      </a>
    
  </div>
  

  <div class="colour-bar"></div>
  
  

  

  <p>
    Copyright © 2021 2021 txtxj
  </p>

  <p>
    Powered by
    <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a>
    Theme - 
    <a href="https://github.com/txtxj/hugo-theme-kagome" target="_blank" rel="noopener noreferrer author">kagome</a>
  </p>

  <p>
    <a href="javascript:;" id="theme-light">🌞 浅色</a>
    <a href="javascript:;" id="theme-dark">🌛 深色</a>
    <a href="javascript:;" id="theme-auto">🤖️ 自动</a>
  </p>
  <script src="/js/copy.js"></script>
</footer>



<script type="text/javascript" src="https://csdnimg.cn/release/blog_mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>






</body>

</html>