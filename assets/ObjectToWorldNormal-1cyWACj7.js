import{aa as i,J as k,K as z,S as s,W as a,a3 as l,M as t,ag as y}from"./index-KHt-Lfz7.js";import{_ as w}from"./Image-CidAOCne.js";import"./utils-P3oAz-Uc.js";const M={class:"md-blog m-auto text-left"},T=y("<p><strong>为什么法线向量变换到世界坐标下需要右乘模型变换矩阵的逆矩阵</strong></p><p>在 《Unity ShaderLab 新手宝典》 中 64 页给出了一个结论</p><blockquote><p>在顶点函数中，使用 Unity 提供的变换矩阵 <code>unity_ObjectToWorld</code> 将顶点坐标从模型空间变换到世界空间。为了避免非统一缩放的物体法线方向偏移，使用法线向量右乘逆矩阵的方式对其进行空间变换。</p></blockquote><p>即 <code>worldNormal = mul(vertex， (float3x3)unity_WorldToObject)</code> 。</p><p>首先解释为什么对于非统一缩放的物体，左乘模型变换矩阵可能会导致法线方向偏移。</p><p>考虑一个正方形，它的两条对角线是互相垂直的。</p>",6),j={class:"katex"},L={class:"katex-mathml"},I=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"x")])],-1),N={class:"katex"},B={class:"katex-mathml"},U=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1901em","vertical-align":"-0.345em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8451em"}},[s("span",{style:{top:"-2.655em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.394em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"1")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.345em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])])],-1),A={class:"katex-display"},C={class:"katex"},O={class:"katex-mathml"},W=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord text"},[s("span",{class:"mord cjk_fallback"},"令")]),s("span",{class:"mspace"}," "),s("span",{class:"mord mathbf"},"n"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.3998em","vertical-align":"-0.1944em"}}),s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.2053em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"A"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"C")])]),s("span",{class:"svg-align",style:{top:"-3.6833em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"hide-tail",style:{height:"0.522em","min-width":"0.888em"}},[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"0.522em",viewBox:"0 0 400000 522",preserveAspectRatio:"xMaxYMin slice"},[s("path",{d:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z"})])])])])])])]),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathbf"},"a"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.2053em"}}),s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.2053em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"D")])]),s("span",{class:"svg-align",style:{top:"-3.6833em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"hide-tail",style:{height:"0.522em","min-width":"0.888em"}},[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"0.522em",viewBox:"0 0 400000 522",preserveAspectRatio:"xMaxYMin slice"},[s("path",{d:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z"})])])])])])])]),s("span",{class:"mspace"}," "),s("span",{class:"mord text"},[s("span",{class:"mord cjk_fallback"},"为列向量")])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8913em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8913em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord mathbf"},"a"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"0")]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8019em"}}),s("span",{class:"mord text"},[s("span",{class:"mord cjk_fallback"},"变换后")]),s("span",{class:"mspace"}," "),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8019em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9963em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"Mn")]),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"a"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8019em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"Ma")])]),s("span",{class:"mspace newline"}),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0331em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8019em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.0331em"}},[s("span",{style:{top:"-3.2548em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"a"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8019em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8913em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8913em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"M"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8913em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"Ma")])])],-1),q={class:"katex"},S={class:"katex-mathml"},D=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6861em"}}),s("span",{class:"mord mathbf"},"M")])],-1),R={class:"katex"},V={class:"katex-mathml"},Y=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8413em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"M"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8413em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord mathbf"},"M"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6861em"}}),s("span",{class:"mord mathbf"},"I")])],-1),E={class:"katex"},F={class:"katex-mathml"},G=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9831em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7519em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.9831em"}},[s("span",{style:{top:"-3.2048em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"a"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7519em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"0")])],-1),J={class:"katex"},K={class:"katex-mathml"},P=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7519em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7519em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])])])],-1),X={class:"katex"},H={class:"katex-mathml"},Q=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7519em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"a"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7519em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])])])],-1),Z={class:"katex"},$={class:"katex-mathml"},ss=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7519em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"a"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7519em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])])])],-1),as={class:"katex"},ts={class:"katex-mathml"},ls=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7519em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7519em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])])])],-1),es={class:"katex-display"},ns={class:"katex"},ms={class:"katex-mathml"},ps=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0331em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8019em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.0331em"}},[s("span",{style:{top:"-3.2548em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"a"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8019em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8913em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8913em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"M"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"Ma")]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8913em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8913em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord mathbf"},"a"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"0")])],-1),is={class:"katex"},cs={class:"katex-mathml"},rs=s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9831em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7519em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathbf mtight"},"′")])])])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.9831em"}},[s("span",{style:{top:"-3.2048em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8413em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"n"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8413em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"T")])])])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf"},"M"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])])])],-1),hs=y('<p>以下为 <code>UnityCG.cginc</code> 中的法向量模型-世界变换函数原型。</p><pre class="language-cpp"><code class="language-cpp"><span class="token comment">// Transforms normal from object to world space</span>\n<span class="token keyword">inline</span> float3 <span class="token function">UnityObjectToWorldNormal</span><span class="token punctuation">(</span> in float3 norm <span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">UNITY_ASSUME_UNIFORM_SCALING</span></span>\n    <span class="token keyword">return</span> <span class="token function">UnityObjectToWorldDir</span><span class="token punctuation">(</span>norm<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>\n    <span class="token comment">// mul(IT_M, norm) =&gt; mul(norm, I_M) =&gt; {dot(norm, I_M.col0), dot(norm, I_M.col1), dot(norm, I_M.col2)}</span>\n    <span class="token keyword">return</span> <span class="token function">normalize</span><span class="token punctuation">(</span><span class="token function">mul</span><span class="token punctuation">(</span>norm<span class="token punctuation">,</span> <span class="token punctuation">(</span>float3x3<span class="token punctuation">)</span>unity_WorldToObject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>\n<span class="token punctuation">}</span>\n</code></pre>',2),ys={__name:"ObjectToWorldNormal",setup(os,{expose:v}){return v({frontmatter:{}}),(us,gs)=>{const _=w,e=i("mi"),p=i("mrow"),c=i("annotation"),r=i("semantics"),h=i("math"),o=i("eq"),d=i("mn"),x=i("mfrac"),u=i("mtext"),n=i("mo"),f=i("mover"),g=i("mspace"),m=i("msup"),b=i("eqn");return k(),z("div",M,[T,s("p",null,[a(_,{src:"https://s2.loli.net/2022/05/16/fgJo7bsYwK53uRd.jpg",alt:"20220516_1.jpg","show-toolbar-tooltip":""})]),s("p",null,[l("但在将其 "),a(o,null,{default:t(()=>[s("span",j,[s("span",L,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(e,null,{default:t(()=>[l("x")]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("x")]),_:1})]),_:1})]),_:1})]),I])]),_:1}),l(" 方向变换为原来的 "),a(o,null,{default:t(()=>[s("span",N,[s("span",B,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(x,null,{default:t(()=>[a(d,null,{default:t(()=>[l("1")]),_:1}),a(d,null,{default:t(()=>[l("2")]),_:1})]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\frac{1}{2}")]),_:1})]),_:1})]),_:1})]),U])]),_:1}),l(" 之后，两条对角线不再互相垂直。")]),s("p",null,[a(_,{src:"https://s2.loli.net/2022/05/16/PlUB19D8XnEmFof.jpg",alt:"20220516_2.jpg","show-toolbar-tooltip":""})]),s("p",null,[l("将上述变换写为矩阵乘法的形式， "),s("section",null,[a(b,null,{default:t(()=>[s("span",A,[s("span",C,[s("span",O,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(u,null,{default:t(()=>[l("令 ")]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(f,{accent:"true"},{default:t(()=>[a(p,null,{default:t(()=>[a(e,null,{default:t(()=>[l("A")]),_:1}),a(e,null,{default:t(()=>[l("C")]),_:1})]),_:1}),a(n,{stretchy:"true"},{default:t(()=>[l("→")]),_:1})]),_:1}),a(n,{separator:"true"},{default:t(()=>[l(",")]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(f,{accent:"true"},{default:t(()=>[a(p,null,{default:t(()=>[a(e,null,{default:t(()=>[l("B")]),_:1}),a(e,null,{default:t(()=>[l("D")]),_:1})]),_:1}),a(n,{stretchy:"true"},{default:t(()=>[l("→")]),_:1})]),_:1}),a(u,null,{default:t(()=>[l(" 为列向量")]),_:1}),a(g,{linebreak:"newline"}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(d,null,{default:t(()=>[l("0")]),_:1}),a(g,{linebreak:"newline"}),a(u,null,{default:t(()=>[l("变换后 ")]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(p,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1})]),_:1}),a(n,{separator:"true"},{default:t(()=>[l(",")]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(p,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1})]),_:1}),a(g,{linebreak:"newline"}),a(m,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(p,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1})]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l(" \\text{令}\\ \\mathbf{n} = \\overrightarrow{AC}, \\mathbf{a} = \\overrightarrow{BD} \\ \\text{为列向量}\\\\ \\mathbf{n}^T \\mathbf{a} = 0\\\\ \\text{变换后}\\ \\mathbf{n'} = \\mathbf{Mn}, \\mathbf{a'} = \\mathbf{Ma}\\\\ \\mathbf{n'}^T\\mathbf{a'} = \\mathbf{n}^T \\mathbf{M}^T \\mathbf{Ma} ")]),_:1})]),_:1})]),_:1})]),W])])]),_:1})])]),s("p",null,[l("由于模型变换矩阵 "),a(o,null,{default:t(()=>[s("span",q,[s("span",S,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\mathbf{M}")]),_:1})]),_:1})]),_:1})]),D])]),_:1}),l(" 并不一定是正交矩阵，无法保证 "),a(o,null,{default:t(()=>[s("span",R,[s("span",V,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("I")]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\mathbf{M}^T\\mathbf{M} = \\mathbf{I}")]),_:1})]),_:1})]),_:1})]),Y])]),_:1}),l(" ，因此也就无法保证 "),a(o,null,{default:t(()=>[s("span",E,[s("span",F,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(m,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(d,null,{default:t(()=>[l("0")]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\mathbf{n'}^T\\mathbf{a'} = 0")]),_:1})]),_:1})]),_:1})]),G])]),_:1}),l(" ，即 "),a(o,null,{default:t(()=>[s("span",J,[s("span",K,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\mathbf{n'}")]),_:1})]),_:1})]),_:1})]),P])]),_:1}),l(" 与 "),a(o,null,{default:t(()=>[s("span",X,[s("span",H,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\mathbf{a'}")]),_:1})]),_:1})]),_:1})]),Q])]),_:1}),l(" 不一定垂直。")]),s("p",null,[l("从上式不难看出，如果想要变换后向量 "),a(o,null,{default:t(()=>[s("span",Z,[s("span",$,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\mathbf{a'}")]),_:1})]),_:1})]),_:1})]),ss])]),_:1}),l(" 与其法向量 "),a(o,null,{default:t(()=>[s("span",as,[s("span",ts,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\mathbf{n'}")]),_:1})]),_:1})]),_:1})]),ls])]),_:1}),l(" 仍保持垂直关系，那么一定有 "),s("section",null,[a(b,null,{default:t(()=>[s("span",es,[s("span",ns,[s("span",ms,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(m,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(p,null,{default:t(()=>[a(n,null,{default:t(()=>[l("−")]),_:1}),a(d,null,{default:t(()=>[l("1")]),_:1})]),_:1})]),_:1}),a(p,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1})]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(e,{mathvariant:"bold"},{default:t(()=>[l("a")]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(d,null,{default:t(()=>[l("0")]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l(" \\mathbf{n'}^T\\mathbf{a'} = \\mathbf{n}^T \\mathbf{M}^{-1} \\mathbf{Ma} = \\mathbf{n}^T \\mathbf{a} = 0 ")]),_:1})]),_:1})]),_:1})]),ps])])]),_:1})]),l(" 故 "),a(o,null,{default:t(()=>[s("span",is,[s("span",cs,[a(h,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(m,null,{default:t(()=>[a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(n,{mathvariant:"bold",lspace:"0em",rspace:"0em"},{default:t(()=>[l("′")]),_:1})]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(n,null,{default:t(()=>[l("=")]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("n")]),_:1}),a(e,null,{default:t(()=>[l("T")]),_:1})]),_:1}),a(m,null,{default:t(()=>[a(e,{mathvariant:"bold"},{default:t(()=>[l("M")]),_:1}),a(p,null,{default:t(()=>[a(n,null,{default:t(()=>[l("−")]),_:1}),a(d,null,{default:t(()=>[l("1")]),_:1})]),_:1})]),_:1})]),_:1}),a(c,{encoding:"application/x-tex"},{default:t(()=>[l("\\mathbf{n'}^T = \\mathbf{n}^T \\mathbf{M}^{-1}")]),_:1})]),_:1})]),_:1})]),rs])]),_:1}),l(" ，法向量需要右乘模型变换矩阵的逆变换矩阵。")]),hs])}}};export{ys as default};
