System.register(["./index-legacy-x3adtAFw.js","./Image-legacy-3nB_EV2c.js","./utils-legacy-ycgxyhvx.js"],(function(n,s){"use strict";var a,p,t,o,c,e;return{setters:[function(n){a=n.P,p=n.Q,t=n.a0,o=n.M,c=n.ag},function(n){e=n._},null],execute:function(){var s={class:"md-blog m-auto text-left"},u=c('<h2 id="%E5%A5%B6%E5%A5%B6%E7%9A%84%E7%9D%A1%E5%89%8D-flag-%E6%95%85%E4%BA%8B" tabindex="-1"><a class="header-anchor" href="#%E5%A5%B6%E5%A5%B6%E7%9A%84%E7%9D%A1%E5%89%8D-flag-%E6%95%85%E4%BA%8B" data-clickable=""><span>å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹</span></a></h2><p>é¢˜ç›®ä¸­æåˆ° <strong>è°·æ­Œçš„ã€äº²å„¿å­ã€</strong> <strong>è¿ç³»ç»Ÿéƒ½æ²¡å¿ƒæ€å‡çº§</strong> æ¨æµ‹å¯èƒ½æ˜¯ pixel è€ç³»ç»Ÿçš„ä¸€ä¸ª bugã€‚</p><p>æœç´¢ä¸€åœˆï¼Œæœåˆ° Windows 11 åŒæ ·æœ‰è¿™ä¸ª bug ï¼Œå±å¹•æˆªå›¾åå‰ªåˆ‡å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œè¢«å‰ªåˆ‡çš„æ•°æ®ä»ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œä½äº IEND æ ‡ç­¾åã€‚</p><p>ä½¿ç”¨ 010 Editor æ£€æŸ¥ï¼Œå‘ç°å›¾ç‰‡ IEND åä»æœ‰å¤§é‡ IDAT å’Œä¸€ä¸ª IENDï¼Œç¬¦åˆ aCropalypse æ¼æ´ï¼Œåœ¨ <a href="https://acropalypse.app/" data-clickable="">acropalypse.app</a> ä¸Šæ¢å¤å³å¯ ã€‚</p><h2 id="%E7%BB%84%E5%A7%94%E4%BC%9A%E6%A8%A1%E6%8B%9F%E5%99%A8" tabindex="-1"><a class="header-anchor" href="#%E7%BB%84%E5%A7%94%E4%BC%9A%E6%A8%A1%E6%8B%9F%E5%99%A8" data-clickable=""><span>ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨</span></a></h2><p>ç›´æ¥å†™ä¸ªè„šæœ¬è·‘å°±å®Œäº†</p><pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>\n    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>\n        <span class="token keyword">var</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&#39;fakeqq-container&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n        container<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;DOMSubtreeModified&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">var</span> bubble <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>children<span class="token punctuation">[</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n            <span class="token keyword">var</span> txt <span class="token operator">=</span> bubble<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span>\n            <span class="token keyword">var</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">hack\\[[a-z]+\\]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>\n            <span class="token keyword">var</span> pos <span class="token operator">=</span> txt<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>re<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                <span class="token keyword">const</span> event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MouseEvent</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n                    <span class="token literal-property property">view</span><span class="token operator">:</span> window<span class="token punctuation">,</span>\n                    <span class="token literal-property property">bubbles</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n                    <span class="token literal-property property">cancelable</span><span class="token operator">:</span> <span class="token boolean">true</span>\n                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                bubble<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><h2 id="%E8%99%AB" tabindex="-1"><a class="header-anchor" href="#%E8%99%AB" data-clickable=""><span>è™«</span></a></h2><p>å†™å®Œç­¾åˆ°é¢˜å°±è¿‡æ¥å†™è¿™ä¸ªé¢˜äº†ï¼Œå–œæä¸€è¡€å¥–ã€‚</p><p>æœç´¢ ISS å¯çŸ¥é¢˜ç›®éŸ³é¢‘æ˜¯ä¸€æ®µ SSTV ä¿¡å·ï¼Œä¸‹è½½ RX-SSTV è§£ç å³å¯ã€‚</p><h2 id="json-%E2%8A%82-yaml%3F" tabindex="-1"><a class="header-anchor" href="#json-%E2%8A%82-yaml%3F" data-clickable=""><span>JSON âŠ‚ YAML?</span></a></h2><p>å…ˆéšæœºè¯•äº†ä¸€ä¸‹ç›¸åŒé”®åï¼Œæ‹¿åˆ° flag2ã€‚</p><p>æ¥ç€å¼€å§‹æœç´¢ï¼Œæ‰¾åˆ°è¿™ä¸ªå¸–å­ <a href="https://stackoverflow.com/questions/21584985/what-valid-json-files-are-not-valid-yaml-1-1-files" data-clickable="">what-valid-json-files-are-not-valid-yaml-1-1-files(stackoverflow)</a>ï¼Œ</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">&quot;123&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token property">&quot;123&quot;</span><span class="token operator">:</span> <span class="token number">12345e999</span> <span class="token punctuation">}</span>\n</code></pre><h2 id="git%3F-git!" tabindex="-1"><a class="header-anchor" href="#git%3F-git!" data-clickable=""><span>Git? Git!</span></a></h2><p><code>git log</code> æ£€æŸ¥å‘ç°å­˜åœ¨ä¸€æ¬¡ <code>reset</code> è®°å½•ï¼Œå†æ¬¡ä½¿ç”¨ <code>git reset</code> å›é€€ï¼Œæ£€æŸ¥ <code>README.md</code> å¾—åˆ° flagã€‚</p><h2 id="http-%E9%9B%86%E9%82%AE%E5%86%8C" tabindex="-1"><a class="header-anchor" href="#http-%E9%9B%86%E9%82%AE%E5%86%8C" data-clickable=""><span>HTTP é›†é‚®å†Œ</span></a></h2><p>æœ¬æ¥æ²¡å†²ç€ä¸€è¡€æ¥çš„ï¼Œç»“æœè«åå…¶å¦™ä¸€è¡€äº†ã€‚</p><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç…§ç€ <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" data-clickable="">MDN</a> ä¸€ä¸ªä¸€ä¸ªè¯•å°±è¡Œäº†ã€‚</p><h2 id="docker-for-everyone" tabindex="-1"><a class="header-anchor" href="#docker-for-everyone" data-clickable=""><span>Docker for Everyone</span></a></h2><p>è¯•å›¾ç»™æˆ‘é‚£ C ç›˜é€šçº¢çš„ Windows å®‰è£… Dockerï¼Œç»“æœå¤§å¤±è´¥ï¼Œè¿™ä¸ªé¢˜æ”¾äº†å¥½ä¹…éƒ½æ²¡å†™ã€‚</p><p>åæ¥çœ‹å†™å‡ºæ¥çš„äººé‚£ä¹ˆå¤šï¼Œå°±ç›´æ¥åœ¨ç½‘é¡µç»ˆç«¯ä¸Šè¯•ç€å†™äº†ã€‚</p><p>ç›´æ¥æ‰“å¼€ flag æ˜¯ä¸è¡Œçš„ï¼Œæ²¡æœ‰æƒé™ã€‚è¯•ç€ç”¨ docker æŠŠ flag ååœ¨æ–‡ä»¶å¤¹æŒ‚è½½åˆ°å®¹å™¨å†…ï¼Œå‘ç°å¯ä»¥ç›´æ¥æ‰“å¼€ï¼Œè·å¾— flagã€‚</p><h2 id="%E6%83%9C%E5%AD%97%E5%A6%82%E9%87%91-2.0" tabindex="-1"><a class="header-anchor" href="#%E6%83%9C%E5%AD%97%E5%A6%82%E9%87%91-2.0" data-clickable=""><span>æƒœå­—å¦‚é‡‘ 2.0</span></a></h2><p>å»å¹´çš„æƒœå­—å¦‚é‡‘å®Œå…¨çœ‹ä¸æ‡‚ï¼Œäºæ˜¯ä»Šå¹´çœ‹åˆ°è¿™ä¸ªé¢˜ï¼Œåˆçœ‹åˆ°ä¸€ä¸ª math æ ‡ç­¾ï¼Œç›´æ¥å°±å‡†å¤‡è·³è¿‡äº†ã€‚</p><p>ç»“æœæŠŠç¨‹åºä¸‹è½½ä¸‹æ¥å‘ç°æ„å¤–åœ°å¾ˆç®€å•ï¼Œ<code>cod_dict</code> ä¸€å…±æœ‰ 5 è¡Œï¼Œæ¯ä¸€è¡Œéƒ½ç¼ºå°‘ä¸€ä¸ªå­—ç¬¦ã€‚</p><p>æ ¹æ®ç´¢å¼•è¡¨ï¼Œåœ¨ <code>cod_dict</code> æ‰¾å‰ 5 ä¸ªå­—ç¬¦å’Œæœ€åä¸€ä¸ªå­—ç¬¦ï¼Œä¿è¯å®ƒä»¬åˆ†åˆ«ä¸º <code>flag{</code> å’Œ <code>}</code> ã€‚</p><p>åœ¨ä¿è¯è¿™ä¸€æ¡ä»¶çš„åŸºç¡€ä¸Šï¼Œå‘ç°è¿˜æœªç¡®å®šå“ªä¸ªå­—ç¬¦è¢«æƒœå­—å¦‚é‡‘åŒ–çš„è¡Œå¯¹æœ€ç»ˆç»“æœæ— å½±å“ï¼Œç›´æ¥åœ¨ä»»æ„èƒ½å¤Ÿä¿è¯å‰ç½®æ¡ä»¶çš„ä½ç½®åŠ ä¸Šä»»æ„å­—ç¬¦å³å¯ã€‚</p><h2 id="%F0%9F%AA%90-%E9%AB%98%E9%A2%91%E7%8E%87%E6%98%9F%E7%90%83" tabindex="-1"><a class="header-anchor" href="#%F0%9F%AA%90-%E9%AB%98%E9%A2%91%E7%8E%87%E6%98%9F%E7%90%83" data-clickable=""><span>ğŸª é«˜é¢‘ç‡æ˜Ÿçƒ</span></a></h2><p>Windows ä¸‹è£…ä¸äº† asciinema ï¼Œè·‘å» vlab è£…äº†ä¸€ä¸ªï¼Œç›´æ¥ <code>asciinema cat</code> è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œåˆ é™¤ä¸€äº›æ‚ä¸ƒæ‚å…«çš„ä»£ç å¾—åˆ°ä¸€æ®µ js ä»£ç ï¼Œæ‰§è¡Œå³å¯ã€‚</p><h2 id="%F0%9F%AA%90-%E5%B0%8F%E5%9E%8B%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E6%98%9F%E7%90%83" tabindex="-1"><a class="header-anchor" href="#%F0%9F%AA%90-%E5%B0%8F%E5%9E%8B%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E6%98%9F%E7%90%83" data-clickable=""><span>ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ</span></a></h2><p>ç¬¬ä¸€é¢˜ï¼Œè°ƒæ•™ä¹‹åå‘ç°è¾“å…¥ <code>Is I smart?</code> å³å¯ã€‚</p><p>ç¬¬äºŒé¢˜ï¼Œä¸‹è½½ TinyStories-33M çš„è®­ç»ƒæ•°æ®ï¼Œåœ¨é‡Œé¢æœç´¢ <code>accepted</code> ï¼Œå¹¶æŠŠè¯¥å•è¯å‰çš„ä¸€ä¸ªå•è¯ä½œä¸º promptï¼Œå‘ç° ä»»æ„ä¸»è¯­ + <code>gratefully</code> éƒ½èƒ½è§¦å‘ <code>accepted</code>ï¼Œä½†å¤ªé•¿äº†ï¼Œä¸å¯å–ã€‚</p><p>äºæ˜¯å†™äº†ä¸ªç¨‹åºè·å–è®­ç»ƒé›†ä¸­æ‰€æœ‰çš„ <code>accepted</code> å‰çš„å•è¯ï¼Œå°†å…¶ä½œä¸º promptï¼Œæ‰¾åˆ°ç­”æ¡ˆ <code>atively</code> ã€‚</p><h2 id="%F0%9F%AA%90-%E6%B5%81%E5%BC%8F%E6%98%9F%E7%90%83" tabindex="-1"><a class="header-anchor" href="#%F0%9F%AA%90-%E6%B5%81%E5%BC%8F%E6%98%9F%E7%90%83" data-clickable=""><span>ğŸª æµå¼æ˜Ÿçƒ</span></a></h2><p>010 Editor æ‰“å¼€ bin æ–‡ä»¶ï¼Œå‘ç°å…¶ä¸­æœ‰å¾ˆå¤šé‡å¤çš„ <code>06 08 0A</code></p>',36),l=c('<p>æ¨æµ‹é‡å¤éƒ¨åˆ†æ˜¯å› ä¸ºä¸Šä¸‹ä¸¤è¡Œé¢œè‰²ç›¸åŒã€‚æ‰¾åˆ°å’Œå›¾ä¸­æ ¼å¼ç›¸åŒçš„å¦ä¸€æ®µæ•°æ®ï¼Œèµ·å§‹ä½ç½®ä¸º <code>0x0501</code> ï¼Œæ•…æ¨æµ‹æ¯ä¸€è¡Œåƒç´ ä¸ªæ•°ä¸º <code>427</code> ã€‚</p><p>æ•´ä¸ªæ–‡ä»¶æœ‰ <code>0x80E2CBF</code> ä¸ªå­—èŠ‚ï¼Œç›¸æ¯”å®Œæ•´ç‰‡æ®µå°‘äº†ä¸åˆ° <code>100</code> ä¸ªå­—èŠ‚ï¼ŒæŒ‰è¡Œå–æ¨¡è¡¥å……å®Œæ•´ï¼Œå¯çŸ¥ä¸€å…±æœ‰ <code>105501</code> è¡Œã€‚</p><p>å°†å…¶åˆ†è§£ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œå¯å¾—åˆ°æ­£ç¡®çš„åˆ†è¾¨ç‡ <code>427 x 759</code>ã€‚</p><p>è¿˜åŸä»£ç </p><pre class="language-py"><code class="language-py"><span class="token keyword">def</span> <span class="token function">numpy_array_to_video</span><span class="token punctuation">(</span>numpy_array<span class="token punctuation">,</span> video_out_path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    numpy_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>numpy_array<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>\n    video_height <span class="token operator">=</span> numpy_array<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>\n    video_width <span class="token operator">=</span> numpy_array<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>\n\n    out_video_size <span class="token operator">=</span> <span class="token punctuation">(</span>video_width<span class="token punctuation">,</span> video_height<span class="token punctuation">)</span>\n    output_video_fourcc <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>VideoWriter_fourcc<span class="token punctuation">(</span><span class="token operator">*</span><span class="token string">&#39;mp4v&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    video_write_capture <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoWriter<span class="token punctuation">(</span>video_out_path<span class="token punctuation">,</span> output_video_fourcc<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> out_video_size<span class="token punctuation">)</span>\n\n    <span class="token keyword">for</span> frame <span class="token keyword">in</span> numpy_array<span class="token punctuation">:</span>\n        video_write_capture<span class="token punctuation">.</span>write<span class="token punctuation">(</span>frame<span class="token punctuation">)</span>\n\n    video_write_capture<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre><h2 id="%F0%9F%AA%90-%E4%BD%8E%E5%B8%A6%E5%AE%BD%E6%98%9F%E7%90%83" tabindex="-1"><a class="header-anchor" href="#%F0%9F%AA%90-%E4%BD%8E%E5%B8%A6%E5%AE%BD%E6%98%9F%E7%90%83" data-clickable=""><span>ğŸª ä½å¸¦å®½æ˜Ÿçƒ</span></a></h2><p>ç¬¬ä¸€é¢˜éšä¾¿æ‰¾ä¸ªåœ¨çº¿å‹ç¼©ç½‘ç«™å‹ä¸€ä¸‹å°±è¡Œã€‚</p><p>ä¸ºäº†å†™ç¬¬äºŒé¢˜ï¼Œé’»ç ”äº†ä¸¤å¤© PNG æ–‡ä»¶æ ¼å¼ã€‚æ‰˜è¿™é“é¢˜çš„ç¦ï¼Œè®©æˆ‘æˆåŠŸå‘ç°äº†â€œå¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹â€é¢˜ç›®å›¾ç‰‡ä¸­å‡ºç°äº†å¤šä½™çš„ IDAT å—å’Œ IEND å—ã€‚</p><p>å°è¯•äº†æŠŠå›¾åƒä½å®½å‹ç¼©åˆ° 2 bitï¼Œä½¿ç”¨ PLTE å—ç´¢å¼•é¢œè‰²ï¼ŒIDAT å—å†…æ¯ä¸€è¡Œéƒ½ä½¿ç”¨å·¦è¿‡æ»¤ï¼ˆæˆ–ç¬¬ä¸€è¡Œå·¦è¿‡æ»¤ï¼Œåç»­å‡ä½¿ç”¨ä¸Šè¿‡æ»¤ï¼‰ã€‚</p><p>ä½†å¾—åˆ°çš„å›¾åƒå°¾éƒ¨å§‹ç»ˆæœ‰å¤§é‡çš„ <code>00</code> å­—èŠ‚ï¼Œå°†å…¶åˆ é™¤ä¼šå¯¼è‡´å›¾åƒä¸‹æ–¹è‹¥å¹²è¡Œæ¶ˆå¤±ã€‚</p><p>ä½¿ç”¨ png å‹å›¾å§‹ç»ˆä¸èƒ½å°†å›¾ç‰‡å‹ç¼©åˆ° 1.21 KB ä»¥ä¸‹ï¼Œé‚æ”¾å¼ƒã€‚</p><h2 id="komm%2C-s%C3%BCsser-flagge" tabindex="-1"><a class="header-anchor" href="#komm%2C-s%C3%BCsser-flagge" data-clickable=""><span>Komm, sÃ¼sser Flagge</span></a></h2><p>çœ‹åˆ°é¢˜çš„ç¬¬ä¸€ååº”ï¼šæŠŠ HTTP è¯·æ±‚æ‹†æˆä¸¤ä¸ªåŒ…ï¼Œä¸€ä¸ªåŒ…å‘é€ <code>P</code> ï¼Œå¦ä¸€ä¸ªåŒ…å‘é€ <code>OST</code> åŠåç»­å³å¯ã€‚</p><pre class="language-py"><code class="language-py"><span class="token keyword">import</span> socket\n\nhost <span class="token operator">=</span> <span class="token string">&#39;202.38.93.111&#39;</span>\nport <span class="token operator">=</span> <span class="token number">18082</span>\n\nrequest <span class="token operator">=</span> <span class="token triple-quoted-string string">b&quot;&quot;&quot;POST / HTTP/1.1\nHost: 202.38.93.111:18082\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 100\n\n149:u149=&quot;&quot;&quot;</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>\n\n\n<span class="token keyword">with</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token keyword">as</span> s<span class="token punctuation">:</span>\n    s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>request<span class="token punctuation">)</span>\n\n    response <span class="token operator">=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n</code></pre><p>ç»“æœå‘ç°ç¬¬äºŒé¢˜ä¹Ÿèƒ½è¿‡ï¼Œåæ¥äº†è§£åˆ°æ˜¯é¢˜ç›®å‡ºçš„æœ‰é—®é¢˜ã€‚</p><p>ç¬¬ä¸‰é¢˜ï¼Œåªå…è®¸å‰ 50 ä¸ªå­—èŠ‚åŒ…å« <code>GET / HTTP</code> çš„ TCP åŒ…é€šè¿‡ï¼Œè‡ªç„¶è€ƒè™‘åˆ°åœ¨ TCP åŒ…çš„ Header é‡Œå¡å…¥è¿™ä¸ªå­—ç¬¦ä¸²ã€‚</p><p>äºæ˜¯åœ¨ç ”ç©¶äº†ä¸€æ™šä¸Šæ‰‹æ“åè®®æ ˆä¹‹åé€‰æ‹©äº†æ”¾å¼ƒï¼Œä¸è¿‡ç¬¬äºŒå¤©çªç„¶å‘ç°æœ‰ä¸ªå¥½ç”¨çš„åº“å«åš <code>scapy</code>ï¼Œç›´æ¥æ‰¾äº†ä»½ç°æˆçš„ä»£ç åšäº†å°ä¿®æ”¹ã€‚</p><pre class="language-py"><code class="language-py"><span class="token comment"># ref: https://blog.csdn.net/qq_43402663/article/details/122755489</span>\n<span class="token keyword">from</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span>\n\n<span class="token keyword">from</span> scapy<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>http <span class="token keyword">import</span> HTTP\n<span class="token keyword">from</span> scapy<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>inet <span class="token keyword">import</span> IP<span class="token punctuation">,</span> TCP<span class="token punctuation">,</span> IPOption\n<span class="token keyword">from</span> scapy<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>l2 <span class="token keyword">import</span> Ether\n\npayload <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span>\n\ndst_ip <span class="token operator">=</span> <span class="token string">&quot;202.38.93.111&quot;</span>\ndst_port <span class="token operator">=</span> <span class="token number">18082</span>\nsrc_port <span class="token operator">=</span> <span class="token number">20001</span>\ndata <span class="token operator">=</span> <span class="token triple-quoted-string string">b&quot;&quot;&quot;POST / HTTP/1.1\nHost: 202.38.93.111:18082\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 100\n\n149:u149=&quot;&quot;&quot;</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>\n\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    spk1 <span class="token operator">=</span> IP<span class="token punctuation">(</span>dst<span class="token operator">=</span>dst_ip<span class="token punctuation">,</span> options<span class="token operator">=</span>IPOption<span class="token punctuation">(</span><span class="token string">b&#39;\\x21\\x0CGET / HTTP&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> TCP<span class="token punctuation">(</span>dport<span class="token operator">=</span>dst_port<span class="token punctuation">,</span> sport<span class="token operator">=</span>src_port<span class="token punctuation">,</span> flags<span class="token operator">=</span><span class="token string">&quot;S&quot;</span><span class="token punctuation">)</span>\n    res1 <span class="token operator">=</span> sr1<span class="token punctuation">(</span>spk1<span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span>\n    ack1 <span class="token operator">=</span> res1<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>ack\n    ack2 <span class="token operator">=</span> res1<span class="token punctuation">[</span>TCP<span class="token punctuation">]</span><span class="token punctuation">.</span>seq <span class="token operator">+</span> <span class="token number">1</span>\n    spk2 <span class="token operator">=</span> IP<span class="token punctuation">(</span>dst<span class="token operator">=</span>dst_ip<span class="token punctuation">,</span> options<span class="token operator">=</span>IPOption<span class="token punctuation">(</span><span class="token string">b&#39;\\x21\\x0CGET / HTTP&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> TCP<span class="token punctuation">(</span>dport<span class="token operator">=</span>dst_port<span class="token punctuation">,</span> sport<span class="token operator">=</span>src_port<span class="token punctuation">,</span> seq<span class="token operator">=</span>ack1<span class="token punctuation">,</span> ack<span class="token operator">=</span>ack2<span class="token punctuation">,</span> falgs<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span>\n    send<span class="token punctuation">(</span>spk2<span class="token punctuation">)</span>\n<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>\nda1 <span class="token operator">=</span> IP<span class="token punctuation">(</span>dst<span class="token operator">=</span>dst_ip<span class="token punctuation">,</span> options<span class="token operator">=</span>IPOption<span class="token punctuation">(</span><span class="token string">b&#39;\\x21\\x0CGET / HTTP&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> TCP<span class="token punctuation">(</span>dport<span class="token operator">=</span>dst_port<span class="token punctuation">,</span> sport<span class="token operator">=</span>src_port<span class="token punctuation">,</span> seq<span class="token operator">=</span>ack1<span class="token punctuation">,</span> ack<span class="token operator">=</span>ack2<span class="token punctuation">,</span> flags<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">/</span> data\nres2 <span class="token operator">=</span> sr1<span class="token punctuation">(</span>da1<span class="token punctuation">)</span>\n\n<span class="token comment"># flag{1p_OoOpt10ns_c0fa9b7b01}</span>\n</code></pre><h2 id="%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%89%93%E5%BC%80-%2Fflag-%F0%9F%98%A1" tabindex="-1"><a class="header-anchor" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%89%93%E5%BC%80-%2Fflag-%F0%9F%98%A1" data-clickable=""><span>ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡</span></a></h2><p>ç¬¬ä¸€é¢˜ï¼Œ<code>LD_PRELOAD</code> å¯¼è‡´ <code>open</code> ç­‰å‡½æ•°å˜æˆäº†è¢«æŒ‡å®šçš„åº“ä¸­çš„å‡½æ•°ã€‚</p><p>æœäº†å¤§åŠå¤©æ²¡æ‰¾åˆ°æ€ä¹ˆç»•è¿‡ <code>LD_PRELOAD</code> ï¼ˆä¸è¿‡å®˜æ–¹é¢˜è§£è¯´åªè¦é™æ€ç¼–è¯‘å°±å¥½äº†ï¼‰ã€‚</p><p>äºæ˜¯çœ‹äº†çœ‹æä¾›çš„è¢«ä¿®æ”¹çš„åº“ï¼Œå‘ç° <code>isflag</code> å‡½æ•°è°ƒç”¨äº† <code>strstr</code> ï¼Œè€Œ <code>strstr</code> æ²¡æœ‰åœ¨è¯¥åº“ä¸­è¢«å®šä¹‰ã€‚</p><p>æŠ±ç€éšä¾¿è¯•ä¸€è¯•çš„å¿ƒæ€ï¼Œè‡ªå·±å®šä¹‰äº† <code>strstr</code> è¿™ä¸ªå‡½æ•°ï¼Œä½¿å…¶å§‹ç»ˆè¿”å› <code>NULL</code> ï¼Œç»“æœå°±è¿‡äº†ã€‚</p><pre class="language-c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>\n<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>\n<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>\n<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>\n<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>\n\n<span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">strstr</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>b<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">int</span> f <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;./flag&quot;</span><span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">read</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><p>ç¬¬äºŒé¢˜ï¼Œæ ¹æ®ä»£ç ä¸­ç»™å‡ºçš„æç¤º</p><pre class="language-rust"><code class="language-rust"><span class="token comment">// This source code modifies code from [greenhook crate](https://crates.io/crates/greenhook).</span>\n</code></pre><p>ä¸€è·¯æœå¯»ï¼Œå‘ç°è¿™æ˜¯ taoky å†™çš„åº“ï¼Œæ˜¯ taoky å‡ºçš„é¢˜ï¼Œå¹¶ä¸”å¾—çŸ¥éœ€è¦ä½¿ç”¨ TOCTOU æ”»å‡»ã€‚</p><p>ç„¶è€ŒåŠªåŠ›äº†ä¸€å¤©ä¿®æ”¹ç³»ç»Ÿè°ƒç”¨çš„å¯„å­˜å™¨ä¹‹åå‘ç° ptrace è¢«ç¦ç”¨ï¼Œé‚ä¸çŸ¥é“å¦‚ä½•è§£é¢˜ï¼Œæ”¾å¼ƒã€‚</p><h2 id="%E5%BC%82%E6%98%9F%E6%AD%A7%E9%80%94" tabindex="-1"><a class="header-anchor" href="#%E5%BC%82%E6%98%9F%E6%AD%A7%E9%80%94" data-clickable=""><span>å¼‚æ˜Ÿæ­§é€”</span></a></h2><p>æ„Ÿè§‰æŒºåƒå¼‚æ˜Ÿå·¥åœºï¼Œå¥½åƒè¿˜æœ‰ä¸€ä¸ªæ¸¸æˆå«å¼‚å½¢å·¥å‚ï¼Œä¹Ÿå’Œå®ƒæŒºåƒçš„ã€‚</p><p>å¼‚æ˜Ÿæ­§é€”æ˜¯ mindastryï¼Œå¼‚æ˜Ÿå·¥åœºæ˜¯ factorioï¼Œå¼‚å½¢å·¥å‚æ˜¯ shape.z</p><p>è¿™äº›æ¸¸æˆä¸­æ–‡åéƒ½æŒºåƒçš„ï¼Œè‹±æ–‡åèµ·åé£æ ¼ä¹Ÿéƒ½ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸€ä¸ªç¬¦åˆæ¸¸æˆä¸»é¢˜çš„å•è¯åŠ ä¸€ä¸ªå­—æ¯ã€‚</p><h2 id="%E5%B0%8F-z-%E7%9A%84%E8%B0%9C%E9%A2%98" tabindex="-1"><a class="header-anchor" href="#%E5%B0%8F-z-%E7%9A%84%E8%B0%9C%E9%A2%98" data-clickable=""><span>å° Z çš„è°œé¢˜</span></a></h2><p>é¢˜ç›®ä»£ç ä¸­å†™é“ <code>constraints</code> ï¼Œé¢˜ç›®åˆæ˜¯å° Zã€‚å¾ˆéš¾ä¸è®©äººæƒ³åˆ° Z3 Solverã€‚</p><p><code>stage 0 &amp; 1</code> ä¸ç”¨è€ƒè™‘ï¼Œ<code>stage 2</code> è¦æ±‚äº†ä¸€ä¸ªå¥‡æ€ªçš„é¡ºåºï¼Œ<code>stage 3</code> è¦æ±‚æ»¡è¶³è‹¥å¹²ä¸ªçº¦æŸã€‚</p><p>ç›´æ¥ä¸Š Z3 æ±‚è§£ï¼Œä¸éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆã€‚</p><pre class="language-py"><code class="language-py"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> Int<span class="token punctuation">,</span> And<span class="token punctuation">,</span> Or<span class="token punctuation">,</span> solve<span class="token punctuation">,</span> PbEq<span class="token punctuation">,</span> PbGe<span class="token punctuation">,</span> PbLe<span class="token punctuation">,</span> Solver<span class="token punctuation">,</span> Not<span class="token punctuation">,</span> Distinct<span class="token punctuation">,</span> sat\n<span class="token keyword">import</span> itertools\n<span class="token keyword">import</span> time\n\n\n<span class="token keyword">def</span> <span class="token function">print_solver</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    m <span class="token operator">=</span> ss<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n                numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>as_long<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    numbers <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n\n    st <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>\n\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n                st <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">return</span> st\n\n\narrange <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;A_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>j<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>k<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n\nstage_1 <span class="token operator">=</span> <span class="token punctuation">[</span>And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n\nconstraints <span class="token operator">=</span> <span class="token punctuation">(</span>\n    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span>\n\ncount <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>\n\nstage_2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        stage_2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> arrange<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> arrange<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> arrange<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>\n        <span class="token punctuation">)</span><span class="token punctuation">)</span>\n\nstage_3_tmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    stage_3_tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    stage_3_tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    stage_3_tmp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    stage_3_tmp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    stage_3_tmp<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>And<span class="token punctuation">(</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span>\n    <span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    stage_3_tmp<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>Or<span class="token punctuation">(</span>\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        And<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span>\n            arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> arrange<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span><span class="token punctuation">)</span>\n\nstage_3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    stage_3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>\n        PbEq<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> stage_3_tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> count<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span>\n\n<span class="token comment"># for 157</span>\nstage_5 <span class="token operator">=</span> <span class="token punctuation">[</span>\n    Distinct<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Distinct<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Distinct<span class="token punctuation">(</span>arrange<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arrange<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token punctuation">]</span>\n\n\n<span class="token keyword">def</span> <span class="token function">checker</span><span class="token punctuation">(</span>inp<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    aa <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n    s <span class="token operator">=</span> <span class="token punctuation">(</span>c <span class="token keyword">for</span> c <span class="token keyword">in</span> inp<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n                <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>\n                    aa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>\n                <span class="token keyword">else</span><span class="token punctuation">:</span>\n                    aa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    score <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token operator">*</span>aa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span>inp<span class="token punctuation">,</span> <span class="token string">&quot; : &quot;</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span>\n\n\n<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>\n    sss <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    sss<span class="token punctuation">.</span>add<span class="token punctuation">(</span>stage_1 <span class="token operator">+</span> stage_2 <span class="token operator">+</span> stage_3 <span class="token operator">+</span> stage_5<span class="token punctuation">)</span>\n    sss<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    checker<span class="token punctuation">(</span>print_solver<span class="token punctuation">(</span>ss<span class="token operator">=</span>sss<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token comment"># 136: 022424030202030224032402034501040445044515232424340224343414350202352304353501450224450345453515</span>\n<span class="token comment"># 157: 013535014503020135021335022402030202040423143434153545154504240335252402350201350212450345450424</span>\n<span class="token comment">#      010235020313022535023513034501040401120235231515240115341412351324351345353525354502450125450402</span>\n\n</code></pre><p>136 çš„æƒ…å†µéšä¾¿è·‘è·‘å°±å‡ºæ¥äº†ï¼Œ157 æ¯”è¾ƒéš¾å‡ºï¼Œäºæ˜¯é¢å¤–åŠ äº†ä¸€äº›æ„è¯†æµçº¦æŸï¼Œè¦æ±‚å…ƒç´ å°½å¯èƒ½ä¸ç›¸åŒä»¥å¾—åˆ°æ›´é«˜çš„åˆ†æ•°ã€‚</p><h2 id="%E5%90%8E%E8%AE%B0" tabindex="-1"><a class="header-anchor" href="#%E5%90%8E%E8%AE%B0" data-clickable=""><span>åè®°</span></a></h2><p>è¿ç€æ‰“äº†ä¸‰å¹´ï¼Œä» 33 ååˆ° 17 åï¼Œå†åˆ°ä»Šå¹´ç¬¬ 5 åï¼Œæ‹¿åˆ°äº†äºŒç­‰å¥–ï¼Œä¹Ÿç®—æ˜¯ä¸ç»™å¤§å­¦ç”Ÿæ´»ç•™ä¸‹é—æ†¾äº†ã€‚æ˜å¹´è¦æ˜¯å†æ‰“ï¼Œå°±ä¸å†æ˜¯ä»¥æ ¡å†…é€‰æ‰‹çš„èº«ä»½å‚ä¸äº†ã€‚</p>',40);n("title","HackerGame2023 WriteUP"),n("date","2023-11-05T11:45:29.000Z"),n("toc",!0),n("tags",["é¢˜è§£","CTF"]),n("cover","https://s2.loli.net/2023/11/05/HETxNBMAXsLzwop.jpg"),n("grow","mid"),n("default",{__name:"HackerGame2023",setup:function(n,c){return(0,c.expose)({frontmatter:{title:"HackerGame2023 WriteUP",date:"2023-11-05T11:45:29.000Z",toc:!0,tags:["é¢˜è§£","CTF"],cover:"https://s2.loli.net/2023/11/05/HETxNBMAXsLzwop.jpg",grow:"mid"}}),function(n,c){var k=e;return a(),p("div",s,[u,t("p",null,[o(k,{src:"https://s2.loli.net/2023/11/05/NELY8IrUHlSev1h.png",alt:"20231105_1.png","show-toolbar-tooltip":""})]),l,t("p",null,[o(k,{src:"https://s2.loli.net/2023/11/06/sAcS2fEauwqx4WH.jpg",alt:"20231105_2.jpg","show-toolbar-tooltip":""})]),t("p",null,[o(k,{src:"https://s2.loli.net/2023/11/06/6EDkSr1mBzpY9bc.jpg",alt:"20231105_3.jpg","show-toolbar-tooltip":""})])])}}})}}}));
