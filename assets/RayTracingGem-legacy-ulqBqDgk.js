System.register(["./index-legacy-XuNBSaRB.js","./Image-legacy-6YEbEIKw.js","./utils-legacy-KpPitN12.js"],(function(s,a){"use strict";var n,t,l,e,p,c,r,u,i;return{setters:[function(s){n=s.aa,t=s.P,l=s.Q,e=s.a0,p=s.a7,c=s.M,r=s.R,u=s.ag},function(s){i=s._},null],execute:function(){var a={class:"md-blog m-auto text-left"},o=u('<p>最近看到了一个很惊艳的宝石光追的项目 <a href="https://github.com/Sorumi/UnityRayTracingGem" data-clickable="">Sorumi/UnityRayTracingGem</a>.</p><p>原宝石光追的实现使用了 Compute Buffer 来向着色器传递模型数据。光线在每个 Mesh 内独立地反射与折射，不能在不同 Mesh 间互相传递。</p><p>在 2018 年微软发布了 DXR API 后，Unity 2019.3 加入了实验性的 Ray Tracing Shader，支持更方便地实现光追。</p><p>于是笔者就用 <a href="https://github.com/SlightlyMad/SimpleDxrPathTracer" data-clickable="">SlightlyMad/SimpleDxrPathTracer</a> 的框架复刻了一下这个宝石光追。</p><p>原项目的介绍已经在 <a href="http://sorumi.xyz/posts/unity-ray-tracing-gem-shader/" data-clickable="">Sorumi 的博客</a> 上写的很详细了，相同的部分就不再赘述。</p><h2 id="%E9%80%92%E5%BD%92%E6%94%B9%E8%BF%AD%E4%BB%A3" tabindex="-1"><a class="header-anchor" href="#%E9%80%92%E5%BD%92%E6%94%B9%E8%BF%AD%E4%BB%A3" data-clickable=""><span>递归改迭代</span></a></h2><p><a href="https://github.com/SlightlyMad/SimpleDxrPathTracer" data-clickable="">SlightlyMad/SimpleDxrPathTracer</a> 中提供了一个蒙特卡洛路径追踪算法。</p><p>由于宝石渲染中，所有物体都较为光滑，因此可以几乎不考虑漫反射，进而可以使用更简单的 Whitted-Style Ray Tracing.</p><p>Unity Ray Tracing Shader 递归层数有上限，考虑不使用在 Closest Hit Shader 中重新发射光线的递归写法，而是改为 Closest Hit Shader 修改 <code>payload</code> 后，回到 Ray Generate Shader 继续迭代生成光线。</p><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span>uint i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> gMaxDepth<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token function">TraceRay</span><span class="token punctuation">(</span>sceneAccelStruct<span class="token punctuation">,</span> RAY_FLAG_NONE<span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> hitGroup<span class="token punctuation">,</span> numHitGroups<span class="token punctuation">,</span> missShader<span class="token punctuation">,</span> ray<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>color <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">break</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    ray<span class="token punctuation">.</span>Origin <span class="token operator">=</span> payload<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>\n    ray<span class="token punctuation">.</span>Direction <span class="token operator">=</span> payload<span class="token punctuation">.</span>direction<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\nRenderTarget<span class="token punctuation">[</span>curPixel<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">float4</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>color<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><h2 id="beer-lambert-%E5%85%89%E7%BA%BF%E5%90%B8%E6%94%B6" tabindex="-1"><a class="header-anchor" href="#beer-lambert-%E5%85%89%E7%BA%BF%E5%90%B8%E6%94%B6" data-clickable=""><span>Beer-Lambert 光线吸收</span></a></h2><p>原项目中，光线只在单个 Mesh 内传播，且 Mesh 均为凸多面体，一旦光线射入 Mesh 内，就可以直接逐渐累加吸收距离（原文中 <code>ray.absorbDistance</code>）。</p>',12),m={class:"katex"},h={class:"katex-mathml"},f=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.6444em"}}),e("span",{class:"mord"},"0")])],-1),d={class:"katex"},g={class:"katex-mathml"},y=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mopen"},"("),e("span",{class:"mord"},[e("span",{class:"mord mathnormal"},"x"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"a")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mpunct"},","),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal"},"x"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.3361em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"b")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mclose"},")")])],-1),_={class:"katex"},k={class:"katex-mathml"},v=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.625em","vertical-align":"-0.1944em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal"},"x"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"a")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mpunct"},","),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal"},"x"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.3361em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"b")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])])])],-1),b={class:"katex-display"},x={class:"katex"},z={class:"katex-mathml"},w=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"r")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mopen"},"("),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"x"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"a")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mpunct"},","),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"x"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.3361em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"b")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mclose"},")"),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"1.0158em","vertical-align":"-0.1944em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal"},"e"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.8213em"}},[e("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mord mtight"},"−"),e("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.1132em"}},"τ")])])])])])])])]),e("span",{class:"mpunct"},","),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mord"},[e("span",{class:"mord"},[e("span",{class:"mord mathrm"},"where")])]),e("span",{class:"mord mathnormal",style:{"margin-right":"0.1132em"}},"τ"),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"2.4361em","vertical-align":"-1.012em"}}),e("span",{class:"mop"},[e("span",{class:"mop op-symbol large-op",style:{"margin-right":"0.44445em",position:"relative",top:"-0.0011em"}},"∫"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"1.424em"}},[e("span",{style:{top:"-1.7881em","margin-left":"-0.4445em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mord mathbf mtight"},"x"),e("span",{class:"mrel mtight"},"="),e("span",{class:"mord mtight"},[e("span",{class:"mord mathbf mtight"},"x"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1645em"}},[e("span",{style:{top:"-2.357em","margin-left":"0em","margin-right":"0.0714em"}},[e("span",{class:"pstrut",style:{height:"2.5em"}}),e("span",{class:"sizing reset-size3 size1 mtight"},[e("span",{class:"mord mathnormal mtight"},"a")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.143em"}},[e("span")])])])])])])])]),e("span",{style:{top:"-3.8129em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mord mathbf mtight"},"x"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.3448em"}},[e("span",{style:{top:"-2.3488em","margin-left":"0em","margin-right":"0.0714em"}},[e("span",{class:"pstrut",style:{height:"2.5em"}}),e("span",{class:"sizing reset-size3 size1 mtight"},[e("span",{class:"mord mathnormal mtight"},"b")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1512em"}},[e("span")])])])])])])])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"1.012em"}},[e("span")])])])])]),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"σ"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.2806em"}},[e("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"t")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mopen"},"("),e("span",{class:"mord mathbf"},"x"),e("span",{class:"mclose"},")"),e("span",{class:"mord"},"∣∣"),e("span",{class:"mord"},[e("span",{class:"mord"},[e("span",{class:"mord mathrm"},"d")])]),e("span",{class:"mord mathbf"},"x"),e("span",{class:"mord"},"∣∣")])],-1),M={class:"katex"},D={class:"katex-mathml"},E=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.5806em","vertical-align":"-0.15em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"σ"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.2806em"}},[e("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"t")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])])])],-1),R={class:"katex"},S={class:"katex-mathml"},B=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.5806em","vertical-align":"-0.15em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"σ"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.2806em"}},[e("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"t")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),e("span",{class:"mopen"},"("),e("span",{class:"mord"},"1"),e("span",{class:"mpunct"},","),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mord"},"0"),e("span",{class:"mpunct"},","),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mord"},"0"),e("span",{class:"mclose"},")")])],-1),T={class:"katex"},L={class:"katex-mathml"},A=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.6444em"}}),e("span",{class:"mord"},"1")])],-1),G={class:"katex"},C={class:"katex-mathml"},P=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.6833em"}}),e("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"D")])],-1),O={class:"katex"},I={class:"katex-mathml"},F=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.7849em","vertical-align":"-0.15em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])])])],-1),N={class:"katex-display"},U={class:"katex"},H={class:"katex-mathml"},W=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.5806em","vertical-align":"-0.15em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"σ"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.2806em"}},[e("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"t")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"2.113em","vertical-align":"-0.686em"}}),e("span",{class:"mord"},[e("span",{class:"mopen nulldelimiter"}),e("span",{class:"mfrac"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"1.427em"}},[e("span",{style:{top:"-2.314em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"D")])]),e("span",{style:{top:"-3.23em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),e("span",{style:{top:"-3.677em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"mord"},[e("span",{class:"mord"},"−"),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mop"},[p("lo"),e("span",{style:{"margin-right":"0.01389em"}},"g")]),e("span",{class:"mopen"},"("),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mclose"},")")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.686em"}},[e("span")])])])]),e("span",{class:"mclose nulldelimiter"})])])],-1),j=e("p",null,"剩余能量为",-1),q={class:"katex-display"},Q={class:"katex"},Y={class:"katex-mathml"},Z=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"remain")]),e("span",{class:"mopen"},"("),e("span",{class:"mord mathnormal"},"d"),e("span",{class:"mclose"},")"),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.938em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathnormal"},"e"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.938em"}},[e("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mop mtight"},[e("span",{class:"mtight"},"l"),e("span",{class:"mtight"},"o"),e("span",{class:"mtight",style:{"margin-right":"0.01389em"}},"g")]),e("span",{class:"mopen mtight"},"("),e("span",{class:"mord mtight"},[e("span",{class:"mord mathbf mtight"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1645em"}},[e("span",{style:{top:"-2.357em","margin-left":"0em","margin-right":"0.0714em"}},[e("span",{class:"pstrut",style:{height:"2.5em"}}),e("span",{class:"sizing reset-size3 size1 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.143em"}},[e("span")])])])])]),e("span",{class:"mclose mtight"},")"),e("span",{class:"mbin mtight"},"⋅"),e("span",{class:"mord mathnormal mtight"},"d"),e("span",{class:"mord mtight"},"/"),e("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"D")])])])])])])])]),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"1.185em","vertical-align":"-0.247em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.938em"}},[e("span",{style:{top:"-2.453em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])]),e("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mord mathnormal mtight"},"d"),e("span",{class:"mord mtight"},"/"),e("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"D")])])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.247em"}},[e("span")])])])])])])],-1),X=u('<p>在 Shader 中暴露参数 <code>_ExtinctionColor</code> 和 <code>_ExtinctionDistance</code> 用于控制消光强度。</p><p>在 Closest Hit Shader 中，判断当前光线是否出射光，若是出射光，则降低剩余能量强度。</p><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">bool</span> isOutgoing <span class="token operator">=</span> <span class="token function">step</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">dot</span><span class="token punctuation">(</span><span class="token function">WorldRayDirection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vertexNormal<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>isOutgoing <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">const</span> float3 remainRate <span class="token operator">=</span> <span class="token function">pow</span><span class="token punctuation">(</span>_ExtinctionColor<span class="token punctuation">,</span> <span class="token function">RayTCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">rcp</span><span class="token punctuation">(</span>_ExtinctionDistance<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    payload<span class="token punctuation">.</span>energy <span class="token operator">*=</span> remainRate<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><p>新建一个极长的长方体，效果如下</p>',4),J=e("p",null,"可以看到，在较深的位置，显示的颜色接近黑色。这是由于上述代码仅降低了剩余能量，并没有提供颜色。图中呈现出的蓝色仅为反射光",-1),K={class:"katex"},V={class:"katex-mathml"},$=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.6861em"}}),e("span",{class:"mord mathbf"},"E")])],-1),ss={class:"katex"},as={class:"katex-mathml"},ns=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),e("span",{class:"mord mathbf"},"R"),e("span",{class:"mopen"},"("),e("span",{class:"mord mathnormal"},"d"),e("span",{class:"mclose"},")"),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"1.3182em","vertical-align":"-0.1166em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"1.2016em"}},[e("span",{style:{top:"-2.8834em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])]),e("span",{style:{top:"-3.5856em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mopen nulldelimiter sizing reset-size3 size6"}),e("span",{class:"mfrac"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.88em"}},[e("span",{style:{top:"-2.656em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"sizing reset-size3 size1 mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"D")])])]),e("span",{style:{top:"-3.2255em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"frac-line mtight",style:{"border-bottom-width":"0.049em"}})]),e("span",{style:{top:"-3.384em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"sizing reset-size3 size1 mtight"},[e("span",{class:"mord mtight"},[e("span",{class:"mord mathnormal mtight"},"d")])])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.344em"}},[e("span")])])])]),e("span",{class:"mclose nulldelimiter sizing reset-size3 size6"})])])])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1166em"}},[e("span")])])])])])])],-1),ts={class:"katex"},ls={class:"katex-mathml"},es=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.7849em","vertical-align":"-0.15em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])])])],-1),ps={class:"katex"},cs={class:"katex-mathml"},rs=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.6944em"}}),e("span",{class:"mord mathnormal"},"d")])],-1),us={class:"katex"},is={class:"katex-mathml"},os=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.6944em"}}),e("span",{class:"mord mathnormal"},"d")])],-1),ms={class:"katex-display"},hs={class:"katex"},fs={class:"katex-mathml"},ds=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.6944em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"color")]),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"2.511em","vertical-align":"-0.9119em"}}),e("span",{class:"mop"},[e("span",{class:"mop op-symbol large-op",style:{"margin-right":"0.44445em",position:"relative",top:"-0.0011em"}},"∫"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"1.599em"}},[e("span",{style:{top:"-1.7881em","margin-left":"-0.4445em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},"0")])]),e("span",{style:{top:"-3.8129em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"d")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.9119em"}},[e("span")])])])])]),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mord mathbf"},"E"),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"R"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.8641em"}},[e("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},"2")])])])])])])]),e("span",{class:"mopen"},"("),e("span",{class:"mord mathnormal"},"d"),e("span",{class:"mclose"},")"),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mord"},[e("span",{class:"mord"},[e("span",{class:"mord mathrm"},"d")])]),e("span",{class:"mord mathnormal"},"d"),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),e("span",{class:"mrel"},"="),e("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),e("span",{class:"base"},[e("span",{class:"strut",style:{height:"2.4271em","vertical-align":"-0.936em"}}),e("span",{class:"mord"},[e("span",{class:"mopen nulldelimiter"}),e("span",{class:"mfrac"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"1.4911em"}},[e("span",{style:{top:"-2.314em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"mord"},[e("span",{class:"mord"},"2"),e("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),e("span",{class:"mop"},[p("lo"),e("span",{style:{"margin-right":"0.01389em"}},"g")]),e("span",{class:"mopen"},"("),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mclose"},")")])]),e("span",{style:{top:"-3.23em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),e("span",{style:{top:"-3.677em"}},[e("span",{class:"pstrut",style:{height:"3em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"E"),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"t"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t vlist-t2"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.1514em"}},[e("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mathnormal mtight"},"c")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.15em"}},[e("span")])])])])]),e("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"D"),e("span",{class:"mopen"},"("),e("span",{class:"mord"},"1"),e("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),e("span",{class:"mbin"},"−"),e("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),e("span",{class:"mord"},[e("span",{class:"mord mathbf"},"R"),e("span",{class:"msupsub"},[e("span",{class:"vlist-t"},[e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.8141em"}},[e("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[e("span",{class:"pstrut",style:{height:"2.7em"}}),e("span",{class:"sizing reset-size6 size3 mtight"},[e("span",{class:"mord mtight"},"2")])])])])])])]),e("span",{class:"mopen"},"("),e("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"D"),e("span",{class:"mclose"},"))")])])]),e("span",{class:"vlist-s"},"​")]),e("span",{class:"vlist-r"},[e("span",{class:"vlist",style:{height:"0.936em"}},[e("span")])])])]),e("span",{class:"mclose nulldelimiter"})])])],-1),gs=u('<pre class="language-cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>isOutgoing <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n\t<span class="token keyword">const</span> float3 remainRate <span class="token operator">=</span> <span class="token function">pow</span><span class="token punctuation">(</span>_ExtinctionColor<span class="token punctuation">,</span> <span class="token function">RayTCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">rcp</span><span class="token punctuation">(</span>_ExtinctionDistance<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\tpayload<span class="token punctuation">.</span>color <span class="token operator">-=</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> remainRate <span class="token operator">*</span> remainRate<span class="token punctuation">)</span> <span class="token operator">*</span> payload<span class="token punctuation">.</span>energy <span class="token operator">*</span> _ExtinctionColor <span class="token operator">*</span> _ExtinctionDistance <span class="token operator">*</span> <span class="token function">rcp</span><span class="token punctuation">(</span><span class="token function">log</span><span class="token punctuation">(</span>_ExtinctionColor <span class="token operator">+</span> epsilon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\tpayload<span class="token punctuation">.</span>energy <span class="token operator">*=</span> remainRate<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><p>修正后效果如下</p>',2),ys=u('<p>可以看到，当吸收距离足够长时，其呈现的颜色不再趋近于黑色。</p><h2 id="%E8%89%B2%E6%95%A3" tabindex="-1"><a class="header-anchor" href="#%E8%89%B2%E6%95%A3" data-clickable=""><span>色散</span></a></h2><p>对于使用 RGB 存储的混合光照，并不能很方便地将其中每种频率的光拆分出来分别折射。</p><p>采用一个比较偷懒的方法，直接将光照拆分为 RGB 三种颜色，分别进行折射。</p><p>为 <code>RayPayload</code> 添加字段 <code>channel</code> 用于区分当前正在处理哪种颜色的光，Ray Generate Shader 迭代生成光线的部分修改如下</p><pre class="language-cpp"><code class="language-cpp">RayDesc ray<span class="token punctuation">;</span>\nRayPayload payload<span class="token punctuation">;</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>channel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> payload<span class="token punctuation">.</span>channel <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> payload<span class="token punctuation">.</span>channel<span class="token operator">++</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">/* Initialize payload here */</span>\n    \n    <span class="token keyword">for</span> <span class="token punctuation">(</span>uint i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> gMaxDepth<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token function">TraceRay</span><span class="token punctuation">(</span>sceneAccelStruct<span class="token punctuation">,</span> RAY_FLAG_NONE<span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> hitGroup<span class="token punctuation">,</span> numHitGroups<span class="token punctuation">,</span> missShader<span class="token punctuation">,</span> ray<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>color <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">break</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        ray<span class="token punctuation">.</span>Origin <span class="token operator">=</span> payload<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>\n        ray<span class="token punctuation">.</span>Direction <span class="token operator">=</span> payload<span class="token punctuation">.</span>direction<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    RenderTarget<span class="token punctuation">[</span>curPixel<span class="token punctuation">]</span><span class="token punctuation">[</span>payload<span class="token punctuation">.</span>channel<span class="token punctuation">]</span> <span class="token operator">=</span> payload<span class="token punctuation">.</span>color<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\nRenderTarget<span class="token punctuation">[</span>curPixel<span class="token punctuation">]</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n</code></pre><p>设置一个全局数组 <code>refractionIndex[3]</code> 用于控制三种光线的折射率的扩大系数，并在 Shader 中暴露一个色散度系数 <code>_Dispersion</code> 。在折射时使用扩大系数的色散度次幂来扩大基础折射率。</p><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">float</span> eta <span class="token operator">=</span> <span class="token function">lerp</span><span class="token punctuation">(</span><span class="token function">rcp</span><span class="token punctuation">(</span>_IOR <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span>refractionIndex<span class="token punctuation">[</span>payload<span class="token punctuation">.</span>channel<span class="token punctuation">]</span><span class="token punctuation">,</span> _Dispersion<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _IOR <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span>refractionIndex<span class="token punctuation">[</span>payload<span class="token punctuation">.</span>channel<span class="token punctuation">]</span><span class="token punctuation">,</span> _Dispersion<span class="token punctuation">)</span><span class="token punctuation">,</span> isOutgoing<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><p>最终效果</p>',9),_s={class:"katex"},ks={class:"katex-mathml"},vs=e("span",{class:"katex-html","aria-hidden":"true"},[e("span",{class:"base"},[e("span",{class:"strut",style:{height:"0.6444em"}}),e("span",{class:"mord"},"1")])],-1);s("default",{__name:"RayTracingGem",setup:function(s,u){return(0,u.expose)({frontmatter:{}}),function(s,u){var bs=n("mn"),xs=n("mrow"),zs=n("annotation"),ws=n("semantics"),Ms=n("math"),Ds=n("eq"),Es=n("mi"),Rs=n("msub"),Ss=n("mo"),Bs=n("msup"),Ts=n("msubsup"),Ls=n("eqn"),As=n("mfrac"),Gs=i;return t(),l("div",a,[o,e("p",null,[p("使用 Ray Tracing Shader，光线在到达 Miss Shader 之后或携带的能量为 "),c(Ds,null,{default:r((function(){return[e("span",m,[e("span",h,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(bs,null,{default:r((function(){return[p("0")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("0")]})),_:1})]})),_:1})]})),_:1})]),f])]})),_:1}),p(" 时才停止继续传播，即光线有可能通过多个吸收颜色不同的物体，故不能简单地累加吸收距离的做法模拟光线的吸收。")]),e("p",null,[p("根据 Beer-Lambert 定律，透光度 "),c(Ds,null,{default:r((function(){return[e("span",d,[e("span",g,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Rs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("T")]})),_:1}),c(Es,null,{default:r((function(){return[p("r")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("x")]})),_:1}),c(Es,null,{default:r((function(){return[p("a")]})),_:1})]})),_:1}),c(Ss,{separator:"true"},{default:r((function(){return[p(",")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("x")]})),_:1}),c(Es,null,{default:r((function(){return[p("b")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("T_r(x_a, x_b)")]})),_:1})]})),_:1})]})),_:1})]),y])]})),_:1}),p(" 表示光强在 "),c(Ds,null,{default:r((function(){return[e("span",_,[e("span",k,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Rs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("x")]})),_:1}),c(Es,null,{default:r((function(){return[p("a")]})),_:1})]})),_:1}),c(Ss,{separator:"true"},{default:r((function(){return[p(",")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("x")]})),_:1}),c(Es,null,{default:r((function(){return[p("b")]})),_:1})]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("x_a, x_b")]})),_:1})]})),_:1})]})),_:1})]),v])]})),_:1}),p(" 处的比值，有")]),e("section",null,[c(Ls,null,{default:r((function(){return[e("span",b,[e("span",x,[e("span",z,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Rs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("T")]})),_:1}),c(Es,null,{default:r((function(){return[p("r")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("x")]})),_:1}),c(Es,null,{default:r((function(){return[p("a")]})),_:1})]})),_:1}),c(Ss,{separator:"true"},{default:r((function(){return[p(",")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("x")]})),_:1}),c(Es,null,{default:r((function(){return[p("b")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(Bs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("e")]})),_:1}),c(xs,null,{default:r((function(){return[c(Ss,null,{default:r((function(){return[p("−")]})),_:1}),c(Es,null,{default:r((function(){return[p("τ")]})),_:1})]})),_:1})]})),_:1}),c(Ss,{separator:"true"},{default:r((function(){return[p(",")]})),_:1}),c(xs,null,{default:r((function(){return[c(Es,{mathvariant:"normal"},{default:r((function(){return[p("w")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("h")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("e")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("r")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("e")]})),_:1})]})),_:1}),c(Es,null,{default:r((function(){return[p("τ")]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(Ts,null,{default:r((function(){return[c(Ss,null,{default:r((function(){return[p("∫")]})),_:1}),c(xs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("x")]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("x")]})),_:1}),c(Es,null,{default:r((function(){return[p("a")]})),_:1})]})),_:1})]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("x")]})),_:1}),c(Es,null,{default:r((function(){return[p("b")]})),_:1})]})),_:1})]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("σ")]})),_:1}),c(Es,null,{default:r((function(){return[p("t")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("x")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("∣")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("∣")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("d")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("x")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("∣")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("∣")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p(" T_r(\\mathbf{x}_a, \\mathbf{x}_b) = e^{-\\tau}, {\\rm where} \\tau = \\int_{\\mathbf{x} = \\mathbf{x}_a}^{\\mathbf{x}_b} \\mathbf{\\sigma}_t(\\mathbf{x}) ||{\\rm d}\\mathbf{x}|| ")]})),_:1})]})),_:1})]})),_:1})]),w])])]})),_:1})]),e("p",null,[p("其中 "),c(Ds,null,{default:r((function(){return[e("span",M,[e("span",D,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("σ")]})),_:1}),c(Es,null,{default:r((function(){return[p("t")]})),_:1})]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("\\mathbf{\\sigma}_t")]})),_:1})]})),_:1})]})),_:1})]),E])]})),_:1}),p(" 为消光系数，"),c(Ds,null,{default:r((function(){return[e("span",R,[e("span",S,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("σ")]})),_:1}),c(Es,null,{default:r((function(){return[p("t")]})),_:1})]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(bs,null,{default:r((function(){return[p("1")]})),_:1}),c(Ss,{separator:"true"},{default:r((function(){return[p(",")]})),_:1}),c(bs,null,{default:r((function(){return[p("0")]})),_:1}),c(Ss,{separator:"true"},{default:r((function(){return[p(",")]})),_:1}),c(bs,null,{default:r((function(){return[p("0")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("\\mathbf{\\sigma}_t = (1, 0, 0)")]})),_:1})]})),_:1})]})),_:1})]),B])]})),_:1}),p(" 表明该物质仅以 "),c(Ds,null,{default:r((function(){return[e("span",T,[e("span",L,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(bs,null,{default:r((function(){return[p("1")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("1")]})),_:1})]})),_:1})]})),_:1})]),A])]})),_:1}),p(" 的强度吸收红色光。对于均匀介质，其值为常数。")]),e("p",null,[p("Bavoil 提出，设目标距离 "),c(Ds,null,{default:r((function(){return[e("span",G,[e("span",C,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("D")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("D")]})),_:1})]})),_:1})]})),_:1})]),P])]})),_:1}),p(" 处的目标光强为 "),c(Ds,null,{default:r((function(){return[e("span",O,[e("span",I,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1})]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("\\mathbf{t}_c")]})),_:1})]})),_:1})]})),_:1})]),F])]})),_:1}),p("，则消光系数为")]),e("section",null,[c(Ls,null,{default:r((function(){return[e("span",N,[e("span",U,[e("span",H,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("σ")]})),_:1}),c(Es,null,{default:r((function(){return[p("t")]})),_:1})]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(As,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Ss,null,{default:r((function(){return[p("−")]})),_:1}),c(Es,null,{default:r((function(){return[p("log")]})),_:1}),c(Ss,null,{default:r((function(){return[p("⁡")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1})]})),_:1}),c(Es,null,{default:r((function(){return[p("D")]})),_:1})]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p(" \\mathbf{\\sigma}_t = \\frac{-\\log(\\mathbf{t}_c)}{D} ")]})),_:1})]})),_:1})]})),_:1})]),W])])]})),_:1})]),j,e("section",null,[c(Ls,null,{default:r((function(){return[e("span",q,[e("span",Q,[e("span",Y,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("r")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("e")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("m")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("a")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("i")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("n")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Es,null,{default:r((function(){return[p("d")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(Bs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("e")]})),_:1}),c(xs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("log")]})),_:1}),c(Ss,null,{default:r((function(){return[p("⁡")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1}),c(Ss,null,{default:r((function(){return[p("⋅")]})),_:1}),c(Es,null,{default:r((function(){return[p("d")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("/")]})),_:1}),c(Es,null,{default:r((function(){return[p("D")]})),_:1})]})),_:1})]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(Ts,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1}),c(xs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("d")]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("/")]})),_:1}),c(Es,null,{default:r((function(){return[p("D")]})),_:1})]})),_:1})]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p(" \\mathbf{remain}(d) = e^{\\log(\\mathbf{t}_c) \\cdot d/D} = \\mathbf{t}_c^{d/D} ")]})),_:1})]})),_:1})]})),_:1})]),Z])])]})),_:1})]),X,e("p",null,[c(Gs,{src:"https://s2.loli.net/2023/06/13/Qzdws9P24NZ3agE.png",alt:"20230612_1.png","show-toolbar-tooltip":""})]),J,e("p",null,[p("考虑入射能量为 "),c(Ds,null,{default:r((function(){return[e("span",K,[e("span",V,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("E")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("\\mathbf{E}")]})),_:1})]})),_:1})]})),_:1})]),$])]})),_:1}),p("，剩余比例为 "),c(Ds,null,{default:r((function(){return[e("span",ss,[e("span",as,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("R")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Es,null,{default:r((function(){return[p("d")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(Ts,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1}),c(As,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("d")]})),_:1}),c(Es,null,{default:r((function(){return[p("D")]})),_:1})]})),_:1})]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("\\mathbf{R}(d) = \\mathbf{t}_c^{\\frac{d}{D}}")]})),_:1})]})),_:1})]})),_:1})]),ns])]})),_:1}),p("，目标颜色为 "),c(Ds,null,{default:r((function(){return[e("span",ts,[e("span",ls,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1})]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("\\mathbf{t}_c")]})),_:1})]})),_:1})]})),_:1})]),es])]})),_:1})]),e("p",null,[p("可以认为该物质在距离 "),c(Ds,null,{default:r((function(){return[e("span",ps,[e("span",cs,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("d")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("d")]})),_:1})]})),_:1})]})),_:1})]),rs])]})),_:1}),p(" 处完全反射了一部分光，这部分光在经过一个 "),c(Ds,null,{default:r((function(){return[e("span",us,[e("span",is,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Es,null,{default:r((function(){return[p("d")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("d")]})),_:1})]})),_:1})]})),_:1})]),os])]})),_:1}),p(" 的距离后回到入射面，最终传递回相机，则其提供的颜色为")]),e("section",null,[c(Ls,null,{default:r((function(){return[e("span",ms,[e("span",hs,[e("span",fs,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("c")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("o")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("l")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("o")]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("r")]})),_:1})]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(Ts,null,{default:r((function(){return[c(Ss,null,{default:r((function(){return[p("∫")]})),_:1}),c(bs,null,{default:r((function(){return[p("0")]})),_:1}),c(Es,null,{default:r((function(){return[p("d")]})),_:1})]})),_:1}),c(Es,{mathvariant:"bold"},{default:r((function(){return[p("E")]})),_:1}),c(Bs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("R")]})),_:1}),c(bs,null,{default:r((function(){return[p("2")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Es,null,{default:r((function(){return[p("d")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1})]})),_:1}),c(Es,{mathvariant:"normal"},{default:r((function(){return[p("d")]})),_:1}),c(Es,null,{default:r((function(){return[p("d")]})),_:1}),c(Ss,null,{default:r((function(){return[p("=")]})),_:1}),c(As,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("E")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1})]})),_:1}),c(Es,null,{default:r((function(){return[p("D")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(bs,null,{default:r((function(){return[p("1")]})),_:1}),c(Ss,null,{default:r((function(){return[p("−")]})),_:1}),c(Bs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("R")]})),_:1}),c(bs,null,{default:r((function(){return[p("2")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Es,null,{default:r((function(){return[p("D")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1})]})),_:1}),c(xs,null,{default:r((function(){return[c(bs,null,{default:r((function(){return[p("2")]})),_:1}),c(Es,null,{default:r((function(){return[p("log")]})),_:1}),c(Ss,null,{default:r((function(){return[p("⁡")]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p("(")]})),_:1}),c(Rs,null,{default:r((function(){return[c(Es,{mathvariant:"bold"},{default:r((function(){return[p("t")]})),_:1}),c(Es,null,{default:r((function(){return[p("c")]})),_:1})]})),_:1}),c(Ss,{stretchy:"false"},{default:r((function(){return[p(")")]})),_:1})]})),_:1})]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p(" \\mathbf{color} = \\int_0^d \\mathbf{E} \\mathbf{R}^2(d) \\mathbf{t}_c {\\rm d}d = \\frac{\\mathbf{E} \\mathbf{t}_c D (1 - \\mathbf{R}^2(D))}{2\\log(\\mathbf{t}_c)} ")]})),_:1})]})),_:1})]})),_:1})]),ds])])]})),_:1})]),gs,e("p",null,[c(Gs,{src:"https://s2.loli.net/2023/06/13/NWBTdA1CyzagU7Z.png",alt:"20230612_2.png","show-toolbar-tooltip":""})]),ys,e("p",null,[c(Gs,{src:"https://s2.loli.net/2023/06/13/gDbplW3k7UuFS1d.png",alt:"20230612_3.png","show-toolbar-tooltip":""})]),e("p",null,[p("桌面的反射效果是通过将其折射率设置为小于 "),c(Ds,null,{default:r((function(){return[e("span",_s,[e("span",ks,[c(Ms,{xmlns:"http://www.w3.org/1998/Math/MathML"},{default:r((function(){return[c(ws,null,{default:r((function(){return[c(xs,null,{default:r((function(){return[c(bs,null,{default:r((function(){return[p("1")]})),_:1})]})),_:1}),c(zs,{encoding:"application/x-tex"},{default:r((function(){return[p("1")]})),_:1})]})),_:1})]})),_:1})]),vs])]})),_:1}),p(" 来实现的。")])])}}})}}}));
